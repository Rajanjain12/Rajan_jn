try{delete window.xRTML}catch(e){window.xRTML=undefined}(function(b,a){(function(c,g){var d={bind:function(h,i){if(h.bind){h.bind(i)}else{for(var j in i){if(h.addEventListener){h.addEventListener(j,i[j],false)}else{h.attachEvent?h.attachEvent("on"+j,i[j]):h[j]=i[j]}}}},unbind:function(h,i){if(h.unbind){h.unbind(i)}else{for(var j in i){if(h.removeEventListener){h.removeEventListener(j,i[j],false)}else{if(h.detachEvent){h.detachEvent("on"+j,i[j])}else{if(h[j]){delete h[j]}}}}}}},f={bind:function(h){for(var i in h){if(typeof h[i]==="function"){if(!this.listeners[i]){this.listeners[i]=[]}this.listeners[i].push(h[i])}}},unbind:function(h){for(var m in h){if(this.listeners[m] instanceof Array){var l=this.listeners[m];for(var j=0,k=l.length;j<k;j++){if(l[j]===h[m]){l.splice(j,1);break}}}}},fire:function(j){var h;for(var o in j){h={type:o,target:this};for(var l in j[o]){var n=j[o][l];h[l]=n}if(this.listeners[h.type] instanceof Array){var m=new Array();for(var k=0;k<this.listeners[h.type].length;k++){m.push(this.listeners[h.type][k])}for(var k=0;k<m.length;k++){m[k].call(this,h)}}}}};c.bind=d.bind;c.unbind=d.unbind;c.extend=function(i){if(!i.listeners){i.listeners={}}for(var h in f){i[h]=f[h]}}})(b.Event=b.Event||{})})(window.xRTML=window.xRTML||{});(function(a){(function(c,b){c.Event.extend(c);c.version="3.0.0";c.lastestBuild="16-01-2013 10:12:31";c.domLoaded=function(){return(document.readyState=="loaded"||document.readyState=="complete")};c.isReady=false;c.isLoaded=false;c.ready=function(d){!c.isReady?c.bind({ready:d}):d()};c.load=function(d){!c.isLoaded?c.bind({load:d}):d()}})(a.xRTML=a.xRTML||{})})(window);(function(b,a){(function(au,ar){var aq,p,A,ao,al,C=b.document,B=C.documentElement,F=("sizcache"+Math.random()).replace(".",""),D=0,an=[].slice,V=[].push,ap="undefined",K=false,n=true,r="(?:[-\\w]|[^\\x00-\\xa0]|\\\\.)",at="[\\x20\\t\\n\\r\\f]",S="([*^$|!~]?={1})",L="(?:-?[#_a-zA-Z]{1}[-\\w]*|[^\\x00-\\xa0]+|\\\\.+)",m="\\["+at+"*("+r+"+)"+at+"*(?:"+S+at+"*(?:(['\"])(.*?)\\3|("+L+"+)|)|)"+at+"*\\]",U=":("+r+"+)(?:\\(([\"']?)([^()]*|.*)\\2\\))?",T=":(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\))?(?=[^\\-]|$)",u=at+"*([\\x20\\t\\n\\r\\f>+~])"+at+"*",Z=new RegExp("^"+at+"*,"+at+"*"),Y=new RegExp("^"+u),aj=new RegExp("("+m.replace("3","4")+"|"+U.replace("2","8")+"|\\\\[>+~]|[^\\x20\\t\\n\\r\\f>+~]|\\\\.)+|"+u,"g"),ai=new RegExp("^"+at),ag=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,ah=/^[\x20\t\n\r\f]*[+~][\x20\t\n\r\f]*$/,aa=/:not\($/,af=/(-?)(\d*)(?:n([+\-]?\d*))?/,ae=/\D/,ac=/h\d/i,ad=/input|select|textarea|button/i,W=/^\+|[\x20\t\n\r\f]*/g,X=/\\(?!\\)/g,ab=/([^,\\\[\]]+|\[[^\[]*\]|\([^\(]*\)|\\.)+/g,Q={ID:new RegExp("^#("+r+"+)"),CLASS:new RegExp("^\\.("+r+"+)"),NAME:new RegExp("^\\[name=['\"]?("+r+"+)['\"]?\\]"),TAG:new RegExp("^("+r.replace("[-","[-\\*")+"+)"),ATTR:new RegExp("^"+m),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+at+"*(even|odd|(?:[+\\-]?\\d+|(?:[+\\-]?\\d*)?n"+at+"*(?:[+\\-]"+at+"*\\d+)?))"+at+"*\\))?","i"),POS:new RegExp(T,"ig"),globalPOS:new RegExp(T,"i")},t={},o=[],w={},q=[],N=function(av){av.sizzleFilter=true;return av},z=function(av){return function(aw){return aw.nodeName.toLowerCase()==="input"&&aw.type===av}},y=function(av){return function(aw){var ax=aw.nodeName.toLowerCase();return(ax==="input"||ax==="button")&&aw.type===av}},f=function(ax){var ay=false,av=C.createElement("div");try{ay=ax(av)}catch(aw){}av=null;return ay},g=f(function(av){av.innerHTML="<select></select>";var aw=typeof av.lastChild.getAttribute("multiple");return aw!=="boolean"&&aw!=="string"}),h,l=f(function(av){av.id=F+0;av.innerHTML="<a name='"+F+"'/><div name='"+F+"'/>";B.insertBefore(av,B.firstChild);var aw=C.getElementsByName&&C.getElementsByName(F).length===2+C.getElementsByName(F+0).length;h=!C.getElementById(F);B.removeChild(av);return aw}),j=f(function(av){av.appendChild(C.createComment(""));return av.getElementsByTagName("*").length===0}),i=f(function(av){av.innerHTML="<a href='#'></a>";return av.firstChild&&typeof av.firstChild.getAttribute!==ap&&av.firstChild.getAttribute("href")==="#"}),k=f(function(av){av.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!av.getElementsByClassName||av.getElementsByClassName("e").length===0){return false}av.lastChild.className="e";return av.getElementsByClassName("e").length!==1});var am=function(aC,av,aA,aB){aA=aA||[];av=av||C;var ay,aw,aD,ax,az=av.nodeType;if(az!==1&&az!==9){return[]}if(!aC||typeof aC!=="string"){return aA}aD=M(av);if(!aD&&!aB){if((ay=ag.exec(aC))){if((ax=ay[1])){if(az===9){aw=av.getElementById(ax);if(aw&&aw.parentNode){if(aw.id===ax){aA.push(aw);return aA}}else{return aA}}else{if(av.ownerDocument&&(aw=av.ownerDocument.getElementById(ax))&&x(av,aw)&&aw.id===ax){aA.push(aw);return aA}}}else{if(ay[2]){V.apply(aA,an.call(av.getElementsByTagName(aC),0));return aA}else{if((ax=ay[3])&&k&&av.getElementsByClassName){V.apply(aA,an.call(av.getElementsByClassName(ax),0));return aA}}}}}return ak(aC,av,aA,aB,aD)};var G=am.selectors={cacheLength:50,match:Q,order:["ID","TAG"],attrHandle:{},createPseudo:N,find:{ID:h?function(aw,av,ay){if(typeof av.getElementById!==ap&&!ay){var ax=av.getElementById(aw);return ax&&ax.parentNode?[ax]:[]}}:function(aw,av,ay){if(typeof av.getElementById!==ap&&!ay){var ax=av.getElementById(aw);return ax?ax.id===aw||typeof ax.getAttributeNode!==ap&&ax.getAttributeNode("id").value===aw?[ax]:ar:[]}},TAG:j?function(aw,av){if(typeof av.getElementsByTagName!==ap){return av.getElementsByTagName(aw)}}:function(az,av){var ay=av.getElementsByTagName(az);if(az==="*"){var aw,aA=[],ax=0;for(;(aw=ay[ax]);ax++){if(aw.nodeType===1){aA.push(aw)}}ay=aA}return ay}},relative:{">":{dir:"parentNode",firstMatch:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",firstMatch:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(av){av[1]=av[1].replace(X,"");av[3]=(av[4]||av[5]||"").replace(X,"");if(av[2]==="~="){av[3]=" "+av[3]+" "}return av.slice(0,4)},CHILD:function(av){av[1]=av[1].toLowerCase();if(av[1]==="nth"){if(!av[2]){am.error(av[0])}av[2]=av[2].replace(W,"");var aw=af.exec(av[2]==="even"&&"2n"||av[2]==="odd"&&"2n+1"||!ae.test(av[2])&&"0n+"+av[2]||av[2]);av[2]=+(aw[1]+(aw[2]||1));av[3]=+aw[3]}else{if(av[2]){am.error(av[0])}}return av},PSEUDO:function(av){return Q.CHILD.test(av[0])?null:av}},filter:{ID:h?function(av){av=av.replace(X,"");return function(aw){return aw.getAttribute("id")===av}}:function(av){av=av.replace(X,"");return function(aw){var ax=typeof aw.getAttributeNode!==ap&&aw.getAttributeNode("id");return ax&&ax.value===av}},TAG:function(av){if(av==="*"){return function(){return true}}av=av.replace(X,"").toLowerCase();return function(aw){return aw.nodeName&&aw.nodeName.toLowerCase()===av}},CLASS:function(av){var aw=t[av];if(!aw){aw=t[av]=new RegExp("(^|"+at+")"+av+"("+at+"|$)");o.push(av);if(o.length>G.cacheLength){delete t[o.shift()]}}return function(ax){return aw.test(ax.className||ax.getAttribute("class")||"")}},ATTR:function(aw,ax,av){if(!ax){return function(ay){return am.attr(ay,aw)!=null}}return function(ay){var az=am.attr(ay,aw),aA=az+"";if(az==null){return ax==="!="}switch(ax){case"=":return aA===av;case"!=":return aA!==av;case"^=":return av&&aA.indexOf(av)===0;case"*=":return av&&aA.indexOf(av)>-1;case"$=":return av&&aA.substr(aA.length-av.length)===av;case"~=":return(" "+aA+" ").indexOf(av)>-1;case"|=":return aA===av||aA.substr(0,av.length+1)===av+"-"}}},CHILD:function(ay,aw,ax){if(ay==="nth"){var av=D++;return function(aB){var aD,aA,az=0,aC=aB;if(aw===1&&ax===0){return true}aD=aB.parentNode;if(aD&&(aD[F]!==av||!aB.sizset)){for(aC=aD.firstChild;aC;aC=aC.nextSibling){if(aC.nodeType===1){aC.sizset=++az;if(aC===aB){break}}}aD[F]=av}aA=aB.sizset-ax;if(aw===0){return aA===0}else{return(aA%aw===0&&aA/aw>=0)}}}return function(az){var aA=az;switch(ay){case"only":case"first":while((aA=aA.previousSibling)){if(aA.nodeType===1){return false}}if(ay==="first"){return true}aA=az;case"last":while((aA=aA.nextSibling)){if(aA.nodeType===1){return false}}return true}}},PSEUDO:function(az,ay,av,aw,aA){var ax=G.pseudos[az]||G.pseudos[az.toLowerCase()];if(!ax){am.error("unsupported pseudo: "+az)}if(!ax.sizzleFilter){return ax}return ax(av,aw,aA)}},pseudos:{not:N(function(ax,av,ay){var aw=v(ax,av,ay);return function(az){return !aw(az)}}),enabled:function(av){return av.disabled===false},disabled:function(av){return av.disabled===true},checked:function(av){var aw=av.nodeName.toLowerCase();return(aw==="input"&&!!av.checked)||(aw==="option"&&!!av.selected)},selected:function(av){if(av.parentNode){av.parentNode.selectedIndex}return av.selected===true},parent:function(av){return !!av.firstChild},empty:function(av){return !av.firstChild},contains:N(function(av){return function(aw){return(aw.textContent||aw.innerText||H(aw)).indexOf(av)>-1}}),has:N(function(av){return function(aw){return !!am(av,aw).length}}),header:function(av){return ac.test(av.nodeName)},text:function(aw){var av=aw.getAttribute("type"),ax=aw.type;return aw.nodeName.toLowerCase()==="input"&&"text"===ax&&(av===null||av.toLowerCase()===ax)},radio:z("radio"),checkbox:z("checkbox"),file:z("file"),password:z("password"),image:z("image"),submit:y("submit"),reset:y("reset"),button:function(av){var aw=av.nodeName.toLowerCase();return aw==="input"&&"button"===av.type||aw==="button"},input:function(av){return ad.test(av.nodeName)},focus:function(aw){var av=aw.ownerDocument;return aw===av.activeElement&&(!av.hasFocus||av.hasFocus())&&!!(aw.type||aw.href)},active:function(av){return av===av.ownerDocument.activeElement}},setFilters:{first:function(aw,av,ax){return ax?aw.slice(1):[aw[0]]},last:function(ax,av,ay){var aw=ax.pop();return ay?ax:[aw]},even:function(aw,av,az){var aA=[],ax=az?1:0,ay=aw.length;for(;ax<ay;ax=ax+2){aA.push(aw[ax])}return aA},odd:function(aw,av,az){var aA=[],ax=az?0:1,ay=aw.length;for(;ax<ay;ax=ax+2){aA.push(aw[ax])}return aA},lt:function(aw,av,ax){return ax?aw.slice(+av):aw.slice(0,+av)},gt:function(aw,av,ax){return ax?aw.slice(0,+av+1):aw.slice(+av+1)},eq:function(ax,av,ay){var aw=ax.splice(+av,1);return ay?ax:aw}}};G.setFilters.nth=G.setFilters.eq;G.filters=G.pseudos;if(!i){G.attrHandle={href:function(av){return av.getAttribute("href",2)},type:function(av){return av.getAttribute("type")}}}if(l){G.order.push("NAME");G.find.NAME=function(aw,av){if(typeof av.getElementsByName!==ap){return av.getElementsByName(aw)}}}if(k){G.order.splice(1,0,"CLASS");G.find.CLASS=function(av,aw,ax){if(typeof aw.getElementsByClassName!==ap&&!ax){return aw.getElementsByClassName(av)}}}try{an.call(B.childNodes,0)[0].nodeType}catch(E){an=function(aw){var av,ax=[];for(;(av=this[aw]);aw++){ax.push(av)}return ax}}var M=am.isXML=function(aw){var av=aw&&(aw.ownerDocument||aw).documentElement;return av?av.nodeName!=="HTML":false};var x=am.contains=B.compareDocumentPosition?function(av,aw){return !!(av.compareDocumentPosition(aw)&16)}:B.contains?function(av,ax){var aw=av.nodeType===9?av.documentElement:av,ay=ax.parentNode;return av===ay||!!(ay&&ay.nodeType===1&&aw.contains&&aw.contains(ay))}:function(av,aw){while((aw=aw.parentNode)){if(aw===av){return true}}return false};var H=am.getText=function(av){var ax,az="",aw=0,ay=av.nodeType;if(ay){if(ay===1||ay===9||ay===11){if(typeof av.textContent==="string"){return av.textContent}else{for(av=av.firstChild;av;av=av.nextSibling){az+=H(av)}}}else{if(ay===3||ay===4){return av.nodeValue}}}else{for(;(ax=av[aw]);aw++){az+=H(ax)}}return az};am.attr=function(aw,ax){var ay=M(aw);if(!ay){ax=ax.toLowerCase()}if(G.attrHandle[ax]){return G.attrHandle[ax](aw)}if(g||ay){return aw.getAttribute(ax)}var av=(aw.attributes||{})[ax];return av?typeof aw[ax]==="boolean"?aw[ax]?ax:null:av.specified?av.value:null:null};am.error=function(av){throw new Error("Syntax error, unrecognized expression: "+av)};[0,0].sort(function(){return(n=0)});if(B.compareDocumentPosition){ao=function(av,aw){if(av===aw){K=true;return 0}return(!av.compareDocumentPosition||!aw.compareDocumentPosition?av.compareDocumentPosition:av.compareDocumentPosition(aw)&4)?-1:1}}else{ao=function(av,az){if(av===az){K=true;return 0}else{if(av.sourceIndex&&az.sourceIndex){return av.sourceIndex-az.sourceIndex}}var aw,aA,ax=[],aB=[],ay=av.parentNode,aC=az.parentNode,aD=ay;if(ay===aC){return al(av,az)}else{if(!ay){return -1}else{if(!aC){return 1}}}while(aD){ax.unshift(aD);aD=aD.parentNode}aD=aC;while(aD){aB.unshift(aD);aD=aD.parentNode}aw=ax.length;aA=aB.length;for(var aE=0;aE<aw&&aE<aA;aE++){if(ax[aE]!==aB[aE]){return al(ax[aE],aB[aE])}}return aE===aw?al(av,aB[aE],-1):al(ax[aE],az,1)};al=function(av,aw,ay){if(av===aw){return ay}var ax=av.nextSibling;while(ax){if(ax===aw){return -1}ax=ax.nextSibling}return 1}}am.uniqueSort=function(ax){var av,aw=1;if(ao){K=n;ax.sort(ao);if(K){for(;(av=ax[aw]);aw++){if(av===ax[aw-1]){ax.splice(aw--,1)}}}}return ax};function R(aA,av,ay,az){for(var aw=0,ax=av.length;aw<ax;aw++){am(aA,av[aw],ay,az)}}function J(aC,az,av,aw,aB,ay){var aA=[],ax=G.setFilters[az.toLowerCase()];if(!ax){am.error(az)}if(aC){R(aC,aw,aA,aB)}else{aA=aB}return aA.length?ax(aA,av,ay):[]}function I(aL,aw,aG,aK){var aD,aE,av,aH,ay,ax,aF,aB,az=aL.match(ab),aA=0,aC=az.length,aI=Q.POS,aJ=new RegExp("^"+Q.POS.source+"(?!"+at+")","i"),aM=function(){for(var aN=1,aO=arguments.length-2;aN<aO;aN++){if(arguments[aN]===ar){aD[aN]=ar}}};for(;aA<aC;aA++){aI.exec("");aL=az[aA].replace(ai,"");aH=[];av=0;ay=aK||null;while((aD=aI.exec(aL))){aB=aD.index+aD[0].length;if(aB>av){aF=aL.slice(av,aD.index);if(aD.length>1){aD[0].replace(aJ,aM)}av=aB;ax=[aw];if((aE=aa.test(aF))){aF=aF.replace(aa,"").replace(Y,"$&*")}if(Y.test(aF)){ax=ay||[aw];ay=aK}ay=J(aF,aD[1],aD[2],ax,ay,aE)}if(aI.lastIndex===aD.index){aI.lastIndex++}}if(ay){aH=aH.concat(ay);if((aF=aL.slice(av))&&aF!==")"){R(aF,aH,aG,aK)}else{V.apply(aG,aH)}}else{am(aL,aw,aG,aK)}}return aC===1?aG:am.uniqueSort(aG)}(function(){var ax,aw,ay,av=function(az,aA,aB){if((aw=az.exec(ax))&&(!aA||!G.preFilter[aA]||(aw=G.preFilter[aA](aw,aB)))){ax=ax.slice(aw[0].length)}return aw};aq=function(aD,aA,aF){ax=aD;ay=[];var aE,aC,az=!aF&&aA!==C,aB=[ay];if(az){ax=" "+ax}while(ax){aC=false;if(av(Z)){aB.push(ay=[]);if(az){ax=" "+ax}}if(av(Y)){ay.push({part:aw.pop(),captures:aw});aC=true}for(aE in G.filter){if(av(Q[aE],aE,aF)){aw.shift();ay.push({part:aE,captures:aw});aC=true}}if(!aC){am.error(aD)}}return aB}})();function c(aA,av,aw){var ax=av.dir,az=av.firstMatch,ay=D++;if(!aA){aA=function(aB){return aB===aw}}return az?function(aC,aB){while((aC=aC[ax])){if(aC.nodeType===1){return aA(aC,aB)?aC:false}}}:function(aF,aD){var aB,aE=ay+"."+A,aC=aE+"."+p;while((aF=aF[ax])){if(aF.nodeType===1){if((aB=aF[F])===aC){return false}else{if(typeof aB==="string"&&aB.indexOf(aE)===0){if(aF.sizset){return aF}}else{aF[F]=aC;if(aA(aF,aD)){aF.sizset=true;return aF}aF.sizset=false}}}}}}function d(aw,av){return aw?function(ay,ax){var az=av(ay,ax);return az&&aw(az===true?ay:az,ax)}:av}function P(az,av,aA){var ay,ax,aw=0;for(;(ay=az[aw]);aw++){if(G.relative[ay.part]){ax=c(ax,G.relative[ay.part],av)}else{ay.captures.push(av,aA);ax=d(ax,G.filter[ay.part].apply(null,ay.captures))}}return ax}function O(av){return function(ax,aw){var az,ay=0;for(;(az=av[ay]);ay++){if(az(ax,aw)){return true}}return false}}var v=am.compile=function(az,aw,aB){var aA,ax,ay,av=w[az];if(av&&av.context===aw){av.dirruns++;return av}ax=aq(az,aw,aB);for(ay=0;(aA=ax[ay]);ay++){ax[ay]=P(aA,aw,aB)}av=w[az]=O(ax);av.context=aw;av.runs=av.dirruns=0;q.push(az);if(q.length>G.cacheLength){delete w[q.shift()]}return av};am.matches=function(aw,av){return am(aw,null,null,av)};am.matchesSelector=function(av,aw){return am(aw,null,null,[av]).length>0};var ak=function(aJ,av,aH,aI,aN){var ay,aE,aA,aC,ax,aK,aG,aM,aD,az,aF,aB=(aD=aJ.match(ab))&&aD.length===1,aL=aJ.match(aj),aw=av.nodeType;if(Q.POS.test(aJ)){return I(aJ,av,aH,aI)}if(!aI&&aB&&aL.length>1&&aw===9&&!aN&&(aD=Q.ID.exec(aL[0]))){av=G.find.ID(aD[1],av,aN)[0];aJ=aJ.slice(aL.shift().length)}if(av){if(aI){ay=an.call(aI,0)}else{if(aB){az=(aL.length>=1&&ah.test(aL[0])&&av.parentNode)||av;aF=aL.pop().split(":not");aK=aF[0];for(aA=0,aC=G.order.length;aA<aC;aA++){aM=G.order[aA];if((aD=Q[aM].exec(aK))){ay=G.find[aM]((aD[1]||"").replace(X,""),az,aN);if(ay!=null){break}}}if(ay&&!aF[1]){aG=aJ.length-aK.length;aJ=aJ.slice(0,aG)+aJ.slice(aG).replace(Q[aM],"");if(!aJ){V.apply(aH,an.call(ay,0));return aH}}}if(!ay){ay=G.find.TAG("*",av)}}if(aJ&&(aE=v(aJ,av,aN))){A=aE.dirruns;for(aA=0;(ax=ay[aA]);aA++){p=aE.runs++;if(aE(ax,av)){aH.push(ax)}}}}return aH};if(C.querySelectorAll){(function(){var av,ax=ak,aC=/[^\\],/g,aD=/^[\x20\t\n\r\f]*[+~]/,ay=/'/g,az=/\=[\x20\t\n\r\f]*([^'"\]]*)[\x20\t\n\r\f]*\]/g,aB=[],aA=[":active"],aw=B.matchesSelector||B.mozMatchesSelector||B.webkitMatchesSelector||B.oMatchesSelector||B.msMatchesSelector;f(function(aE){aE.innerHTML="<select><option selected></option></select>";if(!aE.querySelectorAll("[selected]").length){aB.push("\\["+at+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")}if(!aE.querySelectorAll(":checked").length){aB.push(":checked")}});f(function(aE){aE.innerHTML="<p test=''></p>";if(aE.querySelectorAll("[test^='']").length){aB.push("[*^$]="+at+"*(?:\"\"|'')")}aE.innerHTML="<input type='hidden'>";if(!aE.querySelectorAll(":enabled").length){aB.push(":enabled",":disabled")}});aB=aB.length&&new RegExp(aB.join("|"));ak=function(aO,aE,aM,aN,aP){if(!aN&&!aP&&(!aB||!aB.test(aO))){if(aE.nodeType===9){try{V.apply(aM,an.call(aE.querySelectorAll(aO),0));return aM}catch(aK){}}else{if(aE.nodeType===1&&aE.nodeName.toLowerCase()!=="object"){var aF,aI=aE,aH=aE.getAttribute("id"),aG=aH||F,aJ=aE.parentNode,aL=aD.test(aO);if(aH){aG=aG.replace(ay,"\\$&")}else{aE.setAttribute("id",aG)}if(aL&&aJ){aE=aJ}try{if(aE){aG="[id='"+aG+"'] ";aF=aG+aO.replace(aC,"$&"+aG);V.apply(aM,an.call(aE.querySelectorAll(aF),0));return aM}}catch(aK){}finally{if(!aH){aI.removeAttribute("id")}}}}}return ax(aO,aE,aM,aN,aP)};if(aw){f(function(aE){av=aw.call(aE,"div");try{aw.call(aE,"[test!='']:sizzle");aA.push(G.match.PSEUDO)}catch(aF){}});aA=new RegExp(aA.join("|"));am.matchesSelector=function(aF,aG){aG=aG.replace(az,"='$1']");if(!M(aF)&&!aA.test(aG)&&(!aB||!aB.test(aG))){try{var aH=aw.call(aF,aG);if(aH||av||aF.document&&aF.document.nodeType!==11){return aH}}catch(aE){}}return am(aG,null,null,[aF]).length>0}}})()}au.Sizzle=am})(b.xRTML=b.xRTML||{})})(window);(function(xRTML,undefined){(function(JSON,undefined){(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}())})(xRTML.JSON=xRTML.JSON||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(d,k){var j="xrtml:",c=function(m){return !m.getAttribute("version")||m.getAttribute("version")===b.version},g=function(m){var p=m.getElementsByTagName(j+"connection"),o=[];for(var q=0;q<p.length;++q){if(c(p[q])){var n=p[q];o.push(new l(n));p[q].parentNode.removeChild(p[q--])}}return o},h=function(m){var r=m.getElementsByTagName(j+"storage"),q=[];for(var n=0,o=r.length;n<o;n++){if(c(r[n])){var p=r[n];q.push({id:p.getAttribute("id"),baseurl:p.getAttribute("baseurl"),type:p.getAttribute("type"),connectionid:p.getAttribute("connectionid"),sessionid:p.getAttribute("sessionid"),onready:p.getAttribute("onready")?new Function("event","return "+p.getAttribute("onready")+"(event);"):null,onsession:p.getAttribute("onsession")?new Function("event","return "+p.getAttribute("onsession")+"(event);"):null,onexception:p.getAttribute("onexception")?new Function("event","event","return "+p.getAttribute("onexception")+"(event);"):null});document.getElementsByTagName(j+"storages")[0].removeChild(r[n--])}}return q},f=function(){var n=document,m=document.getElementsByTagName(j+"config");if(m.length==0){return null}if(m.length==1){m=m[0];n=window.attachEvent?document:m}else{throw"xRTML requires a configuration tag per page."}return{debug:b.Common.Converter.toBoolean(m.getAttribute("debug")),logLevel:m.getAttribute("loglevel"),xrtmlActive:b.Common.Converter.toBoolean(m.getAttribute("xrtmlactive")),throwErrors:b.Common.Converter.toBoolean(m.getAttribute("throwerrors")),connectionAttempts:b.Common.Converter.toNumber(m.getAttribute("connectionattempts")),connectionTimeout:b.Common.Converter.toNumber(m.getAttribute("connectiontimeout")),remoteTrace:b.Common.Converter.toBoolean(m.getAttribute("remotetrace")),ortcUrl:m.getAttribute("ortcurl"),ortcLibrary:m.getAttribute("ortclibrary"),connections:g(n),storages:h(n)}},l=function(q,r){var m,n;if(q.attributes){for(var o=0;o<q.attributes.length;++o){m=q.attributes[o];if(m.specified){this[m.nodeName.toLowerCase()]=m.nodeValue}}}if(q.children.length!=0){for(var p=0;p<q.children.length;++p){n=q.children[p],childName=window.addEventListener?n.nodeName.split(":")[1].toLowerCase():n.nodeName.toLowerCase();if(!r){this[childName]=[];new l(n,this[childName])}else{if(n.attributes&&n.attributes.length==1){r.push(n.attributes[0].nodeValue)}else{r.push(new l(n))}if(n.children){new l(n,r)}}}}},i=function(){var q,r=[],o=b.TagManager.getClasses();for(var n=0;n<o.length;++n){q=document.getElementsByTagName(j+o[n]);for(var m=0;m<q.length;++m){var p=q[m];if(!window.addEventListener&&p.scopeName.toLowerCase()!="xrtml"){continue}if(c(p)){var t=new l(p);t.name=o[n];r.push(t);document.body.removeChild(q[m--])}}}return r};b.Event.extend(d);d.read=function(){var m=f();if(m){m.attribute=function(o){return b.Common.Object.insensitiveGetter(this,o)};this.fire({configLoad:{config:m}})}var n=i();if(n.length!=0){this.fire({tagsLoad:{tags:n}})}}})(b.DomParser=b.DomParser||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,g){var f=false,d=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;c.extend=function(k){var h=this.prototype;f=true;var l=new this();f=false;for(var j in k){l[j]=typeof k[j]=="function"&&typeof h[j]=="function"&&d.test(k[j])?(function(n,m){return function(){var p=this._super;this._super=h[n];var o=m.apply(this,arguments);this._super=p;return o}})(j,k[j]):k[j]}function i(){if(!f&&this.init){this.init.apply(this,arguments)}}i.prototype=l;i.prototype.constructor=i;i.extend=arguments.callee;return i}})(b.Class=b.Class||function(){})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,f){var d="";b.Event.extend(c);c.logLevels={error:0,warn:1,info:2};c.debug=false;c.logLevel=2;c.connectionAttempts=5;c.connectionTimeout=10000;c.remoteTrace=false;c.ortcLibrary=function(h,g){if(arguments.length!=0){d=h;b.Common.DOM.loadScript({url:h,callback:g})}return d};b.DomParser.bind({configLoad:function(h){var g=h.config;c.debug=g.attribute("debug")?g.attribute("debug"):c.debug;c.logLevel=g.attribute("logLevel")?g.attribute("logLevel"):c.logLevel;c.connectionAttempts=g.attribute("connectionAttempts")?g.attribute("connectionAttempts"):c.connectionAttempts;c.connectionTimeout=g.attribute("connectionTimeout")?g.attribute("connectionTimeout"):c.connectionTimeout;c.remoteTrace=g.attribute("remoteTrace")?g.attribute("remoteTrace"):c.remoteTrace;for(var j=0;j<g.connections.length;++j){b.ConnectionManager.create(g.connections[j])}for(var j=0;j<g.storages.length;++j){b.StorageManager.create(g.storages[j])}}})})(b.Config=b.Config||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,f){var d=(function(){if(typeof console!=="undefined"){return console}var g={id:null,buffer:[],style:"width: 100%; height: 40%; position: absolute; bottom:5px; left:5px; background: silver; padding: 5px; overflow: scroll;font-family:consolas,monospace;font-size:12px; ",printObject:function(h){var i="";for(property in h){i+=property+": "+h[property]+"; \n"}return i},newLine:function(j,h){var i=document.createElement("p");i.style.color=h;i.innerHTML=j;g.id?document.getElementById(g.id).appendChild(i):g.buffer.push(i)},log:function(h){g.newLine(h,"black")},warn:function(h){g.newLine(h,"orange")},error:function(h){g.newLine(h,"red")},debug:function(h){g.newLine(h,"green")},init:function(){g.id="xRTML_Console_"+b.Common.Util.idGenerator();var h=document.createElement("div");h.id=g.id;h.style.cssText=g.style;for(var j=0,k=g.buffer.length;j<k;j++){h.appendChild(g.buffer[j])}buffer=[];document.body.appendChild(h);h.style.display=b.Config.debug?"block":"none";if(b.Config.debug){document.body.appendChild(h)}}};return g})();if(!window.addEventListener&&typeof console=="undefined"&&b.Config.debug){c=d.init()}c.log=function(g){d.log(g)},c.warn=function(g){d.warn(g)},c.error=function(g){d.error(g);if(b.Config.remoteTrace===true){this.fire({error:{error:g}})}},c.debug=function(g){if(b.Config.debug===true){d.log(g)}};b.Event.extend(c)})(b.Console=b.Console||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,g){var d={uiEffects:{blind:true,bounce:true,clip:true,drop:true,explode:true,fade:true,fold:true,highlight:true,puff:true,pulsate:true,scale:true,shake:true,size:true,slide:true,transfer:true},cssPropsMapping:{"padding-top":"paddingTop"},checkIfEffectFunctionAvailable:function(i){var h=(jQuery&&jQuery.fn&&((typeof jQuery.fn[i]).toLowerCase()=="function"))||(jQuery&&jQuery.effects&&((typeof jQuery.effects[i]).toLowerCase()=="function"));if(!h){b.Error.raise({code:b.Error.Codes.MISSING_LIBRARY,info:{library:"jQuery",module:i,className:"xRTML.Effect.Manager (internal class, no docs available)",methodName:"checkIfEffectFunctionAvailable (internal method, no docs available)"}})}},callJQueryEffect:function(h){b.Console.debug("jQuery effect: Running "+h.effectName+" on element "+h.element.id+" with options "+b.JSON.stringify(h.effectOptions)+" and properties: "+b.JSON.stringify(h.effectProperties));this.checkIfEffectFunctionAvailable(h.effectName);try{if(this.uiEffects[h.effectName]){jQuery.fn.effect.call(jQuery(h.element),h.effectName,h.effectOptions,h.effectSpeed,h.effectCallback)}else{jQuery.fn[h.effectName].call(jQuery(h.element),h.effectProperties,h.effectOptions)}}catch(i){b.Error.raise({code:b.Error.Codes.UNEXPECTED,info:{message:i.message,className:"xRTML.Effect.Manager (internal class, no docs available)",methodName:"callJQueryEffect (internal method, no docs available)"}})}},buildReverseEffectProperties:function(h){var i={};for(var k in h.properties){var j=b.Common.Object.insensitiveGetter(h.element.style,k.replace("-",""));if(!j||j==""){j=b.Common.DOM.getStyle({element:h.element,rule:k})}i[k]=j}return i},cloneJQueryOptions:function(i){var h={};for(prop in i){h[prop]=i[prop]}return h}},f={runEffects:function(h){if(this.effects){if(typeof h.stopCurrent=="undefined"||h.stopCurrent){d.checkIfEffectFunctionAvailable("animate");jQuery(h.element).stop(false,true)}for(var k=0;k<this.effects.length;k++){try{var l=d.cloneJQueryOptions(typeof this.effects[k].options=="object"?this.effects[k].options:b.JSON.parse(this.effects[k].options)),m=typeof this.effects[k].properties=="object"?this.effects[k].properties:b.JSON.parse(this.effects[k].properties),n=d.buildReverseEffectProperties({properties:m,element:h.element})}catch(j){b.Error.raise({code:b.Error.Codes.JSON_PARSE,info:{message:j.message,className:"xRTML.Effect.Provider (internal class, no docs available)",methodName:"runEffects"}})}d.callJQueryEffect({element:h.element,effectName:this.effects[k].name,effectOptions:l,effectProperties:m,effectSpeed:this.effects[k].speed,effectCallback:this.effects[k].callback?(typeof this.effects[k].callback=="function"?this.effects[k].callback:new Function("","return "+this.effects[k].callback+"();")):null,revert:this.effects[k].revert});if(this.effects[k].revert){d.callJQueryEffect({element:h.element,effectName:this.effects[k].name,effectOptions:l,effectProperties:n,effectSpeed:this.effects[k].speed,effectCallback:null,revert:false})}}}}};c.extend=function(i){for(var h in f){i[h]=f[h]}}})(b.Effect=b.Effect||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,f){b.Event.extend(c);c.raise=function(g){var h=new c.XRTMLError(g);new window.Error().stack?b.Console.error(h):d(h);return h};c.XRTMLError=function(g){var h=!!g.code?g.code:b.Error.Codes.UNEXPECTED;this.name=h.type;var i=!!g.info?g.info:{};i.className=!!i.className?i.className:(!!g.target?(!!g.target.name?g.target.name:Object.prototype.toString.call(g.target)):"Unknown");i.id=!!i.id?i.id:(!!g.target?g.target.id:"Unknown");i.message=!!i.message?i.message:g.message;i.arguments=g.arguments;this.message=b.Common.String.template(h.message,i);this.type=h.type;this.target=g.target;this.info=i;c.fire({exception:{error:this}})};c.XRTMLError.prototype=window.Error.prototype;c.XRTMLError.prototype.constructor=c.XRTMLError;c.Codes={MANDATORY_PROPERTY:{type:"ValidationError",message:"The property {property} is required for a {className} with the id {id}."},INVALID_PROPERTY:{type:"ValidationError",message:"The property {property} of a {className} with the id {id} has the wrong type. The appropriate type would be {validType}."},CONNECTION_INACTIVE:{type:"ConnectionError",message:"Tried to perform an operation on Connection {id} which is not active."},CONNECTION_EXCEPTION:{type:"ConnectionError",message:"An unexpected problem occured on the Connection {id}. {message}"},CONNECTION_NOT_FOUND:{type:"ConnectionError",message:"Unable to find a Connection with the specified id: {id}."},CONNECTION_PROCESS:{type:"ConnectionError",message:"An error ocurred while processing the message {xRTMLMessage} arrived at Connection {id}. {message}"},CONNECTION_ADAPT:{type:"ConnectionError",message:"An error ocurred while adapting the message {originalMessage} arrived at Connection {id}. {message}"},CONNECTION_DUPLICATE:{type:"ConnectionError",message:"Connection with id {id} already exists."},ORTC_NOT_FOUND:{type:"ORTCError",message:"Unable to obtain the ORTC library from the address specified."},ORTC_UNAVAILABLE:{type:"ORTCError",message:"Connection {id}: ORTC client is not created yet."},ORTC_DISCONNECTED:{type:"ORTCError",message:"Connection {id}: Disconnect not possible. ORTC client is not connected."},ORTC_EXCEPTION:{type:"ORTCError",message:"An unexpected problem occured on the Connection {id}. {message}"},TAG_NOT_CREATED:{type:"TagError",message:"A problem occured while trying to create a {className} Tag with id {id}. {message}"},TAG_INACTIVE:{type:"TagError",message:"Tried to perform an action on a {className} with {id} which is not active."},TAG_UNREGISTERED:{type:"TagError",message:"The specified Tag does not exist in the registered tags namespace."},TAG_INVALID_CONFIG:{type:"TagError",message:"Unable to register a Tag with the specified configuration. {message}"},TAG_ABSTRACT:{type:"TagError",message:"The specified tag {tag} should not be instantiated."},TAG_ACTION_UNDEFINED:{type:"TagError",message:"Tried to perform an action {action} which is not defined on a {className} with id {id}."},TAG_NOT_FOUND:{type:"TagError",message:"Unable to find a Tag with the specified id: {id}."},TAG_PROCESS:{type:"TagError",message:"An error ocurred while processing the arrived message on a {className} with id {id}. {message}"},INVALID_MESSAGE:{type:"MessageError",message:"Tried to create a message with invalid properties. {message}"},TRIGGER_UNREGISTERED:{type:"MessageError",message:"A message arrived containing a trigger which is not registered by any Tag."},STORAGE_CONNECTION_UNAVAILABLE:{type:"StorageError",message:"The Remote Storage component for a {className} provider with id {id} could not find a connection with connectionId: {connectionId}"},STORAGE_UNAVAILABLE:{type:"StorageError",message:"The Remote Storage component for a {className} provider with id {id} is not available."},STORAGE_SESSION:{type:"StorageError",message:"The Remote Storage component for a {className} provider with id {id} was not able to get a session. {message}"},STORAGE_ACTION_UNDEFINED:{type:"StorageError",message:"Tried to perform an action which is not defined on a {className} with id {id}."},STORAGE_PERMISSIONS:{type:"StorageError",message:"Tried to perform an action for which the {className} with id {id} does not have the necessary permissions. Were the right channel permissions set on the server-side?"},STORAGE_OPERATION_TIMEOUT:{type:"StorageError",message:"The Storage operation with the id: {opId} was not completed whithin the expected timeout: {timeout}"},STORAGE_CALLBACK_FAILURE:{type:"StorageError",message:"The Storage operation with the id: {opId} callback has failed. {message}"},REQUEST_FAILURE:{type:"RequestError",message:"An error occured while calling the specified address. {message}"},REQUEST_UNAVAILABLE:{type:"RequestError",message:"Unable to obtain a response from the specified address."},REQUEST_UNSUPPORTED:{type:"RequestError",message:"This browser does not support XMLHttpRequest neither XDomainRequest."},JSON_PARSE:{type:"ParseError",message:"Unable to parse the specified String according to JSON specification rules. {message}"},DOM_PARSE:{type:"ParseError",message:"Unable to parse an XRTML DOM Node. "},MISSING_ARGUMENT:{type:"MethodError",message:"A method {methodName} was called but the required argument {argument} was undefined."},INVALID_ARGUMENT:{type:"MethodError",message:"The method {methodName} was called but the argument {argument} was of an invalid type. The expected type was {expectedType}"},UNEXPECTED:{type:"UnexpectedError",message:"An unexpected error occured. Cause error message is: {message}"},FATAL:{type:"FatalError",message:"A critical error occured. The error message is: {message}"},INVALID_DOM_ATTRIBUTE:{type:"InvalidDomAttribute",message:"An error occured when trying to retrive an unexisting attribute: {attribute}"},TEMPLATING:{type:"TemplateError",message:"An error occured when trying to apply bindings to a template. The cause is: {message}"},TEMPLATING_EFFECTS:{type:"TemplateError",message:"An error occured when trying to run effects binded in a template. Are the effects configured in the tag? The error cause is: {message}"},UNEXPECTEDMEDIA:{type:"UnexpectedMediaError",message:"An error occurred when trying to operate on media. The cause is: {message}"},UNEXPECTEDEVENT:{type:"UnexpectedEventError",message:'An error occurred when trying to process the "{eventType}" event handler. The cause is: {message}'},MISSING_LIBRARY:{type:"MissingLibrary",message:"A required library {library} {module} is not available. Please import this library."}};var d=function(h){var i=[];i.push(h.name+": "+h.message+"\n");function g(j,k,n,q){var m=[];for(var l=0;l<n;l++){m.push(" ")}var o=m.join("");if(q<9){for(var p in j){if(j.hasOwnProperty(p)&&p!="name"&&p!="message"){if(typeof j[p]==="string"||typeof j[p]==="number"||typeof j[p]==="boolean"){k.push((o+p+": "+j[p])+"\n")}else{if(b.Common.Object.isObject(j[p])){k.push(o+p+": \n");g(j[p],k,n+4,q+1)}else{if(b.Common.Array.isArray(j[p])){k.push(o+p+": \n");for(var l=0;l<j[p].length;l++){g(j[p],k,n+4,q+1)}}}}}}}else{k.push(o+j.toString()+"\n")}}g(h,i,0,1);b.Console.error(i.join(""))}})(b.Error=b.Error||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(f,g){f.contains=function(h){var k=h.items;for(var j=0,l=k.length;j<l;j++){if(b.Common.Object.equals({o1:k[j],o2:h.obj})){return true}}return false};f.isArray=function(h){return Object.prototype.toString.call(h)==="[object Array]"}})(b.Common.Array=b.Common.Array||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(f,g){f.equals=function(h){return b.JSON.stringify(h.o1)===b.JSON.stringify(h.o2)};f.isObject=function(h){return""+h=="[object Object]"};f.insensitiveGetter=function(h,j){for(var i in h){if(h.hasOwnProperty&&h.hasOwnProperty(i)&&(j+"").toLowerCase()==(i+"").toLowerCase()){return h[i];break}}};f.keys=window.Object.keys||function(j){var i=[],h;for(h in j){if(window.Object.prototype.hasOwnProperty.call(j,h)){i.push(h)}}return i}})(b.Common.Object=b.Common.Object||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(f,g){f.trim=function(h){return typeof window.String.prototype.trim=="function"?h.trim():h.replace(/^\s*/,"").replace(/\s*$/,"")};f.template=function(j,k){for(var h in k){var i=new RegExp("\\{"+h+"\\}","gm");j=j.replace(i,k[h])}return j}})(b.Common.String=b.Common.String||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(f,g){f.loadScript=function(h){var i=document.createElement("script");i.type="text/javascript";if(i.readyState){i.onreadystatechange=function(){if(i.readyState=="loaded"||i.readyState=="complete"){i.onreadystatechange=null;h.callback.apply(this,arguments)}}}else{i.onload=function(){h.callback.apply(this,arguments)}}i.src=h.url;document.getElementsByTagName("head")[0].appendChild(i)};f.getStyle=function(h){if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(h.element,"").getPropertyValue(h.rule)}if(h.element.currentStyle){var i=h.rule.replace(/\-(\w)/g,function(k,j){return j.toUpperCase()});return h.element.currentStyle[i]}return""}})(b.Common.DOM=b.Common.DOM||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(g,i){g.post=function(l){l.method="POST";h(l)};g.get=function(l){l.method="GET";if(l.data!="undefined"){var p=l.url,m=l.data;p+=p.indexOf("?")==-1?"?":"&";for(var n in l.data){var o=m[n];if(typeof o!="object"&&typeof o!="boolean"){p+=n+"="+o+"&"}}if(p.lastIndexOf("&")==p.length-1){p=p.slice(0,-1)}l.url=p}h(l)};var h=function(l){var m=f(l).create(l.method.toLowerCase(),l.url,b.Common.Function.proxy(function(o,n,p){if(typeof n!="undefined"&&n!=null){if(l.error){l.error(n)}}else{if(l.success){l.success(o)}}if(l.complete){l.complete(o,n,p)}},this),l.async,l.headers);m.send(l.data?l.data:null)},f=function(l){if(window.XMLHttpRequest&&(!l.crossDomain||"withCredentials" in k().getNativeObject())){return k()}else{if(window.XDomainRequest){return j()}else{b.Error.raise({code:b.Error.Codes.REQUEST_UNSUPPORTED,info:{className:"xRTML.Common.Request",methodName:"getRequestType (internal method, no docs available)"}})}}},k=function(){return{getNativeObject:function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(l){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(l){}try{return ActiveXObject("Microsoft.XMLHTTP")}catch(l){}}}b.Error.raise({code:b.Error.Codes.REQUEST_UNSUPPORTED,info:{className:"xRTML.Common.Request.XHR (internal class, no docs available)",methodName:"getNativeObject (internal method, no docs available)"}})},create:function(o,r,m,l,n){var q=this;q.xhr=this.getNativeObject();q.callback=m;o=o.toUpperCase();q.xhr.onreadystatechange=function(){try{if(this.readyState==4){if(this.status==200){q.callback(this.responseText,null,this.status)}else{if(this.status==0){q.callback(null,"The status code is 0 which likely means that the server is unavailable.",this.status)}else{q.callback(null,this.responseText,this.status)}}}}catch(t){b.Console.error(t)}};q.xhr.open(o,r,!!l?l:true);q.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");q.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var p in n){q.xhr.setRequestHeader(p,n[p])}if(o=="POST"){q.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}return q},send:function(l){if(l&&typeof(l)!="string"){l=b.JSON.stringify(l)}b.Console.debug("Performing request with payload: "+l);this.xhr.send(l)}}},j=function(){return{create:function(o,q,m,l){var p=this;p.xdr=new XDomainRequest();p.callback=m;o=o.toUpperCase();p.xdr.onload=function(){try{p.callback(p.xdr.responseText)}catch(r){b.Error.raise({code:b.Error.Codes.UNEXPECTED,info:{message:r.message,className:"xRTML.Common.Request.XDR (internal class, no docs available)",methodName:"onload (internal method, no docs available)"}})}};p.xdr.onerror=function(){try{p.callback(null,p.xdr.responseText)}catch(r){b.Error.raise({code:b.Error.Codes.UNEXPECTED,info:{message:r.message,className:"xRTML.Common.Request.XDR (internal class, no docs available)",methodName:"onerror (internal method, no docs available)"}})}};p.xdr.open(o,q,!!l?l:true);try{p.xdr.contentType="text/plain"}catch(n){}return p},send:function(l){var m=this;function n(o){if(o&&typeof(o)!="string"){o=b.JSON.stringify(o)}b.Console.log("Performing request with payload:"+o);m.xdr.send(o);if(m.xdrTimeout){clearTimeout(m.xdrTimeout);m.xdrTimeout=i}}if(m.xdrReady){n(l)}else{m.xdrTimeout=setTimeout(function(){n(l)},500)}}}}})(b.Common.Request=b.Common.Request||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(f,g){f.setCookie=function(h){var i=h.name+"="+escape(h.value);if(h.expires){i+="; expires="+h.expires.toGMTString()}if(h.path){i+="; path="+escape(h.path)}else{i+="; path=/"}if(h.domain){i+="; domain="+escape(h.domain)}if(h.secure){i+="; secure"}document.cookie=i};f.getCookie=function(h){var i=document.cookie.match("(^|;) ?"+h.name+"=([^;]*)(;|$)");if(i){return(unescape(i[2]))}return g};f.deleteCookie=function(h){h.value="";h.expires=new Date("Thu, 01 Jan 1970 00:00:01 GMT");f.setCookie(h)}})(b.Common.Cookie=b.Common.Cookie||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(g,f){g.validateRequired=function(h){if(!h.target[h.prop]&&h.target[h.prop]!=0&&(b.Common.Array.isArray(h.target[h.prop])&&h.target[h.prop].length<=0)){b.Error.raise({code:b.Error.Codes.MANDATORY_PROPERTY,target:h.target,info:{property:h.prop}})}}})(b.Common.Validator=b.Common.Validator||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(f,g){f.toBoolean=function(h){return typeof h==="undefined"?h:(/^true|1|yes$/i).test(h)};f.toNumber=function(h){if(typeof h==="undefined"){return h}if(typeof h=="number"){return h}if(typeof h=="string"){return b.Common.String.trim(h)==""?0:window.Number(h)}}})(b.Common.Converter=b.Common.Converter||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(h,g){var f=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};h.guidGenerator=function(){return(f()+f()+"-"+f()+"-"+f()+"-"+f()+"-"+f()+f()+f())};h.idGenerator=function(){return(f()+f())}})(b.Common.Util=b.Common.Util||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){(function(f,g){f.proxy=function(i,h){if(typeof i==="function"&&typeof h==="object"){return function(){return i.apply(h,arguments)}}};f.parse=function(k){if(typeof k=="function"){return k}if(typeof k!="string"){return null}var h="",j="return "+k+"(";if(arguments.length!=1){for(var l=1;l<arguments.length;++l){h+=arguments[l]+","}h=h.substring(0,h.length-1)}j+=h+");";return new window.Function(h,j)}})(b.Common.Function=b.Common.Function||{})})(b.Common=b.Common||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,h){var d={},f=function(i){for(var j in d){if(d[j].id===i){return d[j]}}return h},g={add:function(i){var j=i.connection.id;if(!this.bConnections[j]){this.bConnections[j]=[];i.connection.bind({connect:this.send})}this.bConnections[j].push(i.message)},bConnections:{},send:function(k){var m=g.bConnections[k.target.id],j=k.target;for(var l=0;l<m.length;++l){j.send(m[l])}j.unbind({connect:g.send});g.bConnections[k.target.id]=h}};c.create=function(i){i.attribute=function(j){return b.Common.Object.insensitiveGetter(this,j)};return this.add(new this.Connection(i))};c.add=function(i){if(this.getById(i.id)){throw new b.Error({code:b.Error.Codes.CONNECTION_DUPLICATE,target:i})}this.Connections.push(i.id);this.fire({connectionCreate:{connection:i}});d[i.internalId]=i;i.bind({xrtmlMessage:function(j){c.fire({xrtmlMessage:{connection:j.target,channel:j.channel,message:j.message}})}});i.bind({dispose:function(m){var j=m.target.internalId,l=d[j];d[j]=null;delete d[j];for(var n=0,k=c.Connections,o=k.length;n<o;n++){if(k[n]===m.target.id){k.splice(n,1);break}}c.fire({connectionDispose:{connection:m.target}})}});return i};c.getById=function(i){return d[i]||f(i)};c.dispose=function(j){var i=this.getById(j);if(i){i.dispose()}else{b.Console.warn("ConnectionManager: Connection "+j+" was not found.")}};c.addChannel=function(i){var j=this.getById(i.connectionId);if(typeof j==="undefined"){j=this.getConnectionById(i.connectionId);if(j===null){b.Error.raise({code:b.Error.Codes.CONNECTION_NOT_FOUND,target:this,info:{className:"xRTML.ConnectionManager",methodName:"addChannel"}})}}j.createChannel(i)};c.sendMessage=function(l){var j=null;for(var k=0;k<l.connections.length;++k){j=this.getById(l.connections[k]);if(j){if(j.isConnected()){j.send(l)}else{g.add({connection:j,message:{channel:l.channel,content:l.content,sendOnly:l.sendOnly}});b.Console.debug("ConnectionManager: Connection with id "+l.connections[k]+" is not connected. Buffering message:");b.Console.debug(l)}}else{b.Error.raise({code:b.Error.Codes.CONNECTION_NOT_FOUND,target:this,info:{className:"xRTML.ConnectionManager",methodName:"sendMessage"}})}}};c.Connections=[];b.Event.extend(c)})(b.ConnectionManager=b.ConnectionManager||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){c.Connection=function(g){var m=null,f=true;b.Event.extend(this);this.internalId=b.Common.Util.guidGenerator();this.id=g.attribute("id")||this.internalId;this.appKey=g.attribute("appKey");this.authToken=g.attribute("authToken");this.sendRetries=parseInt(g.attribute("sendRetries"))||5;this.sendInterval=parseInt(g.attribute("sendInterval"))||1000;this.timeout=g.attribute("timeout")||b.Config.connectionTimeout;this.connectAttempts=g.attribute("connectAttempts")||b.Config.connectionAttempts;this.connectionAttemptsCounter=0;this.autoConnect=g.attribute("autoConnect")?b.Common.Converter.toBoolean(g.attribute("autoConnect")):true;this.metadata=g.attribute("metadata");this.serverType=g.attribute("serverType")||"IbtRealTimeSJ";this.url=g.attribute("url")||b.Console.error("Connection "+(this.id||this.internalId)+": ORTC Server URL must be set.");this.isCluster=g.attribute("isCluster")?b.Common.Converter.toBoolean(g.attribute("isCluster")):true;this.announcementSubChannel=g.attribute("announcementSubChannel");this.channels={};var p=b.Common.Function.parse,n=b.Common.Function.proxy;this.messageAdapter=p(g.attribute("messageAdapter"),"message");this.bind({create:p(g.attribute("onCreate"),"e"),connect:p(g.attribute("onConnect"),"e"),disconnect:p(g.attribute("onDisconnect"),"e"),subscribe:p(g.attribute("onSubscribe"),"e"),unsubscribe:p(g.attribute("onUnsubscribe"),"e"),exception:p(g.attribute("onException"),"e"),reconnect:p(g.attribute("onReconnect"),"e"),reconnecting:p(g.attribute("onReconnecting"),"e"),message:p(g.attribute("onMessage"),"e"),dispose:p(g.attribute("onDispose"),"e")});var l=n(function(q,i,r){this.process({channel:i,message:r})},this),k=function(i){m=i.createClient();m.setId(this.internalId);m.setConnectionTimeout(this.timeout);m.setConnectionMetadata(this.metadata);m.setAnnouncementSubChannel(this.announcementSubChannel);!this.isCluster?m.setUrl(this.url):m.setClusterUrl(this.url);m.onConnected=n(function(t){for(var r in this.channels){var q=this.channels[r];if(q.subscribe){t.subscribe(q.name,q.subscribeOnReconnect,l)}}this.fire({connect:{}})},this);m.onDisconnected=n(function(q){this.fire({disconnect:{}})},this);m.onSubscribed=n(function(r,q){this.channels[q].fire({subscribe:{}});this.fire({subscribe:{channel:q}})},this);m.onUnsubscribed=n(function(r,q){var t=this.channels[q];delete this.channels[q];t.fire({unsubscribe:{}});this.fire({unsubscribe:{channel:q}})},this);m.onException=n(function(r,q){this.fire({exception:{message:q}});b.Error.raise({code:b.Error.Codes.ORTC_EXCEPTION,target:this,info:{className:"ORTCClient",methodName:"onException",message:q}})},this);m.onReconnected=n(function(q){this.connectionAttemptsCounter=0;this.fire({reconnect:{}})},this);m.onReconnecting=n(function(q){if(this.connectionAttemptsCounter>=this.connectAttempts){q.disconnect()}else{this.connectionAttemptsCounter++;this.fire({reconnecting:{}})}},this);this.fire({create:{}});if(this.autoConnect){m.connect(this.appKey,this.authToken)}};var o=function(i,q){if(this.isCreated()&&this.isConnected()){this.send(i)}else{if(++q<=this.sendRetries){setTimeout(n(function(){n(o,this)(i,q)},this),this.sendInterval);b.Console.debug("Message "+i.content+" not sent to channel "+i.channel+". Retry "+q+"/"+this.sendRetries+" in "+this.sendInterval/1000+" seconds.")}else{b.Console.debug("Message "+i.content+" not sent to channel "+i.channel+". Discarding message.")}}};this.active=function(i){if(!i){return f}f=b.Common.Converter.toBoolean(i);return f};this.dispose=function(){if(this.isConnected()){this.disconnect()}this.fire({dispose:{}})};this.createChannel=function(i){i.attribute=function(r){return b.Common.Object.insensitiveGetter(this,r)};var q={connectionId:i.attribute("connectionId")||this.id,name:i.attribute("name"),subscribeOnReconnect:i.attribute("subscribeOnReconnect")?b.Common.Converter.toBoolean(i.attribute("subscribeOnReconnect")):true,subscribe:i.attribute("subscribe")?b.Common.Converter.toBoolean(i.attribute("subscribe")):true,messageAdapter:p(i.attribute("messageAdapter","message"))};b.Event.extend(q);q.bind({message:p(i.attribute("onMessage"),"e"),subscribe:p(i.attribute("onSubscribe"),"e"),unsubscribe:p(i.attribute("onUnsubscribe"),"e")});this.channels[i.name]=q;this.fire({channelCreate:{channel:q}});return q};this.process=function(q){var i=q.channel,t=q.message;if(t.substring(0,15)=="_X_SEND_ONLY_X_"){if(this.internalId==t.substring(15,51)){return}t=t.substring(54)}if(this.active()){try{if(this.messageAdapter){t=this.messageAdapter(t)}if(this.channels[i]&&this.channels[i].messageAdapter){t=this.channels[i].messageAdapter(t)}}catch(r){b.Error.raise({code:b.Error.Codes.CONNECTION_ADAPT,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"process",originalMessage:t,message:r.message}})}this.channels[i].fire({message:{message:t}});this.fire({message:{channel:i,message:t}});if(b.MessageManager.isValid(t)){this.fire({xrtmlMessage:{message:b.MessageManager.toJson(t).xrtml,channel:i}})}}else{b.Console.debug("Connection "+(this.id||this.internalId)+" : Not active. Message received wasn't processed.")}};this.send=function(i){var q=i.channel,r=i.content;if(typeof r==="object"){r=r.stringify()}if(this.isCreated()&&this.isConnected()){if(this.active()){if(i.sendOnly){r="_X_SEND_ONLY_X_"+this.internalId+"_X_"+r}m.send(q,r);var t;try{t=b.JSON.parse(r)}catch(u){t=r}b.Console.debug("Connection "+(this.id||this.internalId)+": Message sent to channel "+q);b.Console.debug(t)}else{b.Console.debug("Connection "+(this.id||this.internalId)+": Not active. Message not sent to channel "+q);b.Console.debug(r)}}else{setTimeout(n(function(){n(o,this)(i,0)},this),this.sendInterval);b.Console.debug("Connection "+(this.id||this.internalId)+": Not ready. Message not sent to channel "+q+". Retrying in "+this.sendInterval/1000+" seconds.");b.Console.debug(r)}};this.connect=function(i){if(this.isCreated()){if(i){this.appKey=i.appKey;this.authToken=i.authToken}m.connect(this.appKey,this.authToken)}else{b.Error.raise({code:b.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"connect"}})}};this.disconnect=function(){this.isConnected()?m.disconnect():b.Error.raise({code:b.Error.Codes.ORTC_DISCONNECTED,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"disconnect"}})};this.subscribe=function(i){i=this.createChannel(i);m.subscribe(i.name,i.subscribeOnReconnect,l)};this.unsubscribe=function(i){m.unsubscribe(i)};this.isCreated=function(){return m!=null};this.isConnected=function(){return this.isCreated()?m.getIsConnected():false};this.isSubscribed=function(i){return this.isConnected()?m.isSubscribed(i):false};this.getMetadata=function(){return this.isCreated()?m.getConnectionMetadata():b.Error.raise({code:b.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"getMetadata"}})};this.setMetadata=function(i){return this.isCreated()?m.setConnectionMetadata(i):b.Error.raise({code:b.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"setMetadata"}})};this.getAnnouncementSubChannel=function(){return this.isCreated()?m.getAnnouncementSubChannel():b.Error.raise({code:b.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"getAnnouncementSubChannel"}})};this.getProtocol=function(){return this.isConnected()?m.getProtocol():b.Error.raise({code:b.Error.Codes.ORTC_UNAVAILABLE,target:this,info:{className:"xRTML.ConnectionManager.Connection",methodName:"getProtocol"}})};this.setProtocol=function(i){if(this.isCreated()){m.setProtocol(i)}};if(typeof loadOrtcFactory!="undefined"){loadOrtcFactory(this.serverType,n(k,this))}else{b.bind({ready:n(function(){n(loadOrtcFactory,this)(this.serverType,n(k,this))},this)})}if(g.attribute("channels")){var h=g.attribute("channels");for(var j=0;j<h.length;++j){this.createChannel(h[j])}}}})(b.ConnectionManager=b.ConnectionManager||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(d,g){var f={},c=function(h){for(var i in f){if(f[i].id===h){return f[i]}}b.Console.warn("Storage with id: "+h+" was not found.");return g};d.create=function(h){try{var k=new d[h.type||"KeyValuePairStorage"](),j=d.BaseStorage.extend(k);h.attribute=function(l){return b.Common.Object.insensitiveGetter(h,l)};j=new j(h);j.bind({dispose:function(m){var n=m.target.internalId,l=f[n];f[n]=null;delete f[n];d.fire({storagedispose:{storage:m.target}})}});f[j.internalId]=j;d.fire({storagecreate:{storage:j}});return j}catch(i){b.Error.raise({code:b.Error.Codes.UNEXPECTED,info:{message:i.message,className:"xRTML.StorageManager",methodName:"create"}})}};d.getById=function(h){return f[h]||c(h)};b.Event.extend(d)})(b.StorageManager=b.StorageManager||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(d,f){var c=function(){this.init=function(h){b.Event.extend(this);this.internalId=b.Common.Util.guidGenerator();this.id=h.attribute("id")||this.internalId;this.type=h.attribute("type")||"KeyValuePairStorage";this.isReady=false;var g=h.attribute("autoConnect");this.autoConnect=typeof g!="undefined"?b.Common.Converter.toBoolean(g):true;this.dispose=function(){this.fire({dispose:{}})};this.bind({ready:b.Common.Function.parse(h.attribute("onready")),exception:b.Common.Function.parse(h.attribute("onexception"))})}};d.BaseStorage=b.Class.extend(new c())})(b.StorageManager=b.StorageManager||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(d,f){var c=function(){this.init=function(o){this._super(o);var n=o.attribute("baseUrl");this.baseUrl=!!n?(n[n.length-1]=="/"?n.substring(0,(n.length-1)):n):null;b.Common.Validator.validateRequired({target:this,prop:"baseUrl"});this.connectionId=o.attribute("connectionId");this.sessionId=o.attribute("sessionId");var p=o.attribute("operationsTimeout");this.operationsTimeout=!!p?p:2000;this.bind({session:b.Common.Function.parse(o.attribute("onsession"))});if(this.autoConnect){this.openConnection()}};var j={};var m=[];var g={get:"readRequestChannel",set:"writeRequestChannel",del:"writeRequestChannel",incr:"writeRequestChannel"};var h={readRequestChannel:f,readResponseChannel:f,writeRequestChannel:f,writeResponseChannel:f};var i;this.set=function(o,n){k.call(this,{data:o,action:"set",callback:n})};this.del=function(o,n){k.call(this,{data:o,action:"del",callback:n})};this.incr=function(o,n){k.call(this,{data:o,action:"incr",callback:n})};this.get=function(o,n){k.call(this,{data:o,action:"get",callback:n})};var k=function(q){if(this.isReady){var p=b.Common.Util.guidGenerator();j[p]={callback:q.callback,timeout:setTimeout(b.Common.Function.proxy(function(){b.Error.raise({code:b.Error.Codes.STORAGE_OPERATION_TIMEOUT,target:this,info:{opId:p,timeout:this.operationsTimeout,className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"performRemoteDataOperation (internal method, no docs available)"}})},this),this.operationsTimeout)};var n=q.data;n.namespaceExpire=n.namespaceExpire||31556926;n.opId=p;var o=b.MessageManager.create({action:q.action,data:n,senderId:this.internalId});i.send({channel:h[g[q.action]],content:o})}else{m.push(q);b.Console.warn("Storage operation placed in buffer. Will only be called when the Storage is ready.")}};var l=function(q){var o=q.data;var p=o.opId;o.opId=null;delete o.opId;var n={success:q.success,data:q.success?o:null,error:!q.success?q.data.error:null};if(j[p]&&j[p].callback){j[p].callback(n)}clearTimeout(j[p].timeout);j[p]=null;delete j[p]};this.getSession=function(n){b.Common.Request.post({url:this.baseUrl+"/getStorageSession",data:n,crossDomain:true,success:b.Common.Function.proxy(function(q){var p;try{p=b.JSON.parse(q)}catch(o){b.Error.raise({code:b.Error.Codes.JSON_PARSE,target:this,info:{className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"getSession",message:o.message}})}this.sessionId=p.sessionId;this.fire({session:{sessionId:this.sessionId}});if(n.autoConnect){this.openConnection()}},this),error:b.Common.Function.proxy(function(o){b.Error.raise({code:b.Error.Codes.STORAGE_SESSION,target:this,info:{className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"getSession",message:o}})},this)})};this.openConnection=function(){if(this.sessionId){b.Common.Request.post({url:this.baseUrl+"/openStorageConnection",data:{sessionId:this.sessionId},crossDomain:true,success:b.Common.Function.proxy(function(u){var t;try{t=b.JSON.parse(u)}catch(r){b.Error.raise({code:b.Error.Codes.JSON_PARSE,target:this,info:{className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"openConnection",message:r.message}})}h.readRequestChannel=t.channels.readRequestChannel;h.readResponseChannel=t.channels.readResponseChannel;h.writeRequestChannel=t.channels.writeRequestChannel;h.writeResponseChannel=t.channels.writeResponseChannel;if(!!this.connectionId){i=b.ConnectionManager.getById(this.connectionId)}else{var o={appKey:t.appKey,authToken:t.authToken,url:t.url,isCluster:t.isCluster,serverType:t.serverType};i=b.ConnectionManager.create(o)}function p(v){v.bind({xrtmlMessage:b.Common.Function.proxy(function(y){if(y.channel==h.readResponseChannel||y.channel==h.writeResponseChannel){var z=y.message;l.call(this,{success:z.action=="exception"?false:true,data:z.data})}},this)});var w=false;var x=false;v.bind({subscribe:b.Common.Function.proxy(function(y){if(y.channel==h.readResponseChannel){w=true}if(y.channel==h.writeResponseChannel){x=true}if(w&&x){this.isReady=true;for(var z=0,A=m.length;z<A;z++){k.call(this,m[z])}m=[];this.fire({ready:{}})}},this)});v.subscribe({name:h.readResponseChannel});v.subscribe({name:h.writeResponseChannel})}if(i.isConnected()){p.call(this,i)}else{if(i.autoConnect){i.bind({connect:b.Common.Function.proxy(function(v){p.call(this,v.target)},this)})}else{i.bind({connect:b.Common.Function.proxy(function(v){p.call(this,v.target)},this)});function q(v){if(!v.appKey&&!v.authToken){v.appKey=t.appKey;v.authToken=t.authToken}v.connect()}if(i.isCreated()){q.call(this,i)}else{i.bind({create:b.Common.Function.proxy(function(v){q.call(this,v.target)},this)})}}}},this),error:b.Common.Function.proxy(function(o){b.Error.raise({code:b.Error.Codes.REQUEST_FAILURE,target:this,info:{className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"openConnection",message:o}})},this)})}else{i=b.ConnectionManager.getById(this.connectionId);if(!!i){var n={appKey:i.appKey,serverUrl:i.url,isCluster:i.isCluster,serverType:i.serverType,timeToLive:900,authenticate:false,autoConnect:true};this.getSession(n)}else{b.Error.raise({code:b.Error.Codes.STORAGE_CONNECTION_UNAVAILABLE,target:this,info:{connectionId:this.connectionId,className:"xRTML.StorageManager.KeyValuePairStorage",methodName:"openConnection"}})}}}};d.KeyValuePairStorage=c})(b.StorageManager=b.StorageManager||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(k,m){var j={},l={},d=null,g=function(n){for(var o in j){if(j[o].id===n){return j[o]}}b.Console.log("Tag with id: "+n+" was not found.");return m},f=function(o){if(o.base!="Tag"){var n=f(new l[o.base]());o=n.extend(o)}else{o=d.extend(o)}return o},c=function(n){return b.Common.Object.insensitiveGetter(this,n)},i=[];if(!b.domLoaded()){function h(){var n;for(var o=0;o<i.length;++o){n=i[o];b.Console.debug("TagManager: Creating a "+n.tagObject.name+" tag after the HTML page has been fully loaded.");b.TagManager.create(n.tagObject,n.fn)}i=[];b.Event.unbind(window,{load:h})}b.Event.bind(window,{load:h})}k.register=function(o){var n=o.name;if(n){if(n!="Tag"){if(!l[n]){if(!o.base){o.base="Tag"}l[n]=o.struct;l[n].prototype.base=o.base;l[n].prototype.name=o.name;l[n].prototype["abstract"]=o["abstract"]||false}}else{d=o.struct}}else{b.Error.raise({code:b.Error.Codes.TAG_INVALID_CONFIG,target:this,info:{message:"Please provide the tag name.",className:"xRTML.TagManager",methodName:"register"}})}};k.create=function(q,o){try{if((q.target||q.template)&&!b.domLoaded()){i.push({tagObject:q,fn:o});b.Console.debug("TagManager: Creating a "+q.name+" tag was postponed until HTML page has been fully loaded.");return}q.attribute=c;if(!l[q.name]){throw b.Error.raise({code:b.Error.Codes.TAG_UNREGISTERED,info:{tagName:q.name,className:"xRTML.TagManager",methodName:"create"}})}var p=new l[q.name]();if(!!p["abstract"]){throw b.Error.raise({code:b.Error.Codes.TAG_ABSTRACT,target:this,info:{tag:p,className:"xRTML.TagManager",methodName:"create"}})}var r=p.base=="Tag"?d.extend(p):f(p);r=new r(q);r.fire({postInit:{}});r.bind({dispose:function(u){var v=u.target.internalId,t=j[v];j[v]=null;delete j[v];k.fire({tagDispose:{tag:u.target}})}});j[r.internalId]=r;k.fire({tagCreate:{tag:r}});if(o){o(r)}}catch(n){b.Error.raise({code:b.Error.Codes.TAG_NOT_CREATED,target:this,info:{id:q.id,className:"xRTML.TagManager."+q.name,methodName:"init",message:n.message,tagConfig:q}})}};k.getById=function(n){return j[n]||g(n)};k.getClasses=function(){var o=[];for(var n in l){o.push(n)}return o};b.Event.extend(k);b.DomParser.bind({tagsLoad:function(n){var p=n.tags;for(var o=0;o<p.length;++o){k.create(p[o])}}})})(b.TagManager=b.TagManager||{})})(window.xRTML=window.xRTML||{});xRTML.TagManager.register({name:"Tag","abstract":true,struct:xRTML.Class.extend(new function(){this.init=function(a){xRTML.Event.extend(this);var b=xRTML.Common.Function.parse;this.bind({preInit:b(a.attribute("onPreInit")),postInit:b(a.attribute("onPostInit")),active:b(a.attribute("onActive")),preProcess:b(a.attribute("onPreProcess")),postProcess:b(a.attribute("onPostProcess")),dispose:b(a.attribute("onDispose"))});this.fire({preInit:{}});this.internalId=xRTML.Common.Util.guidGenerator();this.id=a.attribute("id")||this.internalId;this.connections=a.attribute("connections")||[];this.channelId=a.attribute("channelId");this.triggers=a.attribute("triggers")||[];this.receiveOwnMessages=!!a.attribute("receiveOwnMessages");this.target=(function(){var c=xRTML.Sizzle(a.attribute("target"));if(c.length==0){c.push(document.body)}return c})();this.active=a.attribute("active")?xRTML.Common.Converter.toBoolean(a.attribute("active")):true};this.activate=function(a){this.active=xRTML.Common.Converter.toBoolean(a.active);this.fire({active:{value:this.active}})};this.process=function(a){};this.sendMessage=function(a){xRTML.ConnectionManager.sendMessage({connections:a.connectionId?[a.connectionId]:this.connections,channel:a.channel||this.channelId,content:xRTML.MessageManager.create({trigger:a.trigger?[a.trigger]:this.triggers,action:a.action,data:a.data,senderId:this.internalId})})};this.dispose=function(){this.target=null;this.fire({dispose:{}})};this.registerTrigger=function(a){xRTML.MessageBroker.registerTrigger({name:a,tagId:this.internalId})};this.unregisterTrigger=function(a){xRTML.MessageBroker.unregisterTrigger({name:a,tagId:this.internalId})}})});(function(b,a){(function(c,i){var g={},f=function(p){if(g[p.name]){for(var o in g[p.name]){var n=b.TagManager.getById(o),m=p.message;if(n.active||m.data.action=="activate"){if(n.receiveOwnMessages||!m.senderId||n.internalId!==m.senderId){var l=m.data,k=m.action;n.fire({preProcess:l});if(k){n[k]?n[k].call(n,l):b.Error.raise({code:b.Error.Codes.TAG_ACTION_UNDEFINED,target:n,info:{action:k,className:"xRTML.MessageBroker",methodName:"triggerCall (internal method, no docs available)"}})}else{n.process(l)}n.fire({postProcess:l})}}else{b.Error.raise({code:b.Error.Codes.TAG_INACTIVE,target:n,className:"xRTML.MessageBroker",methodName:"triggerCall (internal method, no docs available)"})}}}else{b.Console.debug("Trigger "+p.name+" is not registered with any xRTML Tag.")}},d=function(k){var m=k.tag,n;for(var l=0;l<m.triggers.length;++l){n=m.triggers[l];c.registerTrigger({tagId:m.internalId,name:n})}},j=function(k){var m=k.tag,n;for(var l=0;l<m.triggers.length;++l){n=m.triggers[l];c.unregisterTrigger({tagId:m.internalId,name:n})}},h=function(k){var m=k.message.trigger;if(typeof m=="string"){f({name:m,message:k.message})}else{if(m instanceof Array){for(var l=0;l<m.length;++l){k.message.trigger=m[l];f({name:m[l],message:k.message})}}}};c.registerTrigger=function(k){if(!g[k.name]){g[k.name]={}}g[k.name][k.tagId]=i;c.fire({triggerRegister:{trigger:k}})};c.unregisterTrigger=function(l){var k=g[l.name];if(!k){b.Console.warn("The trigger "+l.name+" is not registered.");return}if(k.hasOwnProperty(l.tagId)){delete g[l.name][l.tagId];if(!b.Common.Object.keys(k).length){delete g[l.name]}c.fire({triggerUnregister:{trigger:l}})}else{b.Console.warn("The tag "+l.tagId+" is not listening to messages with the trigger "+l.name+".")}};b.Event.extend(c);b.TagManager.bind({tagCreate:d,tagDispose:j});b.ConnectionManager.bind({xrtmlMessage:h})})(b.MessageBroker=b.MessageBroker||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(c,d){c.isValid=function(h){try{if(typeof h==="string"){var g=h.substring(h.indexOf('"'),h.indexOf('"',h.indexOf('"')+1)+1);if('"xrtml"'!=b.Common.String.trim(g)){return false}b.JSON.parse(h);return true}if((typeof h==="object")&&h.xrtml){return true}return false}catch(f){b.Error.raise({code:b.Error.Codes.INVALID_MESSAGE,target:this,message:f.message,info:{className:"xRTML.MessageManager",methodName:"isValid"}})}};c.toJson=function(g){if(typeof g==="string"&&c.isValid(g)){var f=b.JSON.parse(g).xrtml;var h={xrtml:{senderId:f.s,trigger:f.t,action:f.a,data:f.d}};return h}return g};c.stringify=function(f){var g={xrtml:{s:f.senderId,t:f.trigger,a:f.action,d:f.data&&typeof f.data!="object"?b.JSON.parse(f.data):f.data}};return b.JSON.stringify(g)};c.create=function(f){f.data=f.data&&typeof f.data!="object"?b.JSON.parse(f.data):f.data;f.stringify=function(){return c.stringify(this)};return f}})(b.MessageManager=b.MessageManager||{})})(window.xRTML=window.xRTML||{});(function(b,a){(function(f,g){var d=function(j,k){if(b.Config.remoteTrace){var h=null;try{h=b.JSON.stringify(k)}catch(i){}var l=b.MessageManager.create({data:{message:j,content:h}});b.ConnectionManager.sendMessage(b.TraceMonitor.channelId,l)}};f.channelId="trace";b.Console.bind({error:function(h){d("Error",h.error)}});b.ConnectionManager.bind({connectionCreate:function(i){var h=i.connection;d("Connection found: \n AppKey: "+h.appKey+" \n AuthToken: "+h.authToken+" \n Url: "+h.url,h);h.bind({create:function(j){var k="Connection "+j.target.id+" created. "+(j.target.autoConnect?"Connecting...":"Waiting for explicit connect...");b.Console.debug(k);d(k,j.target)},connect:function(j){var k="Connection "+j.target.id+" established. Using "+j.target.getProtocol()+" protocol.";b.Console.debug(k);d(k,j.target)},disconnect:function(j){var k="Connection "+j.target.id+" closed.";b.Console.debug(k);d(k,j.target)},subscribe:function(j){var k="Connection "+j.target.id+": Channel "+j.channel+" subscribed.";b.Console.debug(k);d(k,j.target)},unsubscribe:function(j){var k="Connection "+j.target.id+": Channel "+j.channel+" unsubscribed.";b.Console.debug(k);d(k,j.target)},exception:function(j){var k="Connection "+j.target.id+" threw an exception: "+j.event;b.Console.debug(k);d(k,j.target)},reconnect:function(j){var k="Connection "+j.target.id+" is restored. Using "+j.target.getProtocol()+" protocol.";b.Console.debug(k);d(k,j.target)},reconnecting:function(j){var k="Connection "+j.target.id+" was lost. ";if(j.target.connectionAttemptsCounter>=j.target.connectAttempts){k+="Maximum number of attempts reached: "+j.target.connectAttempts+" Stop trying to reconnect."}else{k+="Trying to reconnect. Attempt "+j.target.connectionAttemptsCounter+" out of "+j.target.connectAttempts}b.Console.debug(k);d(k,j.target)},message:function(j){var l="Connection "+j.target.id+": Message received from channel "+j.channel,m;try{m=b.JSON.parse(j.message)}catch(k){m=j.message}b.Console.debug(l);b.Console.debug(m);d(m,j.target)},xrtmlMessage:function(j){var k="Connection "+j.target.id+": xRTML Message received from channel "+j.channel;b.Console.debug(k);b.Console.debug(j.message);d(j.message,j.target)}})}});var c=function(h){var i="Tag "+h.target.id+": "+h.type+" message";b.Console.debug(i);b.Console.debug(h.data);d(i,h.data)};b.TagManager.bind({tagCreate:function(h){var i=h.tag;b.Console.debug("Tag of type "+i.name+" created with id "+(i.id||i.internalId));b.Console.debug(i);i.bind({init:function(j){b.Console.debug("")},load:function(j){b.Console.debug("")},active:function(j){b.Console.debug("")},process:c,preProcess:c,postProcess:c})},tagDispose:function(h){var j=h.tag,i="Tag of type "+h.name+" with id "+(j.id||j.internalId)+" disposed.";b.Console.debug(i);d(i,h.tag)}});b.MessageBroker.bind({triggerRegister:function(h){var i="Tag "+h.trigger.tagId+" registered trigger: "+h.trigger.name;b.Console.debug(i);d(i,h.target)},triggerUnregister:function(h){var i="Tag "+h.trigger.tagId+" unregistered trigger: "+h.trigger.name;b.Console.debug(i);d(i,h.target)}});b.DomParser.bind({configLoad:function(h){b.Console.debug("DOM Parser: the following connections were read from DOM: ");b.Console.debug(h.config.connections);b.Console.debug("DOM Parser: the following storages were read from DOM: ");b.Console.debug(h.config.storages)},tagsLoad:function(h){b.Console.debug("DOM Parser: the following tags were read from DOM: ");b.Console.debug(h.tags)}})})(b.TraceMonitor=b.TraceMonitor||{})})(window.xRTML=window.xRTML||{});(function(d,c){var b=function(){d.isReady=true;d.fire({ready:{}})};(typeof loadOrtcFactory=="undefined")?d.Config.ortcLibrary(((document.location.protocol=="file:")?"http:":document.location.protocol)+"//dfdbz2tdq3k01.cloudfront.net/js/2.1.0/ortc.js",b):b();var a=function(){d.DomParser.read();if(d.isReady){d.isLoaded=true;d.fire({load:{}})}else{d.ready(function(){d.isLoaded=true;d.fire({load:{}})})}};d.domLoaded()?a():d.Event.bind(window,{load:a})})(window.xRTML=window.xRTML||{});(function(b,a){(function(d,f){var c=f;(function(k,h,i,j){var g=true;!function(l){l(c={})}(function(r){var q=typeof r!=="undefined"?r:{};q.exportSymbol=function(y,z){var B=y.split(".");var A=q;for(var x=0;x<B.length-1;x++){A=A[B[x]]}A[B[B.length-1]]=z};q.exportProperty=function(y,z,x){y[z]=x};q.version="2.1.0";q.exportSymbol("version",q.version);q.utils=new (function(){var J=/^(\s|\u00A0)+|(\s|\u00A0)+$/g;var G={},I={};var F=/Firefox\/2/i.test(i.userAgent)?"KeyboardEvent":"UIEvents";G[F]=["keyup","keydown","keypress"];G.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"];for(var y in G){var H=G[y];if(H.length){for(var z=0,E=H.length;z<E;z++){I[H[z]]=y}}}var x={propertychange:true};var A=(function(){var M=3,K=h.createElement("div"),L=K.getElementsByTagName("i");while(K.innerHTML="<!--[if gt IE "+(++M)+"]><i></i><![endif]-->",L[0]){}return M>4?M:j}());var C=A===6,D=A===7;function B(K,L){if((q.utils.tagNameLower(K)!=="input")||!K.type){return false}if(L.toLowerCase()!="click"){return false}var M=K.type;return(M=="checkbox")||(M=="radio")}return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(L,K){for(var M=0,N=L.length;M<N;M++){K(L[M])}},arrayIndexOf:function(K,M){if(typeof Array.prototype.indexOf=="function"){return Array.prototype.indexOf.call(K,M)}for(var L=0,N=K.length;L<N;L++){if(K[L]===M){return L}}return -1},arrayFirst:function(K,N,O){for(var L=0,M=K.length;L<M;L++){if(N.call(O,K[L])){return K[L]}}return null},arrayRemoveItem:function(K,M){var L=q.utils.arrayIndexOf(K,M);if(L>=0){K.splice(L,1)}},arrayGetDistinctValues:function(K){K=K||[];var N=[];for(var L=0,M=K.length;L<M;L++){if(q.utils.arrayIndexOf(N,K[L])<0){N.push(K[L])}}return N},arrayMap:function(K,N){K=K||[];var O=[];for(var L=0,M=K.length;L<M;L++){O.push(N(K[L]))}return O},arrayFilter:function(K,N){K=K||[];var O=[];for(var L=0,M=K.length;L<M;L++){if(N(K[L])){O.push(K[L])}}return O},arrayPushAll:function(K,N){if(N instanceof Array){K.push.apply(K,N)}else{for(var L=0,M=N.length;L<M;L++){K.push(N[L])}}return K},extend:function(M,L){if(L){for(var K in L){if(L.hasOwnProperty(K)){M[K]=L[K]}}}return M},emptyDomNode:function(K){while(K.firstChild){q.removeNode(K.firstChild)}},moveCleanedNodesToContainerElement:function(N){var O=q.utils.makeArray(N);var K=h.createElement("div");for(var L=0,M=O.length;L<M;L++){q.cleanNode(O[L]);K.appendChild(O[L])}return K},setDomNodeChildren:function(L,K){q.utils.emptyDomNode(L);if(K){for(var M=0,N=K.length;M<N;M++){L.appendChild(K[M])}}},replaceDomNodes:function(P,N){var O=P.nodeType?[P]:P;if(O.length>0){var L=O[0];var Q=L.parentNode;for(var K=0,M=N.length;K<M;K++){Q.insertBefore(N[K],L)}for(var K=0,M=O.length;K<M;K++){q.removeNode(O[K])}}},setOptionNodeSelectionState:function(L,K){if(i.userAgent.indexOf("MSIE 6")>=0){L.setAttribute("selected",K)}else{L.selected=K}},stringTrim:function(K){return(K||"").replace(J,"")},stringTokenize:function(O,K){var N=[];var P=(O||"").split(K);for(var L=0,M=P.length;L<M;L++){var Q=q.utils.stringTrim(P[L]);if(Q!==""){N.push(Q)}}return N},stringStartsWith:function(L,K){L=L||"";if(K.length>L.length){return false}return L.substring(0,K.length)===K},buildEvalWithinScopeFunction:function(K,N){var L="return ("+K+")";for(var M=0;M<N;M++){L="with(sc["+M+"]) { "+L+" } "}return new Function("sc",L)},domNodeIsContainedBy:function(L,K){if(K.compareDocumentPosition){return(K.compareDocumentPosition(L)&16)==16}while(L!=null){if(L==K){return true}L=L.parentNode}return false},domNodeIsAttachedToDocument:function(K){return q.utils.domNodeIsContainedBy(K,K.ownerDocument)},tagNameLower:function(K){return K&&K.tagName&&K.tagName.toLowerCase()},registerEventHandler:function(K,L,M){var N=A&&x[L];if(!N&&typeof jQuery!="undefined"){if(B(K,L)){var O=M;M=function(P,Q){var R=this.checked;if(Q){this.checked=Q.checkedStateBeforeEvent!==true}O.call(this,P);this.checked=R}}jQuery(K)["bind"](L,M)}else{if(!N&&typeof K.addEventListener=="function"){K.addEventListener(L,M,false)}else{if(typeof K.attachEvent!="undefined"){K.attachEvent("on"+L,function(P){M.call(K,P)})}else{throw new Error("Browser doesn't support addEventListener or attachEvent")}}}},triggerEvent:function(K,O){if(!(K&&K.nodeType)){throw new Error("element must be a DOM node when calling triggerEvent")}if(typeof jQuery!="undefined"){var N=[];if(B(K,O)){N.push({checkedStateBeforeEvent:K.checked})}jQuery(K)["trigger"](O,N)}else{if(typeof h.createEvent=="function"){if(typeof K.dispatchEvent=="function"){var M=I[O]||"HTMLEvents";var L=h.createEvent(M);L.initEvent(O,true,true,k,0,0,0,0,0,false,false,false,false,0,K);K.dispatchEvent(L)}else{throw new Error("The supplied element doesn't support dispatchEvent")}}else{if(typeof K.fireEvent!="undefined"){if(B(K,O)){K.checked=K.checked!==true}K.fireEvent("on"+O)}else{throw new Error("Browser doesn't support triggering events")}}}},unwrapObservable:function(K){return q.isObservable(K)?K():K},toggleDomNodeCssClass:function(P,K,Q){var L=(P.className||"").split(/\s+/);var M=q.utils.arrayIndexOf(L,K)>=0;if(Q&&!M){P.className+=(L[0]?" ":"")+K}else{if(M&&!Q){var O="";for(var N=0;N<L.length;N++){if(L[N]!=K){O+=L[N]+" "}}P.className=q.utils.stringTrim(O)}}},setTextContent:function(K,L){var M=q.utils.unwrapObservable(L);if((M===null)||(M===j)){M=""}"innerText" in K?K.innerText=M:K.textContent=M;if(A>=9){K.style.display=K.style.display}},ensureSelectElementIsRenderedCorrectly:function(L){if(A>=9){var K=L.style.width;L.style.width=0;L.style.width=K}},range:function(M,L){M=q.utils.unwrapObservable(M);L=q.utils.unwrapObservable(L);var N=[];for(var K=M;K<=L;K++){N.push(K)}return N},makeArray:function(K){var N=[];for(var L=0,M=K.length;L<M;L++){N.push(K[L])}return N},isIe6:C,isIe7:D,ieVersion:A,getFormFields:function(M,K){var L=q.utils.makeArray(M.getElementsByTagName("input")).concat(q.utils.makeArray(M.getElementsByTagName("textarea")));var O=(typeof K=="string")?function(Q){return Q.name===K}:function(Q){return K.test(Q.name)};var P=[];for(var N=L.length-1;N>=0;N--){if(O(L[N])){P.push(L[N])}}return P},parseJson:function(K){if(typeof K=="string"){K=q.utils.stringTrim(K);if(K){if(k.JSON&&k.JSON.parse){return k.JSON.parse(K)}return(new Function("return "+K))()}}return null},stringifyJson:function(K,L,M){if((typeof JSON=="undefined")||(typeof JSON.stringify=="undefined")){throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js")}return JSON.stringify(q.utils.unwrapObservable(K),L,M)},postJson:function(W,K,S){S=S||{};var U=S.params||{};var O=S.includeFields||this.fieldsIncludedWithJsonPost;var V=W;if((typeof W=="object")&&(q.utils.tagNameLower(W)==="form")){var T=W;V=T.action;for(var N=O.length-1;N>=0;N--){var L=q.utils.getFormFields(T,O[N]);for(var Q=L.length-1;Q>=0;Q--){U[L[Q].name]=L[Q].value}}}K=q.utils.unwrapObservable(K);var M=h.createElement("form");M.style.display="none";M.action=V;M.method="post";for(var R in K){var P=h.createElement("input");P.name=R;P.value=q.utils.stringifyJson(q.utils.unwrapObservable(K[R]));M.appendChild(P)}for(var R in U){var P=h.createElement("input");P.name=R;P.value=U[R];M.appendChild(P)}h.body.appendChild(M);S.submitter?S.submitter(M):M.submit();setTimeout(function(){M.parentNode.removeChild(M)},0)}}})();q.exportSymbol("utils",q.utils);q.exportSymbol("utils.arrayForEach",q.utils.arrayForEach);q.exportSymbol("utils.arrayFirst",q.utils.arrayFirst);q.exportSymbol("utils.arrayFilter",q.utils.arrayFilter);q.exportSymbol("utils.arrayGetDistinctValues",q.utils.arrayGetDistinctValues);q.exportSymbol("utils.arrayIndexOf",q.utils.arrayIndexOf);q.exportSymbol("utils.arrayMap",q.utils.arrayMap);q.exportSymbol("utils.arrayPushAll",q.utils.arrayPushAll);q.exportSymbol("utils.arrayRemoveItem",q.utils.arrayRemoveItem);q.exportSymbol("utils.extend",q.utils.extend);q.exportSymbol("utils.fieldsIncludedWithJsonPost",q.utils.fieldsIncludedWithJsonPost);q.exportSymbol("utils.getFormFields",q.utils.getFormFields);q.exportSymbol("utils.postJson",q.utils.postJson);q.exportSymbol("utils.parseJson",q.utils.parseJson);q.exportSymbol("utils.registerEventHandler",q.utils.registerEventHandler);q.exportSymbol("utils.stringifyJson",q.utils.stringifyJson);q.exportSymbol("utils.range",q.utils.range);q.exportSymbol("utils.toggleDomNodeCssClass",q.utils.toggleDomNodeCssClass);q.exportSymbol("utils.triggerEvent",q.utils.triggerEvent);q.exportSymbol("utils.unwrapObservable",q.utils.unwrapObservable);if(!Function.prototype.bind){Function.prototype.bind=function(y){var z=this,x=Array.prototype.slice.call(arguments),y=x.shift();return function(){return z.apply(y,x.concat(Array.prototype.slice.call(arguments)))}}}q.utils.domData=new (function(){var z=0;var y="__ko__"+(new Date).getTime();var x={};return{get:function(C,B){var A=q.utils.domData.getAll(C,false);return A===j?j:A[B]},set:function(C,B,D){if(D===j){if(q.utils.domData.getAll(C,false)===j){return}}var A=q.utils.domData.getAll(C,true);A[B]=D},getAll:function(D,A){var B=D[y];var C=B&&(B!=="null");if(!C){if(!A){return j}B=D[y]="ko"+z++;x[B]={}}return x[B]},clear:function(B){var A=B[y];if(A){delete x[A];B[y]=null}}}})();q.exportSymbol("utils.domData",q.utils.domData);q.exportSymbol("utils.domData.clear",q.utils.domData.clear);q.utils.domNodeDisposal=new (function(){var C="__ko_domNodeDisposal__"+(new Date).getTime();var x={1:true,8:true,9:true};var y={1:true,9:true};function D(G,F){var E=q.utils.domData.get(G,C);if((E===j)&&F){E=[];q.utils.domData.set(G,C,E)}return E}function B(E){q.utils.domData.set(E,C,j)}function A(G){var E=D(G,false);if(E){E=E.slice(0);for(var F=0;F<E.length;F++){E[F](G)}}q.utils.domData.clear(G);if((typeof jQuery=="function")&&(typeof jQuery.cleanData=="function")){jQuery.cleanData([G])}if(y[G.nodeType]){z(G)}}function z(G){var E,F=G.firstChild;while(E=F){F=E.nextSibling;if(E.nodeType===8){A(E)}}}return{addDisposeCallback:function(F,E){if(typeof E!="function"){throw new Error("Callback must be a function")}D(F,true).push(E)},removeDisposeCallback:function(G,E){var F=D(G,false);if(F){q.utils.arrayRemoveItem(F,E);if(F.length==0){B(G)}}},cleanNode:function(H){if(x[H.nodeType]){A(H);if(y[H.nodeType]){var E=[];q.utils.arrayPushAll(E,H.getElementsByTagName("*"));for(var F=0,G=E.length;F<G;F++){A(E[F])}}}},removeNode:function(E){q.cleanNode(E);if(E.parentNode){E.parentNode.removeChild(E)}}}})();q.cleanNode=q.utils.domNodeDisposal.cleanNode;q.removeNode=q.utils.domNodeDisposal.removeNode;q.exportSymbol("cleanNode",q.cleanNode);q.exportSymbol("removeNode",q.removeNode);q.exportSymbol("utils.domNodeDisposal",q.utils.domNodeDisposal);q.exportSymbol("utils.domNodeDisposal.addDisposeCallback",q.utils.domNodeDisposal.addDisposeCallback);q.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",q.utils.domNodeDisposal.removeDisposeCallback);(function(){var y=/^(\s*)<!--(.*?)-->/;function z(B){var D=q.utils.stringTrim(B).toLowerCase(),A=h.createElement("div");var E=D.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!D.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!D.indexOf("<td")||!D.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""];var C="ignored<div>"+E[1]+B+E[2]+"</div>";if(typeof k.innerShiv=="function"){A.appendChild(k.innerShiv(C))}else{A.innerHTML=C}while(E[0]--){A=A.lastChild}return q.utils.makeArray(A.lastChild.childNodes)}function x(C){var B=jQuery.clean([C]);if(B&&B[0]){var A=B[0];while(A.parentNode&&A.parentNode.nodeType!==11){A=A.parentNode}if(A.parentNode){A.parentNode.removeChild(A)}}return B}q.utils.parseHtmlFragment=function(A){return typeof jQuery!="undefined"?x(A):z(A)};q.utils.setHtml=function(C,A){q.utils.emptyDomNode(C);if((A!==null)&&(A!==j)){if(typeof A!="string"){A=A.toString()}if(typeof jQuery!="undefined"){jQuery(C)["html"](A)}else{var D=q.utils.parseHtmlFragment(A);for(var B=0;B<D.length;B++){C.appendChild(D[B])}}}}})();q.exportSymbol("utils.parseHtmlFragment",q.utils.parseHtmlFragment);q.exportSymbol("utils.setHtml",q.utils.setHtml);q.memoization=(function(){var z={};function A(){return(((1+Math.random())*4294967296)|0).toString(16).substring(1)}function y(){return A()+A()}function x(G,B){if(!G){return}if(G.nodeType==8){var F=q.memoization.parseMemoText(G.nodeValue);if(F!=null){B.push({domNode:G,memoId:F})}}else{if(G.nodeType==1){for(var D=0,C=G.childNodes,E=C.length;D<E;D++){x(C[D],B)}}}}return{memoize:function(B){if(typeof B!="function"){throw new Error("You can only pass a function to ko.memoization.memoize()")}var C=y();z[C]=B;return"<!--[ko_memo:"+C+"]-->"},unmemoize:function(D,C){var B=z[D];if(B===j){throw new Error("Couldn't find any memo with ID "+D+". Perhaps it's already been unmemoized.")}try{B.apply(null,C||[]);return true}finally{delete z[D]}},unmemoizeDomNodeAndDescendants:function(C,D){var G=[];x(C,G);for(var E=0,F=G.length;E<F;E++){var H=G[E].domNode;var B=[H];if(D){q.utils.arrayPushAll(B,D)}q.memoization.unmemoize(G[E].memoId,B);H.nodeValue="";if(H.parentNode){H.parentNode.removeChild(H)}}},parseMemoText:function(C){var B=C.match(/^\[ko_memo\:(.*?)\]$/);return B?B[1]:null}}})();q.exportSymbol("memoization",q.memoization);q.exportSymbol("memoization.memoize",q.memoization.memoize);q.exportSymbol("memoization.unmemoize",q.memoization.unmemoize);q.exportSymbol("memoization.parseMemoText",q.memoization.parseMemoText);q.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",q.memoization.unmemoizeDomNodeAndDescendants);q.extenders={throttle:function(x,y){x.throttleEvaluation=y;var z=null;return q.dependentObservable({read:x,write:function(A){clearTimeout(z);z=setTimeout(function(){x(A)},y)}})},notify:function(y,x){y.equalityComparer=x=="always"?function(){return false}:q.observable.fn["equalityComparer"];return y}};function l(z){var A=this;if(z){for(var y in z){var x=q.extenders[y];if(typeof x=="function"){A=x(A,z[y])}}}return A}q.exportSymbol("extenders",q.extenders);q.subscription=function(z,x,y){this.target=z;this.callback=x;this.disposeCallback=y;q.exportProperty(this,"dispose",this.dispose)};q.subscription.prototype.dispose=function(){this.isDisposed=true;this.disposeCallback()};q.subscribable=function(){this._subscriptions={};q.utils.extend(this,q.subscribable.fn);q.exportProperty(this,"subscribe",this.subscribe);q.exportProperty(this,"extend",this.extend);q.exportProperty(this,"getSubscriptionsCount",this.getSubscriptionsCount)};var n="change";q.subscribable.fn={subscribe:function(y,z,A){A=A||n;var x=z?y.bind(z):y;var B=new q.subscription(this,x,function(){q.utils.arrayRemoveItem(this._subscriptions[A],B)}.bind(this));if(!this._subscriptions[A]){this._subscriptions[A]=[]}this._subscriptions[A].push(B);return B},notifySubscribers:function(y,x){x=x||n;if(this._subscriptions[x]){q.utils.arrayForEach(this._subscriptions[x].slice(0),function(z){if(z&&(z.isDisposed!==true)){z.callback(y)}})}},getSubscriptionsCount:function(){var y=0;for(var x in this._subscriptions){if(this._subscriptions.hasOwnProperty(x)){y+=this._subscriptions[x].length}}return y},extend:l};q.isSubscribable=function(x){return typeof x.subscribe=="function"&&typeof x.notifySubscribers=="function"};q.exportSymbol("subscribable",q.subscribable);q.exportSymbol("isSubscribable",q.isSubscribable);q.dependencyDetection=(function(){var x=[];return{begin:function(y){x.push({callback:y,distinctDependencies:[]})},end:function(){x.pop()},registerDependency:function(y){if(!q.isSubscribable(y)){throw new Error("Only subscribable things can act as dependencies")}if(x.length>0){var z=x[x.length-1];if(q.utils.arrayIndexOf(z.distinctDependencies,y)>=0){return}z.distinctDependencies.push(y);z.callback(y)}}}})();var t={"undefined":true,"boolean":true,number:true,string:true};q.observable=function(y){var x=y;function z(){if(arguments.length>0){if((!z.equalityComparer)||!z.equalityComparer(x,arguments[0])){z.valueWillMutate();x=arguments[0];if(g){z._latestValue=x}z.valueHasMutated()}return this}else{q.dependencyDetection.registerDependency(z);return x}}if(g){z._latestValue=x}q.subscribable.call(z);z.valueHasMutated=function(){z.notifySubscribers(x)};z.valueWillMutate=function(){z.notifySubscribers(x,"beforeChange")};q.utils.extend(z,q.observable.fn);q.exportProperty(z,"valueHasMutated",z.valueHasMutated);q.exportProperty(z,"valueWillMutate",z.valueWillMutate);return z};q.observable.fn={equalityComparer:function w(x,y){var z=(x===null)||(typeof(x) in t);return z?(x===y):false}};var v=q.observable.protoProperty="__ko_proto__";q.observable.fn[v]=q.observable;q.hasPrototype=function(x,y){if((x===null)||(x===j)||(x[v]===j)){return false}if(x[v]===y){return true}return q.hasPrototype(x[v],y)};q.isObservable=function(x){return q.hasPrototype(x,q.observable)};q.isWriteableObservable=function(x){if((typeof x=="function")&&x[v]===q.observable){return true}if((typeof x=="function")&&(x[v]===q.dependentObservable)&&(x.hasWriteFunction)){return true}return false};q.exportSymbol("observable",q.observable);q.exportSymbol("isObservable",q.isObservable);q.exportSymbol("isWriteableObservable",q.isWriteableObservable);q.observableArray=function(x){if(arguments.length==0){x=[]}if((x!==null)&&(x!==j)&&!("length" in x)){throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.")}var y=q.observable(x);q.utils.extend(y,q.observableArray.fn);return y};q.observableArray.fn={remove:function(C){var A=this();var z=[];var y=typeof C=="function"?C:function(D){return D===C};for(var x=0;x<A.length;x++){var B=A[x];if(y(B)){if(z.length===0){this.valueWillMutate()}z.push(B);A.splice(x,1);x--}}if(z.length){this.valueHasMutated()}return z},removeAll:function(y){if(y===j){var z=this();var x=z.slice(0);this.valueWillMutate();z.splice(0,z.length);this.valueHasMutated();return x}if(!y){return[]}return this["remove"](function(A){return q.utils.arrayIndexOf(y,A)>=0})},destroy:function(B){var z=this();var y=typeof B=="function"?B:function(C){return C===B};this.valueWillMutate();for(var x=z.length-1;x>=0;x--){var A=z[x];if(y(A)){z[x]["_destroy"]=true}}this.valueHasMutated()},destroyAll:function(x){if(x===j){return this["destroy"](function(){return true})}if(!x){return[]}return this["destroy"](function(y){return q.utils.arrayIndexOf(x,y)>=0})},indexOf:function(x){var y=this();return q.utils.arrayIndexOf(y,x)},replace:function(z,y){var x=this["indexOf"](z);if(x>=0){this.valueWillMutate();this()[x]=y;this.valueHasMutated()}}};q.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(x){q.observableArray.fn[x]=function(){var z=this();this.valueWillMutate();var y=z[x].apply(z,arguments);this.valueHasMutated();return y}});q.utils.arrayForEach(["slice"],function(x){q.observableArray.fn[x]=function(){var y=this();return y[x].apply(y,arguments)}});q.exportSymbol("observableArray",q.observableArray);q.dependentObservable=function(J,K,N){var z,x=false,y=false,O=J;if(O&&typeof O=="object"){N=O;O=N.read}else{N=N||{};if(!O){O=N.read}}if(typeof O!="function"){throw new Error("Pass a function that returns the value of the ko.computed")}var Q=N.write;if(!K){K=N.owner}var A=[];function D(){q.utils.arrayForEach(A,function(R){R.dispose()});A=[]}var C=D;var F=(typeof N.disposeWhenNodeIsRemoved=="object")?N.disposeWhenNodeIsRemoved:null;var E=N.disposeWhen||function(){return false};if(F){C=function(){q.utils.domNodeDisposal.removeDisposeCallback(F,arguments.callee);D()};q.utils.domNodeDisposal.addDisposeCallback(F,C);var L=E;E=function(){return !q.utils.domNodeIsAttachedToDocument(F)||L()}}var I=null;function H(){var R=B.throttleEvaluation;if(R&&R>=0){clearTimeout(I);I=setTimeout(G,R)}else{G()}}function G(){if(y){return}if(x&&E()){C();return}y=true;try{var R=q.utils.arrayMap(A,function(U){return U.target});q.dependencyDetection.begin(function(V){var U;if((U=q.utils.arrayIndexOf(R,V))>=0){R[U]=j}else{A.push(V.subscribe(H))}});var T=O.call(K);for(var S=R.length-1;S>=0;S--){if(R[S]){A.splice(S,1)[0].dispose()}}x=true;B.notifySubscribers(z,"beforeChange");z=T;if(g){B._latestValue=z}}finally{q.dependencyDetection.end()}B.notifySubscribers(z);y=false}function B(){if(arguments.length>0){P.apply(B,arguments)}else{return M()}}function P(){if(typeof Q==="function"){Q.apply(K,arguments)}else{throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.")}}function M(){if(!x){G()}q.dependencyDetection.registerDependency(B);return z}B.getDependenciesCount=function(){return A.length};B.hasWriteFunction=typeof N.write==="function";B.dispose=function(){C()};q.subscribable.call(B);q.utils.extend(B,q.dependentObservable.fn);if(N.deferEvaluation!==true){G()}q.exportProperty(B,"dispose",B.dispose);q.exportProperty(B,"getDependenciesCount",B.getDependenciesCount);return B};q.isComputed=function(x){return q.hasPrototype(x,q.dependentObservable)};var u=q.observable.protoProperty;q.dependentObservable[u]=q.observable;q.dependentObservable.fn={};q.dependentObservable.fn[u]=q.dependentObservable;q.exportSymbol("dependentObservable",q.dependentObservable);q.exportSymbol("computed",q.dependentObservable);q.exportSymbol("isComputed",q.isComputed);(function(){var y=10;q.toJS=function(B){if(arguments.length==0){throw new Error("When calling ko.toJS, pass the object you want to convert.")}return x(B,function(D){for(var C=0;q.isObservable(D)&&(C<y);C++){D=D()}return D})};q.toJSON=function(D,C,E){var B=q.toJS(D);return q.utils.stringifyJson(B,C,E)};function x(E,C,F){F=F||new z();E=C(E);var B=(typeof E=="object")&&(E!==null)&&(E!==j)&&(!(E instanceof Date));if(!B){return E}var D=E instanceof Array?[]:{};F.save(E,D);A(E,function(G){var I=C(E[G]);switch(typeof I){case"boolean":case"number":case"string":case"function":D[G]=I;break;case"object":case"undefined":var H=F.get(I);D[G]=(H!==j)?H:x(I,C,F);break}});return D}function A(D,E){if(D instanceof Array){for(var B=0;B<D.length;B++){E(B)}if(typeof D.toJSON=="function"){E("toJSON")}}else{for(var C in D){E(C)}}}function z(){var B=[];var C=[];this.save=function(E,F){var D=q.utils.arrayIndexOf(B,E);if(D>=0){C[D]=F}else{B.push(E);C.push(F)}};this.get=function(E){var D=q.utils.arrayIndexOf(B,E);return(D>=0)?C[D]:j}}})();q.exportSymbol("toJS",q.toJS);q.exportSymbol("toJSON",q.toJSON);(function(){var x="__ko__hasDomDataOptionValue__";q.selectExtensions={readValue:function(y){switch(q.utils.tagNameLower(y)){case"option":if(y[x]===true){return q.utils.domData.get(y,q.bindingHandlers.options.optionValueDomDataKey)}return y.getAttribute("value");case"select":return y.selectedIndex>=0?q.selectExtensions.readValue(y.options[y.selectedIndex]):j;default:return y.value}},writeValue:function(y,A){switch(q.utils.tagNameLower(y)){case"option":switch(typeof A){case"string":q.utils.domData.set(y,q.bindingHandlers.options.optionValueDomDataKey,j);if(x in y){delete y[x]}y.value=A;break;default:q.utils.domData.set(y,q.bindingHandlers.options.optionValueDomDataKey,A);y[x]=true;y.value=typeof A==="number"?A:"";break}break;case"select":for(var z=y.options.length-1;z>=0;z--){if(q.selectExtensions.readValue(y.options[z])==A){y.selectedIndex=z;break}}break;default:if((A===null)||(A===j)){A=""}y.value=A;break}}}})();q.exportSymbol("selectExtensions",q.selectExtensions);q.exportSymbol("selectExtensions.readValue",q.selectExtensions.readValue);q.exportSymbol("selectExtensions.writeValue",q.selectExtensions.writeValue);q.jsonExpressionRewriting=(function(){var B=/\@ko_token_(\d+)\@/g;var z=/^[\_$a-z][\_$a-z0-9]*(\[.*?\])*(\.[\_$a-z][\_$a-z0-9]*(\[.*?\])*)*$/i;var A=["true","false"];function C(E,F){var D=null;while(E!=D){D=E;E=E.replace(B,function(G,H){return F[H]})}return E}function y(D){if(q.utils.arrayIndexOf(A,q.utils.stringTrim(D).toLowerCase())>=0){return false}return D.match(z)!==null}function x(D){var E=q.utils.stringTrim(D);switch(E.length&&E.charAt(0)){case"'":case'"':return D;default:return"'"+E+"'"}}return{bindingRewriteValidators:[],parseObjectLiteral:function(J){var O=q.utils.stringTrim(J);if(O.length<3){return[]}if(O.charAt(0)==="{"){O=O.substring(1,O.length-1)}var S=[];var T=null,R;for(var L=0;L<O.length;L++){var D=O.charAt(L);if(T===null){switch(D){case'"':case"'":case"/":T=L;R=D;break}}else{if((D==R)&&(O.charAt(L-1)!=="\\")){var P=O.substring(T,L+1);S.push(P);var M="@ko_token_"+(S.length-1)+"@";O=O.substring(0,T)+M+O.substring(L+1);L-=(P.length-M.length);T=null}}}T=null;R=null;var Q=0,U=null;for(var L=0;L<O.length;L++){var D=O.charAt(L);if(T===null){switch(D){case"{":T=L;U=D;R="}";break;case"(":T=L;U=D;R=")";break;case"[":T=L;U=D;R="]";break}}if(D===U){Q++}else{if(D===R){Q--;if(Q===0){var P=O.substring(T,L+1);S.push(P);var M="@ko_token_"+(S.length-1)+"@";O=O.substring(0,T)+M+O.substring(L+1);L-=(P.length-M.length);T=null}}}}var N=[];var I=O.split(",");for(var F=0,G=I.length;F<G;F++){var K=I[F];var E=K.indexOf(":");if((E>0)&&(E<K.length-1)){var H=K.substring(0,E);var V=K.substring(E+1);N.push({key:C(H,S),value:C(V,S)})}else{N.push({unknown:C(K,S)})}}return N},insertPropertyAccessorsIntoJson:function(I){var G=typeof I==="string"?q.jsonExpressionRewriting.parseObjectLiteral(I):I;var L=[],J=[];var H;for(var F=0;H=G[F];F++){if(L.length>0){L.push(",")}if(H.key){var K=x(H.key),M=H.value;L.push(K);L.push(":");L.push(M);if(y(q.utils.stringTrim(M))){if(J.length>0){J.push(", ")}J.push(K+" : function(__ko_value) { "+M+" = __ko_value; }")}}else{if(H.unknown){L.push(H.unknown)}}}var E=L.join("");if(J.length>0){var D=J.join("");E=E+", '_ko_property_writers' : { "+D+" } "}return E},keyValueArrayContainsKey:function(F,E){for(var D=0;D<F.length;D++){if(q.utils.stringTrim(F[D]["key"])==E){return true}}return false},writeValueToProperty:function(G,D,F,I,E){if(!G||!q.isWriteableObservable(G)){var H=D()["_ko_property_writers"];if(H&&H[F]){H[F](I)}}else{if(!E||G()!==I){G(I)}}}}})();q.exportSymbol("jsonExpressionRewriting",q.jsonExpressionRewriting);q.exportSymbol("jsonExpressionRewriting.bindingRewriteValidators",q.jsonExpressionRewriting.bindingRewriteValidators);q.exportSymbol("jsonExpressionRewriting.parseObjectLiteral",q.jsonExpressionRewriting.parseObjectLiteral);q.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",q.jsonExpressionRewriting.insertPropertyAccessorsIntoJson);(function(){var x=h.createComment("test").text==="<!--test-->";var F=x?/^<!--\s*ko\s+(.*\:.*)\s*-->$/:/^\s*ko\s+(.*\:.*)\s*$/;var y=x?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/;var C={ul:true,ol:true};function E(G){return(G.nodeType==8)&&(x?G.text:G.nodeValue).match(F)}function D(G){return(G.nodeType==8)&&(x?G.text:G.nodeValue).match(y)}function B(K,G){var I=K;var J=1;var H=[];while(I=I.nextSibling){if(D(I)){J--;if(J===0){return H}}H.push(I);if(E(I)){J++}}if(!G){throw new Error("Cannot find closing comment tag to match: "+K.nodeValue)}return null}function z(I,G){var H=B(I,G);if(H){if(H.length>0){return H[H.length-1].nextSibling}return I.nextSibling}else{return null}}function A(J){var H=J.firstChild,G=null;if(H){do{if(G){G.push(H)}else{if(E(H)){var I=z(H,true);if(I){H=I}else{G=[H]}}else{if(D(H)){G=[H]}}}}while(H=H.nextSibling)}return G}q.virtualElements={allowedBindings:{},childNodes:function(G){return E(G)?B(G):G.childNodes},emptyNode:function(I){if(!E(I)){q.utils.emptyDomNode(I)}else{var J=q.virtualElements.childNodes(I);for(var G=0,H=J.length;G<H;G++){q.removeNode(J[G])}}},setDomNodeChildren:function(K,G){if(!E(K)){q.utils.setDomNodeChildren(K,G)}else{q.virtualElements.emptyNode(K);var H=K.nextSibling;for(var I=0,J=G.length;I<J;I++){H.parentNode.insertBefore(G[I],H)}}},prepend:function(G,H){if(!E(G)){if(G.firstChild){G.insertBefore(H,G.firstChild)}else{G.appendChild(H)}}else{G.parentNode.insertBefore(H,G.nextSibling)}},insertAfter:function(G,I,H){if(!E(G)){if(H.nextSibling){G.insertBefore(I,H.nextSibling)}else{G.appendChild(I)}}else{G.parentNode.insertBefore(I,H.nextSibling)}},firstChild:function(G){if(!E(G)){return G.firstChild}if(!G.nextSibling||D(G.nextSibling)){return null}return G.nextSibling},nextSibling:function(G){if(E(G)){G=z(G)}if(G.nextSibling&&D(G.nextSibling)){return null}return G.nextSibling},virtualNodeBindingValue:function(G){var H=E(G);return H?H[1]:null},normaliseVirtualElementDomStructure:function(H){if(!C[q.utils.tagNameLower(H)]){return}var G=H.firstChild;if(G){do{if(G.nodeType===1){var K=A(G);if(K){var J=G.nextSibling;for(var I=0;I<K.length;I++){if(J){H.insertBefore(K[I],J)}else{H.appendChild(K[I])}}}}}while(G=G.nextSibling)}}}})();q.exportSymbol("virtualElements",q.virtualElements);q.exportSymbol("virtualElements.allowedBindings",q.virtualElements.allowedBindings);q.exportSymbol("virtualElements.emptyNode",q.virtualElements.emptyNode);q.exportSymbol("virtualElements.insertAfter",q.virtualElements.insertAfter);q.exportSymbol("virtualElements.prepend",q.virtualElements.prepend);q.exportSymbol("virtualElements.setDomNodeChildren",q.virtualElements.setDomNodeChildren);(function(){var z="data-bind";q.bindingProvider=function(){this.bindingCache={}};q.utils.extend(q.bindingProvider.prototype,{nodeHasBindings:function(A){switch(A.nodeType){case 1:return A.getAttribute(z)!=null;case 8:return q.virtualElements.virtualNodeBindingValue(A)!=null;default:return false}},getBindings:function(C,A){var B=this["getBindingsString"](C,A);return B?this["parseBindingsString"](B,A):null},getBindingsString:function(B,A){switch(B.nodeType){case 1:return B.getAttribute(z);case 8:return q.virtualElements.virtualNodeBindingValue(B);default:return null}},parseBindingsString:function(C,A){try{var F=A["$data"],E=(typeof F=="object"&&F!=null)?[F,A]:[A],B=y(C,E.length,this.bindingCache);return B(E)}catch(D){throw new Error("Unable to parse bindings.\nMessage: "+D+";\nBindings value: "+C)}}});q.bindingProvider.instance=new q.bindingProvider();function y(A,D,B){var C=D+"_"+A;return B[C]||(B[C]=x(A,D))}function x(A,C){var B=" { "+q.jsonExpressionRewriting.insertPropertyAccessorsIntoJson(A)+" } ";return q.utils.buildEvalWithinScopeFunction(B,C)}})();q.exportSymbol("bindingProvider",q.bindingProvider);(function(){q.bindingHandlers={};q.bindingContext=function(C,D){if(D){q.utils.extend(this,D);this["$parentContext"]=D;this["$parent"]=D["$data"];this["$parents"]=(D["$parents"]||[]).slice(0);this["$parents"].unshift(this["$parent"])}else{this["$parents"]=[];this["$root"]=C}this["$data"]=C};q.bindingContext.prototype.createChildContext=function(C){return new q.bindingContext(C,this)};q.bindingContext.prototype.extend=function(D){var C=q.utils.extend(new q.bindingContext(),this);return q.utils.extend(C,D)};function B(C){var D=q.virtualElements.allowedBindings[C];if(!D){throw new Error("The binding '"+C+"' cannot be used with virtual elements")}}function x(G,E,C){var D,F=q.virtualElements.firstChild(E);while(D=F){F=q.virtualElements.nextSibling(D);y(G,D,C)}}function y(H,E,C){var G=true;var D=(E.nodeType===1);if(D){q.virtualElements.normaliseVirtualElementDomStructure(E)}var F=(D&&C)||q.bindingProvider.instance["nodeHasBindings"](E);if(F){G=z(E,null,H,C).shouldBindDescendants}if(G){x(H,E,!D)}}function z(H,E,K,C){var F=0;var I;function G(L){return function(){return I[L]}}function J(){return I}var D;q.dependentObservable(function(){var M=K&&(K instanceof q.bindingContext)?K:new q.bindingContext(q.utils.unwrapObservable(K));var S=M["$data"];if(C){q.storedBindingContextForNode(H,M)}var O=(typeof E=="function")?E():E;I=O||q.bindingProvider.instance["getBindings"](H,M);if(I){if(F===0){F=1;for(var N in I){var L=q.bindingHandlers[N];if(L&&H.nodeType===8){B(N)}if(L&&typeof L.init=="function"){var P=L.init;var R=P(H,G(N),J,S,M);if(R&&R.controlsDescendantBindings){if(D!==j){throw new Error("Multiple bindings ("+D+" and "+N+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.")}D=N}}}F=2}if(F===2){for(var N in I){var L=q.bindingHandlers[N];if(L&&typeof L.update=="function"){var Q=L.update;Q(H,G(N),J,S,M)}}}}},null,{disposeWhenNodeIsRemoved:H});return{shouldBindDescendants:D===j}}var A="__ko_bindingContext__";q.storedBindingContextForNode=function(D,C){if(arguments.length==2){q.utils.domData.set(D,A,C)}else{return q.utils.domData.get(D,A)}};q.applyBindingsToNode=function(D,C,E){if(D.nodeType===1){q.virtualElements.normaliseVirtualElementDomStructure(D)}return z(D,C,E,true)};q.applyBindingsToDescendants=function(D,C){if(C.nodeType===1||C.nodeType===8){x(D,C,true)}};q.applyBindings=function(D,C){if(C&&(C.nodeType!==1)&&(C.nodeType!==8)){throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node")}C=C||k.document.body;y(D,C,true)};q.contextFor=function(D){switch(D.nodeType){case 1:case 8:var C=q.storedBindingContextForNode(D);if(C){return C}if(D.parentNode){return q.contextFor(D.parentNode)}break}return j};q.dataFor=function(D){var C=q.contextFor(D);return C?C["$data"]:j};q.exportSymbol("bindingHandlers",q.bindingHandlers);q.exportSymbol("applyBindings",q.applyBindings);q.exportSymbol("applyBindingsToDescendants",q.applyBindingsToDescendants);q.exportSymbol("applyBindingsToNode",q.applyBindingsToNode);q.exportSymbol("contextFor",q.contextFor);q.exportSymbol("dataFor",q.dataFor)})();var p=["click"];q.utils.arrayForEach(p,function(x){q.bindingHandlers[x]={init:function(z,B,y,C){var A=function(){var D={};D[x]=B();return D};return q.bindingHandlers.event["init"].call(this,z,A,y,C)}}});q.bindingHandlers.event={init:function(y,B,x,C){var A=B()||{};for(var z in A){(function(){var D=z;if(typeof D=="string"){q.utils.registerEventHandler(y,D,function(H){var J;var I=B()[D];if(!I){return}var E=x();try{var F=q.utils.makeArray(arguments);F.unshift(C);J=I.apply(C,F)}finally{if(J!==true){if(H.preventDefault){H.preventDefault()}else{H.returnValue=false}}}var G=E[D+"Bubble"]!==false;if(!G){H.cancelBubble=true;if(H.stopPropagation){H.stopPropagation()}}})}})()}}};q.bindingHandlers.submit={init:function(y,z,x,A){if(typeof z()!="function"){throw new Error("The value for a submit binding must be a function")}q.utils.registerEventHandler(y,"submit",function(B){var C;var D=z();try{C=D.call(A,y)}finally{if(C!==true){if(B.preventDefault){B.preventDefault()}else{B.returnValue=false}}}})}};q.bindingHandlers.visible={update:function(x,A){var z=q.utils.unwrapObservable(A());var y=!(x.style.display=="none");if(z&&!y){x.style.display=""}else{if((!z)&&y){x.style.display="none"}}}};q.bindingHandlers.enable={update:function(x,z){var y=q.utils.unwrapObservable(z());if(y&&x.disabled){x.removeAttribute("disabled")}else{if((!y)&&(!x.disabled)){x.disabled=true}}}};q.bindingHandlers.disable={update:function(x,y){q.bindingHandlers.enable["update"](x,function(){return !q.utils.unwrapObservable(y())})}};function o(x,y,z){if(z){if(y!==q.selectExtensions.readValue(x)){q.selectExtensions.writeValue(x,y)}}if(y!==q.selectExtensions.readValue(x)){q.utils.triggerEvent(x,"change")}}q.bindingHandlers.value={init:function(y,D,x){var z=["change"];var C=x()["valueUpdate"];if(C){if(typeof C=="string"){C=[C]}q.utils.arrayPushAll(z,C);z=q.utils.arrayGetDistinctValues(z)}var E=function(){var G=D();var F=q.selectExtensions.readValue(y);q.jsonExpressionRewriting.writeValueToProperty(G,x,"value",F,true)};var A=q.utils.ieVersion&&y.tagName.toLowerCase()=="input"&&y.type=="text"&&y.autocomplete!="off"&&(!y.form||y.form.autocomplete!="off");if(A&&q.utils.arrayIndexOf(z,"propertychange")==-1){var B=false;q.utils.registerEventHandler(y,"propertychange",function(){B=true});q.utils.registerEventHandler(y,"blur",function(){if(B){B=false;E()}})}q.utils.arrayForEach(z,function(F){var G=E;if(q.utils.stringStartsWith(F,"after")){G=function(){setTimeout(E,0)};F=F.substring("after".length)}q.utils.registerEventHandler(y,F,G)})},update:function(z,C){var E=q.utils.tagNameLower(z)==="select";var B=q.utils.unwrapObservable(C());var A=q.selectExtensions.readValue(z);var D=(B!=A);if((B===0)&&(A!==0)&&(A!=="0")){D=true}if(D){var y=function(){q.selectExtensions.writeValue(z,B)};y();var x=E;if(x){setTimeout(y,0)}}if(E&&(z.length>0)){o(z,B,false)}}};q.bindingHandlers.options={update:function(A,N,y){if(q.utils.tagNameLower(A)!=="select"){throw new Error("options binding applies only to SELECT elements")}var L=A.length==0;var J=q.utils.arrayMap(q.utils.arrayFilter(A.childNodes,function(O){return O.tagName&&(q.utils.tagNameLower(O)==="option")&&O.selected}),function(O){return q.selectExtensions.readValue(O)||O.innerText||O.textContent});var I=A.scrollTop;var M=q.utils.unwrapObservable(N());var K=A.value;while(A.length>0){q.cleanNode(A.options[0]);A.remove(0)}if(M){var x=y();if(typeof M.length!="number"){M=[M]}if(x.optionsCaption){var E=h.createElement("option");q.utils.setHtml(E,x.optionsCaption);q.selectExtensions.writeValue(E,j);A.appendChild(E)}for(var B=0,C=M.length;B<C;B++){var E=h.createElement("option");var H=typeof x.optionsValue=="string"?M[B][x.optionsValue]:M[B];H=q.utils.unwrapObservable(H);q.selectExtensions.writeValue(E,H);var F=x.optionsText;var G;if(typeof F=="function"){G=F(M[B])}else{if(typeof F=="string"){G=M[B][F]}else{G=H}}if((G===null)||(G===j)){G=""}q.utils.setTextContent(E,G);A.appendChild(E)}var D=A.getElementsByTagName("option");var z=0;for(var B=0,C=D.length;B<C;B++){if(q.utils.arrayIndexOf(J,q.selectExtensions.readValue(D[B]))>=0){q.utils.setOptionNodeSelectionState(D[B],true);z++}}A.scrollTop=I;if(L&&("value" in x)){o(A,q.utils.unwrapObservable(x.value),true)}q.utils.ensureSelectElementIsRenderedCorrectly(A)}}};q.bindingHandlers.options.optionValueDomDataKey="__ko.optionValueDomData__";q.bindingHandlers.selectedOptions={getSelectedValuesFromSelectNode:function(D){var B=[];var A=D.childNodes;for(var x=0,y=A.length;x<y;x++){var z=A[x],E=q.utils.tagNameLower(z);if(E=="option"&&z.selected){B.push(q.selectExtensions.readValue(z))}else{if(E=="optgroup"){var C=q.bindingHandlers.selectedOptions.getSelectedValuesFromSelectNode(z);Array.prototype.splice.apply(B,[B.length,0].concat(C))}}}return B},init:function(y,z,x){q.utils.registerEventHandler(y,"change",function(){var A=z();var B=q.bindingHandlers.selectedOptions.getSelectedValuesFromSelectNode(this);q.jsonExpressionRewriting.writeValueToProperty(A,x,"value",B)})},update:function(x,D){if(q.utils.tagNameLower(x)!="select"){throw new Error("values binding applies only to SELECT elements")}var A=q.utils.unwrapObservable(D());if(A&&typeof A.length=="number"){var C=x.childNodes;for(var y=0,z=C.length;y<z;y++){var B=C[y];if(q.utils.tagNameLower(B)==="option"){q.utils.setOptionNodeSelectionState(B,q.utils.arrayIndexOf(A,q.selectExtensions.readValue(B))>=0)}}}}};q.bindingHandlers.text={update:function(x,y){q.utils.setTextContent(x,y())}};q.bindingHandlers.html={init:function(){return{controlsDescendantBindings:true}},update:function(x,z){var y=q.utils.unwrapObservable(z());q.utils.setHtml(x,y)}};q.bindingHandlers.css={update:function(y,B){var A=q.utils.unwrapObservable(B()||{});for(var x in A){if(typeof x=="string"){var z=q.utils.unwrapObservable(A[x]);q.utils.toggleDomNodeCssClass(y,x,z)}}}};q.bindingHandlers.style={update:function(x,B){var A=q.utils.unwrapObservable(B()||{});for(var y in A){if(typeof y=="string"){var z=q.utils.unwrapObservable(A[y]);x.style[y]=z||""}}}};q.bindingHandlers.uniqueName={init:function(x,y){if(y()){x.name="ko_unique_"+(++q.bindingHandlers.uniqueName.currentIndex);if(q.utils.isIe6||q.utils.isIe7){x.mergeAttributes(h.createElement("<input name='"+x.name+"'/>"),false)}}}};q.bindingHandlers.uniqueName.currentIndex=0;q.bindingHandlers.checked={init:function(y,A,x){var z=function(){var D;if(y.type=="checkbox"){D=y.checked}else{if((y.type=="radio")&&(y.checked)){D=y.value}else{return}}var C=A();if((y.type=="checkbox")&&(q.utils.unwrapObservable(C) instanceof Array)){var B=q.utils.arrayIndexOf(q.utils.unwrapObservable(C),y.value);if(y.checked&&(B<0)){C.push(y.value)}else{if((!y.checked)&&(B>=0)){C.splice(B,1)}}}else{q.jsonExpressionRewriting.writeValueToProperty(C,x,"checked",D,true)}};q.utils.registerEventHandler(y,"click",z);if((y.type=="radio")&&!y.name){q.bindingHandlers.uniqueName["init"](y,function(){return true})}},update:function(x,z){var y=q.utils.unwrapObservable(z());if(x.type=="checkbox"){if(y instanceof Array){x.checked=q.utils.arrayIndexOf(y,x.value)>=0}else{x.checked=y}}else{if(x.type=="radio"){x.checked=(x.value==y)}}}};var m={"class":"className","for":"htmlFor"};q.bindingHandlers.attr={update:function(A,D,x){var C=q.utils.unwrapObservable(D())||{};for(var y in C){if(typeof y=="string"){var z=q.utils.unwrapObservable(C[y]);var B=(z===false)||(z===null)||(z===j);if(B){A.removeAttribute(y)}if(q.utils.ieVersion<=8&&y in m){y=m[y];if(B){A.removeAttribute(y)}else{A[y]=z}}else{if(!B){A.setAttribute(y,z.toString())}}}}}};q.bindingHandlers.hasfocus={init:function(y,z,x){var A=function(C){var B=z();q.jsonExpressionRewriting.writeValueToProperty(B,x,"hasfocus",C,true)};q.utils.registerEventHandler(y,"focus",function(){A(true)});q.utils.registerEventHandler(y,"focusin",function(){A(true)});q.utils.registerEventHandler(y,"blur",function(){A(false)});q.utils.registerEventHandler(y,"focusout",function(){A(false)})},update:function(x,z){var y=q.utils.unwrapObservable(z());y?x.focus():x.blur();q.utils.triggerEvent(x,y?"focusin":"focusout")}};q.bindingHandlers["with"]={makeTemplateValueAccessor:function(x){return function(){var y=x();return{"if":y,data:y,templateEngine:q.nativeTemplateEngine.instance}}},init:function(z,A,x,B,y){return q.bindingHandlers.template["init"](z,q.bindingHandlers["with"].makeTemplateValueAccessor(A))},update:function(z,A,x,B,y){return q.bindingHandlers.template["update"](z,q.bindingHandlers["with"].makeTemplateValueAccessor(A),x,B,y)}};q.jsonExpressionRewriting.bindingRewriteValidators["with"]=false;q.virtualElements.allowedBindings["with"]=true;q.bindingHandlers["if"]={makeTemplateValueAccessor:function(x){return function(){return{"if":x(),templateEngine:q.nativeTemplateEngine.instance}}},init:function(z,A,x,B,y){return q.bindingHandlers.template["init"](z,q.bindingHandlers["if"].makeTemplateValueAccessor(A))},update:function(z,A,x,B,y){return q.bindingHandlers.template["update"](z,q.bindingHandlers["if"].makeTemplateValueAccessor(A),x,B,y)}};q.jsonExpressionRewriting.bindingRewriteValidators["if"]=false;q.virtualElements.allowedBindings["if"]=true;q.bindingHandlers.ifnot={makeTemplateValueAccessor:function(x){return function(){return{ifnot:x(),templateEngine:q.nativeTemplateEngine.instance}}},init:function(z,A,x,B,y){return q.bindingHandlers.template["init"](z,q.bindingHandlers.ifnot.makeTemplateValueAccessor(A))},update:function(z,A,x,B,y){return q.bindingHandlers.template["update"](z,q.bindingHandlers.ifnot.makeTemplateValueAccessor(A),x,B,y)}};q.jsonExpressionRewriting.bindingRewriteValidators.ifnot=false;q.virtualElements.allowedBindings.ifnot=true;q.bindingHandlers.foreach={makeTemplateValueAccessor:function(x){return function(){var y=q.utils.unwrapObservable(x());if((!y)||typeof y.length=="number"){return{foreach:y,templateEngine:q.nativeTemplateEngine.instance}}return{foreach:y.data,includeDestroyed:y.includeDestroyed,afterAdd:y.afterAdd,beforeRemove:y.beforeRemove,afterRender:y.afterRender,templateEngine:q.nativeTemplateEngine.instance}}},init:function(z,A,x,B,y){return q.bindingHandlers.template["init"](z,q.bindingHandlers.foreach.makeTemplateValueAccessor(A))},update:function(z,A,x,B,y){return q.bindingHandlers.template["update"](z,q.bindingHandlers.foreach.makeTemplateValueAccessor(A),x,B,y)}};q.jsonExpressionRewriting.bindingRewriteValidators.foreach=false;q.virtualElements.allowedBindings.foreach=true;q.templateEngine=function(){};q.templateEngine.prototype.renderTemplateSource=function(z,x,y){throw new Error("Override renderTemplateSource")};q.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(x){throw new Error("Override createJavaScriptEvaluatorBlock")};q.templateEngine.prototype.makeTemplateSource=function(y,z){if(typeof y=="string"){z=z||h;var x=z.getElementById(y);if(!x){throw new Error("Cannot find template with ID "+y)}return new q.templateSources.domElement(x)}else{if((y.nodeType==1)||(y.nodeType==8)){return new q.templateSources.anonymousTemplate(y)}else{throw new Error("Unknown template type: "+y)}}};q.templateEngine.prototype.renderTemplate=function(z,x,y,A){var B=this["makeTemplateSource"](z,A);return this["renderTemplateSource"](B,x,y)};q.templateEngine.prototype.isTemplateRewritten=function(x,y){if(this["allowTemplateRewriting"]===false){return true}var z=y&&y!=h;if(!z&&this.knownRewrittenTemplates&&this.knownRewrittenTemplates[x]){return true}return this["makeTemplateSource"](x,y)["data"]("isRewritten")};q.templateEngine.prototype.rewriteTemplate=function(z,x,A){var C=this["makeTemplateSource"](z,A);var y=x(C.text());C.text(y);C.data("isRewritten",true);var B=A&&A!=h;if(!B&&typeof z=="string"){this.knownRewrittenTemplates=this.knownRewrittenTemplates||{};this.knownRewrittenTemplates[z]=true}};q.exportSymbol("templateEngine",q.templateEngine);q.templateRewriting=(function(){var y=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi;var z=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;function A(E){var B=q.jsonExpressionRewriting.bindingRewriteValidators;for(var C=0;C<E.length;C++){var D=E[C]["key"];if(B.hasOwnProperty(D)){var G=B[D];if(typeof G==="function"){var F=G(E[C]["value"]);if(F){throw new Error(F)}}else{if(!G){throw new Error("This template engine does not support the '"+D+"' binding within its templates")}}}}}function x(C,F,G){var D=q.jsonExpressionRewriting.parseObjectLiteral(C);A(D);var E=q.jsonExpressionRewriting.insertPropertyAccessorsIntoJson(D);var B="ko.templateRewriting.applyMemoizedBindingsToNextSibling(function() {             return (function() { return { "+E+" } })()         })";return G.createJavaScriptEvaluatorBlock(B)+F}return{ensureTemplateIsRewritten:function(B,D,C){if(!D.isTemplateRewritten(B,C)){D.rewriteTemplate(B,function(E){return q.templateRewriting.memoizeBindingAttributeSyntax(E,D)},C)}},memoizeBindingAttributeSyntax:function(B,C){return B.replace(y,function(){return x(arguments[6],arguments[1],C)}).replace(z,function(){return x(arguments[1],"<!-- ko -->",C)})},applyMemoizedBindingsToNextSibling:function(B){return q.memoization.memoize(function(D,C){if(D.nextSibling){q.applyBindingsToNode(D.nextSibling,B,C)}})}}})();q.exportSymbol("templateRewriting",q.templateRewriting);q.exportSymbol("templateRewriting.applyMemoizedBindingsToNextSibling",q.templateRewriting.applyMemoizedBindingsToNextSibling);(function(){q.templateSources={};q.templateSources.domElement=function(y){this.domElement=y};q.templateSources.domElement.prototype.text=function(){var z=q.utils.tagNameLower(this.domElement),y=z==="script"?"text":z==="textarea"?"value":"innerHTML";if(arguments.length==0){return this.domElement[y]}else{var A=arguments[0];if(y==="innerHTML"){q.utils.setHtml(this.domElement,A)}else{this.domElement[y]=A}}};q.templateSources.domElement.prototype.data=function(y){if(arguments.length===1){return q.utils.domData.get(this.domElement,"templateSourceData_"+y)}else{q.utils.domData.set(this.domElement,"templateSourceData_"+y,arguments[1])}};var x="__ko_anon_template__";q.templateSources.anonymousTemplate=function(y){this.domElement=y};q.templateSources.anonymousTemplate.prototype=new q.templateSources.domElement();q.templateSources.anonymousTemplate.prototype.text=function(){if(arguments.length==0){var y=q.utils.domData.get(this.domElement,x)||{};if(y.textData===j&&y.containerData){y.textData=y.containerData.innerHTML}return y.textData}else{var z=arguments[0];q.utils.domData.set(this.domElement,x,{textData:z})}};q.templateSources.domElement.prototype.nodes=function(){if(arguments.length==0){var y=q.utils.domData.get(this.domElement,x)||{};return y.containerData}else{var z=arguments[0];q.utils.domData.set(this.domElement,x,{containerData:z})}};q.exportSymbol("templateSources",q.templateSources);q.exportSymbol("templateSources.domElement",q.templateSources.domElement);q.exportSymbol("templateSources.anonymousTemplate",q.templateSources.anonymousTemplate)})();(function(){var x;q.setTemplateEngine=function(E){if((E!=j)&&!(E instanceof q.templateEngine)){throw new Error("templateEngine must inherit from ko.templateEngine")}x=E};function C(F,H,E){var J,I=F,G=q.virtualElements.nextSibling(H);while(I&&((J=I)!==G)){I=q.virtualElements.nextSibling(J);if(J.nodeType===1||J.nodeType===8){E(J)}}}function y(F,E){if(F.length){var G=F[0],H=F[F.length-1];C(G,H,function(I){q.applyBindings(E,I)});C(G,H,function(I){q.memoization.unmemoizeDomNodeAndDescendants(I,[E])})}}function B(E){return E.nodeType?E:E.length>0?E[0]:null}function A(K,J,L,E,H){H=H||{};var F=K&&B(K);var M=F&&F.ownerDocument;var N=(H.templateEngine||x);q.templateRewriting.ensureTemplateIsRewritten(L,N,M);var I=N.renderTemplate(L,E,H,M);if((typeof I.length!="number")||(I.length>0&&typeof I[0].nodeType!="number")){throw new Error("Template engine must return an array of DOM nodes")}var G=false;switch(J){case"replaceChildren":q.virtualElements.setDomNodeChildren(K,I);G=true;break;case"replaceNode":q.utils.replaceDomNodes(K,I);G=true;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+J)}if(G){y(I,E);if(H.afterRender){H.afterRender(I,E["$data"])}}return I}q.renderTemplate=function(K,F,H,J,I){H=H||{};if((H.templateEngine||x)==j){throw new Error("Set a template engine before calling renderTemplate")}I=I||"replaceChildren";if(J){var G=B(J);var L=function(){return(!G)||!q.utils.domNodeIsAttachedToDocument(G)};var E=(G&&I=="replaceNode")?G.parentNode:G;return q.dependentObservable(function(){var M=(F&&(F instanceof q.bindingContext))?F:new q.bindingContext(q.utils.unwrapObservable(F));var O=typeof(K)=="function"?K(M["$data"]):K;var N=A(J,I,O,M,H);if(I=="replaceNode"){J=N;G=B(J)}},null,{disposeWhen:L,disposeWhenNodeIsRemoved:E})}else{return q.memoization.memoize(function(M){q.renderTemplate(K,F,H,M,"replaceNode")})}};q.renderTemplateForEach=function(L,G,I,K,J){var F;var H=function(M,N){var O=typeof(L)=="function"?L(M):L;F=J.createChildContext(q.utils.unwrapObservable(M));F["$index"]=N;return A(null,"ignoreTargetNode",O,F,I)};var E=function(N,M,O){y(M,F);if(I.afterRender){I.afterRender(M,N)}};return q.dependentObservable(function(){var N=q.utils.unwrapObservable(G)||[];if(typeof N.length=="undefined"){N=[N]}var M=q.utils.arrayFilter(N,function(O){return I.includeDestroyed||O===j||O===null||!q.utils.unwrapObservable(O._destroy)});q.utils.setDomNodeChildrenFromArrayMapping(K,M,H,I,E)},null,{disposeWhenNodeIsRemoved:K})};var D="__ko__templateSubscriptionDomDataKey__";function z(E,F){var G=q.utils.domData.get(E,D);if(G&&(typeof(G.dispose)=="function")){G.dispose()}q.utils.domData.set(E,D,F)}q.bindingHandlers.template={init:function(G,I){var E=q.utils.unwrapObservable(I());if((typeof E!="string")&&(!E.name)&&(G.nodeType==1||G.nodeType==8)){var H=G.nodeType==1?G.childNodes:q.virtualElements.childNodes(G),F=q.utils.moveCleanedNodesToContainerElement(H);new q.templateSources.anonymousTemplate(G)["nodes"](F)}return{controlsDescendantBindings:true}},update:function(I,N,E,O,F){var G=q.utils.unwrapObservable(N());var L;var K=true;if(typeof G=="string"){L=G}else{L=G.name;if("if" in G){K=K&&q.utils.unwrapObservable(G["if"])}if("ifnot" in G){K=K&&!q.utils.unwrapObservable(G.ifnot)}}var M=null;if((typeof G==="object")&&("foreach" in G)){var H=(K&&G.foreach)||[];M=q.renderTemplateForEach(L||I,H,G,I,F)}else{if(K){var J=(typeof G=="object")&&("data" in G)?F.createChildContext(q.utils.unwrapObservable(G.data)):F;M=q.renderTemplate(L||I,J,G,I)}else{q.virtualElements.emptyNode(I)}}z(I,M)}};q.jsonExpressionRewriting.bindingRewriteValidators.template=function(E){var F=q.jsonExpressionRewriting.parseObjectLiteral(E);if((F.length==1)&&F[0]["unknown"]){return null}if(q.jsonExpressionRewriting.keyValueArrayContainsKey(F,"name")){return null}return"This template engine does not support anonymous templates nested within its templates"};q.virtualElements.allowedBindings.template=true})();q.exportSymbol("setTemplateEngine",q.setTemplateEngine);q.exportSymbol("renderTemplate",q.renderTemplate);(function(){function x(L,F,E){var z=[];for(var C=0;C<=F.length;C++){z[C]=[]}for(var C=0,D=Math.min(L.length,E);C<=D;C++){z[0][C]=C}for(var C=1,D=Math.min(F.length,E);C<=D;C++){z[C][0]=C}var M,N=L.length,G,H=F.length;var A,B;for(M=1;M<=N;M++){var J=Math.max(1,M-E);var I=Math.min(H,M+E);for(G=J;G<=I;G++){if(L[M-1]===F[G-1]){z[G][M]=z[G-1][M-1]}else{var K=z[G-1][M]===j?Number.MAX_VALUE:z[G-1][M]+1;var O=z[G][M-1]===j?Number.MAX_VALUE:z[G][M-1]+1;z[G][M]=Math.min(K,O)}}}return z}function y(C,I,G){var J=I.length;var H=G.length;var D=[];var E=C[H][J];if(E===j){return null}while((J>0)||(H>0)){var F=C[H][J];var z=(H>0)?C[H-1][J]:E+1;var A=(J>0)?C[H][J-1]:E+1;var B=(H>0)&&(J>0)?C[H-1][J-1]:E+1;if((z===j)||(z<F-1)){z=E+1}if((A===j)||(A<F-1)){A=E+1}if(B<F-1){B=E+1}if((z<=A)&&(z<B)){D.push({status:"added",value:G[H-1]});H--}else{if((A<z)&&(A<B)){D.push({status:"deleted",value:I[J-1]});J--}else{D.push({status:"retained",value:I[J-1]});H--;J--}}}return D.reverse()}q.utils.compareArrays=function(C,B,A){if(A===j){return q.utils.compareArrays(C,B,1)||q.utils.compareArrays(C,B,10)||q.utils.compareArrays(C,B,Number.MAX_VALUE)}else{C=C||[];B=B||[];var z=x(C,B,A);return y(z,C,B)}}})();q.exportSymbol("utils.compareArrays",q.utils.compareArrays);(function(){function x(A){if(A.length>2){var B=A[0],C=A[A.length-1],D=[B];while(B!==C){B=B.nextSibling;if(!B){return}D.push(B)}Array.prototype.splice.apply(A,[0,A.length].concat(D))}}function z(B,F,G,A,D){var E=[];var C=q.dependentObservable(function(){var H=F(G,D)||[];if(E.length>0){x(E);q.utils.replaceDomNodes(E,H);if(A){A(G,H)}}E.splice(0,E.length);q.utils.arrayPushAll(E,H)},null,{disposeWhenNodeIsRemoved:B,disposeWhen:function(){return(E.length==0)||!q.utils.domNodeIsAttachedToDocument(E[0])}});return{mappedNodes:E,dependentObservable:C}}var y="setDomNodeChildrenFromArrayMapping_lastMappingResult";q.utils.setDomNodeChildrenFromArrayMapping=function(D,A,R,Z,B){A=A||[];Z=Z||{};var K=q.utils.domData.get(D,y)===j;var N=q.utils.domData.get(D,y)||[];var M=q.utils.arrayMap(N,function(ab){return ab.arrayEntry});var E=q.utils.compareArrays(M,A);var S=[];var O=0;var Y=[];var T=0;var X=[];var I=null;for(var G=0,L=E.length;G<L;G++){switch(E[G].status){case"retained":var C=N[O];C.indexObservable(T);T=S.push(C);if(C.domNodes.length>0){I=C.domNodes[C.domNodes.length-1]}O++;break;case"deleted":N[O].dependentObservable.dispose();x(N[O].domNodes);q.utils.arrayForEach(N[O].domNodes,function(ab){Y.push({element:ab,index:G,value:E[G].value});I=ab});O++;break;case"added":var aa=E[G].value;var H=q.observable(T);var P=z(D,R,aa,B,H);var Q=P.mappedNodes;T=S.push({arrayEntry:E[G].value,domNodes:Q,dependentObservable:P.dependentObservable,indexObservable:H});for(var V=0,W=Q.length;V<W;V++){var U=Q[V];X.push({element:U,index:G,value:E[G].value});if(I==null){q.virtualElements.prepend(D,U)}else{q.virtualElements.insertAfter(D,U,I)}I=U}if(B){B(aa,Q,H)}break}}q.utils.arrayForEach(Y,function(ab){q.cleanNode(ab.element)});var J=false;if(!K){if(Z.afterAdd){for(var G=0;G<X.length;G++){Z.afterAdd(X[G].element,X[G].index,X[G].value)}}if(Z.beforeRemove){for(var G=0;G<Y.length;G++){Z.beforeRemove(Y[G].element,Y[G].index,Y[G].value)}J=true}}if(!J&&Y.length){for(var G=0;G<Y.length;G++){var F=Y[G].element;if(F.parentNode){F.parentNode.removeChild(F)}}}q.utils.domData.set(D,y,S)}})();q.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",q.utils.setDomNodeChildrenFromArrayMapping);q.nativeTemplateEngine=function(){this["allowTemplateRewriting"]=false};q.nativeTemplateEngine.prototype=new q.templateEngine();q.nativeTemplateEngine.prototype.renderTemplateSource=function(B,x,y){var D=!(q.utils.ieVersion<9),A=D?B.nodes:null,z=A?B.nodes():null;if(z){return q.utils.makeArray(z.cloneNode(true).childNodes)}else{var C=B.text();return q.utils.parseHtmlFragment(C)}};q.nativeTemplateEngine.instance=new q.nativeTemplateEngine();q.setTemplateEngine(q.nativeTemplateEngine.instance);q.exportSymbol("nativeTemplateEngine",q.nativeTemplateEngine);(function(){q.jqueryTmplTemplateEngine=function(){var A=this.jQueryTmplVersion=(function(){if((typeof(jQuery)=="undefined")||!(jQuery.tmpl)){return 0}try{if(jQuery.tmpl["tag"]["tmpl"]["open"].toString().indexOf("__")>=0){return 2}}catch(B){}return 1})();function y(){if(A<2){throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.")}}function z(B,C,D){return jQuery.tmpl(B,C,D)}this["renderTemplateSource"]=function(H,B,E){E=E||{};y();var F=H.data("precompiled");if(!F){var I=H.text()||"";I="{{ko_with $item.koBindingContext}}"+I+"{{/ko_with}}";F=jQuery.template(null,I);H.data("precompiled",F)}var C=[B["$data"]];var D=jQuery.extend({koBindingContext:B},E.templateOptions);var G=z(F,C,D);G.appendTo(h.createElement("div"));jQuery.fragments={};return G};this["createJavaScriptEvaluatorBlock"]=function(B){return"{{ko_code ((function() { return "+B+" })()) }}"};this["addTemplate"]=function(C,B){h.write("<script type='text/html' id='"+C+"'>"+B+"</script>")};if(A>0){jQuery.tmpl["tag"]["ko_code"]={open:"__.push($1 || '');"};jQuery.tmpl["tag"]["ko_with"]={open:"with($1) {",close:"} "}}};q.jqueryTmplTemplateEngine.prototype=new q.templateEngine();var x=new q.jqueryTmplTemplateEngine();if(x.jQueryTmplVersion>0){q.setTemplateEngine(x)}q.exportSymbol("jqueryTmplTemplateEngine",q.jqueryTmplTemplateEngine)})()})})(window,document,navigator);d.observable=function(g){if(typeof(g)==="object"&&g.constructor==Array){return c.observableArray(g)}if(typeof(g)==="function"){return c.computed(g)}return c.observable(g)};d.applyBindings=function(g){if(!g.node){g.node=window.document.body}if(g.binding){c.applyBindingsToNode(g.node,g.binding,g.viewModel)}else{c.applyBindings(g.viewModel,g.node)}};d.inject=function(g){var j='<script id="'+g.id+'" type="text/html">';j+=g.content;j+="</script>";if(typeof g.target=="undefined"||g.target.toLowerCase()=="body"){var h=document.createElement("div");h.setAttribute("style","display:none;");document.body.appendChild(h);c.utils.setHtml(h,j)}else{var i=b.Sizzle(g.target)[0];c.utils.setHtml(i,j)}};d.clearNode=function(g){c.cleanNode(g)};c.bindingHandlers.cssClass={update:function(g,i){var h=c.utils.unwrapObservable(i());g.className=h}};d.bindingHandlers=c.bindingHandlers})(b.Templating=b.Templating||{})})(window.xRTML=window.xRTML||{});function guidGenerator(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())}(function(b,a){(function(m,q){var o=function(B){var A=this;var x=B.name||"";var y=B.namespace||"";var t=B.description||"";var z=B.properties||q;var v=B.methods||q;var u=B.events||q;var r=B.classes||q;var w=B.modules||q;this.Name=(function(){return x})();this.Namespace=(function(){return y})();this.Description=(function(){return t})();this.Properties=(function(){return z})();this.Methods=(function(){return v})();this.Events=(function(){return u})();this.Classes=(function(){return r})();this.Modules=(function(){return w})()};var h=function(C){var A=this;var x=C.name||"";var y=C.namespace||"";var r=C.base||q;var B=C.subclasses||q;var t=C.constructors||q;var u=C.description||"";var z=C.properties||q;var w=C.methods||q;var v=C.events||q;this.Name=(function(){return x})();this.Namespace=(function(){return y})();this.Base=(function(){return r})();this.Subclasses=(function(){return B})();this.Constructors=(function(){return t})();this.Description=(function(){return u})();this.Properties=(function(){return z})();this.Methods=(function(){return w})();this.Events=(function(){return v})();this.toString=function(){return(this.Namespace.length>0)?this.Namespace+"."+this.Name:this.Name};this.typeOf=C.typeOf||function(){return A.toString()}};var p=function(w){var u=w.name||"";var r=w.description||"";var t=w.mandatory||false;var v=w.type||q;this.Name=(function(){return u})();this.Description=(function(){return r})();this.Mandatory=(function(){return t})();this.Type=(function(){return v})()};var n=function(x){var v=x.name||"";var t=x.description||"";var r=x.arguments||"";var w=x["return"]||q;var u=x.exceptions||"";this.Name=(function(){return v})();this.Description=(function(){return t})();this.Arguments=(function(){return r})();this.Return=(function(){return w})();this.Exceptions=(function(){return u})()};var g=function(w){var u=w.name||"";var r=w.description||"";var t=w.mandatory||false;var v=w.type||q;this.Name=(function(){return u})();this.Description=(function(){return r})();this.Mandatory=(function(){return t})();this.Type=(function(){return v})()};var i=function(u){var t=u.name||"";var r=u.handler||q;this.Name=(function(){return t})();this.Handler=(function(){return r})()};var l=function(w){var u=w.name||"";var v=w.namespace||"";var t=w.description||"";var r=w.arguments||q;this.Name=(function(){return u})();this.Namespace=(function(){return v})();this.Description=(function(){return t})();this.Arguments=(function(){return r})()};var c={root:new o({name:"root",classes:{String:new h({name:"String",typeOf:function(){return"String"}}),Number:new h({name:"String",typeOf:function(){return"Number"}}),Boolean:new h({name:"String",typeOf:function(){return"Boolean"}}),Function:new h({name:"String",typeOf:function(){return"Function"}}),Array:new h({name:"String",typeOf:function(){return"Array"}}),Function:new h({name:"String",typeOf:function(){return"Function"}}),Date:new h({name:"String",typeOf:function(){return"Date"}}),Object:new h({name:"String",typeOf:function(){return"Object"}}),RegExp:new h({name:"String",typeOf:function(){return"RegExp"}}),Error:new h({name:"String",typeOf:function(){return"Error"}})},modules:{xRTML:new o({name:"xRTML",modules:{Tags:new o({name:"Tags",classes:new Object()})}}),Anonymous:new o({name:"Anonymous"})}})};var d={};var f=function(u,t,r){if(!d[u]){d[u]=new Array()}d[u].push({reference:t,propertyName:r})};m.fixUnresolvedTypes=function(){for(var u in d){var r=j(u);if(r){for(var t=0;t<d[u].length;t++){d[u][t].reference[d[u][t].propertyName]=r}delete d[u]}}for(var u in d){console.warn(u+" -> "+d[u].length)}};var k=function(w){if(w==q||w.length==0){return c.root}var u,r,v=w.lastIndexOf(".");if(v===-1){r=w}else{u=w.substring(0,v);r=w.substring(v+1)}var t=c.root;if(u!=q){t=k(u)}return t.Modules[r]};var j=function(w){var u,r,v=w.lastIndexOf(".");if(v===-1){r=w}else{u=w.substring(0,v);r=w.substring(v+1)}var t=c.root;if(u!=q){t=k(u)}return(t)?t.Classes[r]:q};m.registerModule=function(K){var E,D,I=K.name.lastIndexOf(".");if(I!=-1){K.namespace=K.name.substring(0,I);K.name=K.name.substring(I+1)}var J=new o({name:K.name,namespace:K.namespace,description:K.description});var D=k(K.namespace);if(!D.Modules){D.Modules={}}D.Modules[K.name]=J;for(var L=0;L<K.classes.length;L++){this.registerClass(K.classes[L])}var F={};for(var G in K.properties){var H=q;if(K.properties[G].type instanceof String||typeof(K.properties[G].type)=="string"){H=j(K.properties[G].type)}else{H=this.registerClass(K.properties[G].type)}F[G]=new p({name:G,description:K.properties[G].description,mandatory:K.properties[G].mandatory,type:H});if(!F[G].Type){f(K.properties[G],F[G],"Type")}}var C={};for(var B in K.methods){var u={};for(var r in K.methods[B].arguments){var t=q;if(K.methods[B].arguments[r].type instanceof String||typeof(K.methods[B].arguments[r].type)=="string"){t=j(K.methods[B].arguments[r].type)}else{t=this.registerClass(K.methods[B].arguments[r].type)}u[r]=new g({name:r,description:K.methods[B].arguments[r].description,mandatory:K.methods[B].arguments[r].mandatory,type:t});if(!u[r].Type){f(K.methods[B].arguments[r],u[r],"Type")}}var z={};for(var L=0;L<K.methods[B].exceptions.length;L++){if(K.methods[B].exceptions[L] instanceof String||typeof(K.methods[B].exceptions[L])=="string"){var y=j(K.methods[B].exceptions[L]);if(y!=q){z[y.toString()]=y}else{throw"Type "+K.methods[B].exceptions[L]+" is not defined"}}else{var y=this.registerClass(K.methods[B].exceptions[L]);z[y.toString()]=y}}var A={name:B,description:K.methods[B].description,arguments:u,exceptions:z};if(K.methods[B]["return"]){if(K.methods[B]["return"] instanceof String||typeof(K.methods[B]["return"])=="string"){A["return"]=j(K.methods[B]["return"])}else{A["return"]=this.registerClass(K.methods[B]["return"])}}C[B]=new n(A);if(K.methods[B]["return"]&&!C[B].Return){f(K.methods[B]["return"],C[B],"Return")}}var x={};for(var w in K.events){var v=q;if(K.events[w].type instanceof String||typeof(K.events[w].type)=="string"){v=j(K.events[w].handler)}else{v=this.registerHandler(K.events[w].handler)}x[w]=new i({name:w,description:K.events[w].description,handler:v})}J.Properties=F;J.Methods=C;J.Events=x;return J};m.registerClass=function(K){if(K.name==q){K.name=guidGenerator()}if(K.namespace==q){K.namespace="Anonymous"}var v=q;if(K["extends"]){v=j(K["extends"])}var M=function(P){var O={};for(var N in P){O[N]=P[N]}return O};var G=(v)?M(v.Properties):{};for(var H in K.properties){var I=q;if(K.properties[H].type instanceof String||typeof(K.properties[H].type)=="string"){I=j(K.properties[H].type)}else{I=this.registerClass(K.properties[H].type)}G[H]=new p({name:H,description:K.properties[H].description,mandatory:K.properties[H].mandatory,type:I});if(!G[H].Type){f(K.properties[H].type,G[H],"Type")}}var w=(v)?M(v.constructors):{};for(var D in K.constructors){var u={};for(var r in K.constructors[D].arguments){var t=q;if(K.constructors[D].arguments[r].type instanceof String||typeof(K.constructors[D].arguments[r].type)=="string"){t=j(K.constructors[D].arguments[r].type)}else{t=this.registerClass(K.constructors[D].arguments[r].type)}u[r]=new g({name:r,description:K.constructors[D].arguments[r].description,mandatory:K.constructors[D].arguments[r].mandatory,type:t});if(!u[r].Type){f(K.constructors[D].arguments[r].type,u[r],"Type")}}var B={};for(var L=0;L<K.constructors[D].exceptions.length;L++){if(K.constructors[D].exceptions[L] instanceof String||typeof(K.constructors[D].exceptions[L])=="string"){var A=j(K.constructors[D].exceptions[L]);B[A.toString()]=A;if(!B[A.toString()]){f(K.constructors[D].exceptions[L],B,A.toString())}}else{var A=this.registerClass(K.constructors[D].exceptions[L]);B[A.toString()]=A}}var C={name:D,description:K.constructors[D].description,arguments:u,exceptions:B};if(K.constructors[D]["return"]){if(K.constructors[D]["return"] instanceof String||typeof(K.constructors[D]["return"])=="string"){C["return"]=j(K.constructors[D]["return"])}else{C["return"]=this.registerClass(K.constructors[D]["return"])}}w[D]=new n(C);if(K.constructors[D]["return"]&&!w[D].Return){f(K.constructors[D]["return"],w[D],"Return")}}var E=(v)?M(v.Methods):{};for(var D in K.methods){var u={};for(var r in K.methods[D].arguments){var t=q;if(K.methods[D].arguments[r].type instanceof String||typeof(K.methods[D].arguments[r].type)=="string"){t=j(K.methods[D].arguments[r].type)}else{t=this.registerClass(K.methods[D].arguments[r].type)}u[r]=new g({name:r,description:K.methods[D].arguments[r].description,mandatory:K.methods[D].arguments[r].mandatory,type:t});if(!u[r].Type){f(K.methods[D].arguments[r].type,u[r],"Type")}}var B={};for(var L=0;L<K.methods[D].exceptions.length;L++){if(K.methods[D].exceptions[L] instanceof String||typeof(K.methods[D].exceptions[L])=="string"){var A=j(K.methods[D].exceptions[L]);B[A.toString()]=A;if(!B[A.toString()]){f(K.methods[D].exceptions[L],B,A.toString())}}else{var A=this.registerClass(K.methods[D].exceptions[L]);B[A.toString()]=A}}var C={name:D,description:K.methods[D].description,arguments:u,exceptions:B};if(K.methods[D]["return"]){if(K.methods[D]["return"] instanceof String||typeof(K.methods[D]["return"])=="string"){C["return"]=j(K.methods[D]["return"])}else{C["return"]=this.registerClass(K.methods[D]["return"])}}E[D]=new n(C);if(K.methods[D]["return"]&&!E[D].Return){f(K.methods[D]["return"],E[D],"Return")}}var z=(v)?M(v.Events):{};for(var y in K.events){var x=q;if(K.events[y].type instanceof String||typeof(K.events[y].type)=="string"){x=j(K.events[y].handler)}else{x=this.registerHandler(K.events[y].handler)}z[y]=new i({name:y,description:K.events[y].description,handler:x})}var J=new h({name:K.name,namespace:K.namespace,base:v,description:K.description,properties:G,constructors:w,methods:E,events:z});if(K["extends"]&&!J.Base){f(K["extends"],J,"Base")}var F=k(K.namespace);if(!F.Classes){F.Classes={}}F.Classes[K.name]=J;if(v){if(typeof v.Subclasses=="undefined"){v.Subclasses=new Object()}v.Subclasses[J.toString()]=J}return J};m.registerHandler=function(x){if(x.name==q){x.name=guidGenerator()}if(x.namespace==q){x.namespace="Anonymous"}var u={};for(var r in x.arguments){var t=q;if(x.arguments[r].type instanceof String||typeof(x.arguments[r].type)=="string"){t=j(x.arguments[r].type)}else{t=this.registerClass(x.arguments[r].type)}u[r]=new g({name:r,description:x.arguments[r].description,mandatory:x.arguments[r].mandatory,type:t});if(!u[r].Type){f(x.arguments[r].type,u[r],"Type")}}var v=new l({name:x.name,namespace:x.namespace,description:x.description,arguments:u});var w=k(x.namespace);if(!w.Classes){w.Classes={}}w.Classes[x.name]=v;return v};m.getClass=function(r){return j(r)};m.getModule=function(r){return(r)?k(r):c.root};m.validateProperties=function(v,t){var r=(v instanceof String||typeof(v)=="string")?j(v):v;for(var u in r.Properties){if(r.Properties[u].Mandatory==true&&t[u]===q){return false}if(r.Properties[u].Mandatory==false&&t[u]===q){continue}if(r.Properties[u].Type==m.get("Object")&&typeof(t[u])=="object"){continue}if(r.Properties[u].Type==m.get("String")){if(t[u] instanceof String||typeof(t[u])=="string"){continue}else{return false}}if(r.Properties[u].Type==m.get("Number")){if(!isNaN(parseFloat(t[u]))&&isFinite(t[u])){continue}else{return false}}if(r.Properties[u].Type==m.get("Boolean")){if(t[u] instanceof Boolean||typeof(t[u])=="boolean"){continue}else{return false}}if(r.Properties[u].Type==m.get("Array")){if(typeof(t[u])==="object"&&t[u].constructor==Array){continue}else{return false}}if(r.Properties[u].Type==m.get("Function")){if(t[u] instanceof Function){continue}else{return false}}if(m.validateProperties(r.Properties[u].Type,t[u])){continue}return false}return true}})(b.Metadata=b.Metadata||{})})(window.xRTML=window.xRTML||{});xRTML.TagManager.register({name:"Media","abstract":true,struct:function(){var a=xRTML.Common.Function.proxy(function(){if(this.autoPlay&&this.sources.next()){this.play(this.sources.current())}},this);var b=xRTML.Common.Function.proxy(function(){if(this.autoPlay&&this.sources.current()){this.player.play(this.sources.current())}this.bind({ended:b});this.bind({ended:a})},this);this.init=function(g){this._super(g);this.target=this.target[0];this.width=xRTML.Common.Converter.toNumber(g.attribute("width"))||null;this.height=xRTML.Common.Converter.toNumber(g.attribute("height"))||null;this.autoPlay=typeof g.attribute("autoPlay")=="undefined"?true:xRTML.Common.Converter.toBoolean(g.attribute("autoPlay"));this.loop=typeof g.attribute("loop")=="undefined"?true:xRTML.Common.Converter.toBoolean(g.attribute("loop"));this.controlsBar=xRTML.Common.Converter.toBoolean(g.attribute("controlsBar"))||false;this.muted=xRTML.Common.Converter.toBoolean(g.attribute("muted"))||false;this.loadStatus=0;this.sources=(function(){var h=[],i=-1;return{current:function(){return(h.length&&i!=-1)!=0?h[i]:null},currentIndex:function(){return i},next:function(){i=(++i)<h.length?i:0;return h.length!=0?h[i]:null},previous:function(){i=--i<0?(h.length-1):i;return h.length!=0?h[i]:null},insert:function(l,k){if(l&&k>0&&k<(h.length+1)){if(!(l instanceof Array)){l=[l]}for(var j=l.length-1;j>=0;--j){h.splice(k,0,l[j])}if(i!=-1&&k<i){i+=l.length}}},push:function(j){if(j){if(!(j instanceof Array)){j=[j]}h.push.apply(h,j)}},removeAt:function(k){var j=null;if(k>=0&&k<h.length){j=h.splice(k,1);if(i>h.length||k<i){--i}}return j},remove:function(n){for(var l=0;l<h.length;++l){var j=h[l],m=true;for(var k in n){if(!xRTML.Common.Object.equals(n[k],j[k])){m=false;break}}if(m){return this.removeAt(l)}}return null},pop:function(){return this.removeAt(h.length-1)},purge:function(){h=[];i=-1},length:function(){return h.length}}})();var f=this;this.players={};this.players.swf=function(h){xRTML.Event.extend(this);xRTML.Common.DOM.loadScript({url:"http://code.xrtml.org/plugins/swfobject.js",callback:xRTML.Common.Function.proxy(function(){this.isReady=true;this.fire({ready:{}})},this)});this.isReady=false;this.id=xRTML.Common.Util.idGenerator();this.target=h.target;this.width=h.width;this.height=h.height;this.supportedMedia={swf:this.canPlayType("swf")};function i(j){f.fire({loadedmetadata:{event:j,target:f}})}this.bind({loadedmetadata:i})};this.players.swf.prototype={play:function(n){if(!this.isReady){this.bind({ready:xRTML.Common.Function.proxy(function(){this.play(n)},this)});return}var i=n.files.swf;if(i){if(xRTML.Sizzle(this.id+" object").length>0){this.stop()}var k=document.createElement("span");k.id=this.id;this.target.appendChild(k);var j={},m={allowScriptAccess:"always",play:"true",loop:"true"},h={id:"FLVplayer_"+this.id,name:"FLVplayer_"+this.id,align:"middle"},l=xRTML.Common.Function.proxy(function(o){this.fire({loadedmetadata:o})},this);swfobject.embedSWF(i,this.id,this.width,this.height,"9.0.0",null,j,m,h,l);this.restart=function(){this.stop();this.play(n)}}},isPlaying:function(){return xRTML.Sizzle("#FLVplayer_"+this.id).length>0},stop:function(){if(typeof swfobject!="undefined"){swfobject.removeSWF("FLVplayer_"+this.id)}},pause:function(){},restart:function(){},skip:function(){},mute:function(){},volume:function(){},canPlayExtension:function(h){var i=this.supportedMedia[h];if(typeof i==="undefined"){return false}return this.canPlayType(i)},canPlayType:function(h){return h==="swf"},time:function(){return{current:0,duration:0}}};var d=function(i){this.id=xRTML.Common.Util.idGenerator();var o=document.createElement(i.type);o.id=this.id;o.width=i.width;o.height=i.height;o.poster=i.poster;o.autoplay=i.autoPlay;o.loop=i.loop;o.muted=i.muted;o.controls=i.controls;this.addPlayerDOM=function(){f.target.appendChild(o);xRTML.Event.bind(o,{progress:r});xRTML.Event.bind(o,{loadedmetadata:l});xRTML.Event.bind(o,{timeupdate:t});xRTML.Event.bind(o,{play:p});xRTML.Event.bind(o,{playing:q});xRTML.Event.bind(o,{pause:n});xRTML.Event.bind(o,{ended:j})};this.fallback=typeof f.players.swf==="function"?new f.players.swf(i):f.players.swf;this.supportedMedia={};for(var h in i.formats){this.supportedMedia[h]=o.canPlayType(i.formats[h])=="maybe"||o.canPlayType(i.formats[h])=="probably"}var m=this;function r(u){var v=u.target.buffered.length!=0?u.target.buffered.end(0):0;m.loadStatus=parseInt(((v/u.target.duration)*100))}xRTML.Event.bind(o,{progress:r});function l(u){f.duration=u.target.duration;f.currentTime=u.target.currentTime;if(i.keepRatio){u.target.height=u.target.videoHeight;u.target.width=u.target.videoWidth}if(o.paused){o.play()}f.fire({loadedmetadata:{event:u,target:f}})}xRTML.Event.bind(o,{loadedmetadata:l});function t(u){f.currentTime=u.target.currentTime}xRTML.Event.bind(o,{timeupdate:t});function p(u){}xRTML.Event.bind(o,{play:p});function q(u){}xRTML.Event.bind(o,{playing:q});function n(u){}xRTML.Event.bind(o,{pause:n});function j(u){f.fire("ended",{file:u})}xRTML.Event.bind(o,{ended:j});function k(u){if(u.target.error!==null){var v="";switch(u.target.error.code){case u.target.error.MEDIA_ERR_ABORTED:v="You aborted the media playback.";break;case u.target.error.MEDIA_ERR_NETWORK:v="A network error caused the media download to fail part-way.";break;case u.target.error.MEDIA_ERR_DECODE:v="The media playback was aborted due to a corruption problem or because the media used features your browser did not support.";break;case u.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:v="The media could not be loaded, either because the server or network failed or because the format is not supported.";break;default:v="An unknown error occurred.";break}xRTML.Error.raise({code:xRTML.Error.Codes.UNEXPECTEDMEDIA,target:f,message:v,info:{className:"xRTML.TagManager.Media",methodName:"errorHandler (internal method, no docs available)"}})}}xRTML.Event.bind(o,{error:k});this.isReady=true};d.prototype={loadStatus:0,play:function(j){for(var h in j.files){if(this.supportedMedia[h]===true){var i=document.getElementById(this.id);if(!i){this.addPlayerDOM();i=document.getElementById(this.id)}i.autoplay=j.autoPlay===i.autoplay?i.autoplay:j.autoPlay;i.loop=j.loop===i.loop?i.loop:j.loop;i.src=j.files[h];i.load();i.play();xRTML.Console.debug("Playing file: "+j.files[h]);if(j.offset){this.offset(j.offset.start,j.offset.end)}return}}if(this.fallback&&j.files.swf){this.fallback.play(j)}else{document.getElementById(this.id).innerHTML="Your browser cannot play these movie types."}},stop:function(){var h=document.getElementById(this.id);h.currentTime=h.duration},pause:function(){var h=document.getElementById(this.id);h.paused?h.play():h.pause()},restart:function(){var h=document.getElementById(this.id);h.currentTime=0},skip:function(i){var h=document.getElementById(this.id);if(h.readyState>=h.HAVE_METADATA){h.currentTime=i}else{xRTML.Event.bind(h,{loadedmetadata:function(j){j.target.currentTime=i}})}},mute:function(){var h=document.getElementById(this.id);h.muted=!h.muted},volume:function(h){var i=document.getElementById(this.id);i.volume=h/100},isPlaying:function(){return document.getElementById(this.id).currentTime!=0},canPlayExtension:function(h){var i=this.supportedMedia[h];if(typeof i==="undefined"){return false}return this.canPlayType(i)},canPlayType:function(j){var i=document.getElementById(this.id),h=i.canPlayType(j);return((h=="maybe")||(h=="probably"))},time:function(){var h=document.getElementById(this.id);return{current:h.currentTime,duration:h.duration}},offset:function(k,h){var i=document.getElementById(this.id),j=function(m){i.currentTime=k;var l=function(){if(i.currentTime>=h){i.pause();xRTML.Event.unbind(i,{timeupdate:l})}};xRTML.Event.unbind(i,{timeupdate:l})};if(i.readyState>=i.HAVE_METADATA){j()}else{xRTML.Event.bind(i,{loadedmetadata:j})}}};this.bind({ended:a});var c={type:g.attribute("type")||{},formats:g.attribute("formats")||{},target:this.target,width:this.width,height:this.height,poster:this.poster,autoPlay:this.autoPlay,loop:this.loop,controls:this.controlsBar,muted:this.muted,keepRatio:this.keepRatio};xRTML.Common.Function.proxy(function(){if(document.createElement(c.type).canPlayType){var j=document.createElement(c.type),h;for(var i in c.formats){h=j.canPlayType(c.formats[i]);if((h=="maybe")||(h=="probably")){this.players[i]=d}}}},this)();this.players.get=function(i){for(var h in i){if(this[h]){if(typeof this[h]==="function"){this[h]=new this[h](c)}return this[h]}}}};this.play=function(c){if(this.target.hasChildNodes()){if(this.player){if(this.player.supportedMedia.swf){swfobject.removeSWF("FLVplayer_"+this.player.id)}else{if(this.player.supportedMedia.yt){swfobject.removeSWF("xrtml-video-ytplayer")}else{this.target.removeChild(this.target.lastChild)}}}}var d=null;if(c){d=c;this.player=this.players.get(c.files);this.player.play(c);this.unbind({ended:a});this.bind({ended:b})}else{d=(this.sources.current()==null&&this.sources.length()!=0)?this.sources.next():this.sources.current();this.player=this.players.get(d.files);this.player.play(d)}this.fire({play:{source:d}})};this.stop=function(){this.player.stop();this.fire({stop:{}})};this.pause=function(){this.player.pause();this.fire({pause:{}})};this.restart=function(){this.player.restart();this.fire({restart:{}})};this.mute=function(){this.player.mute();this.fire({mute:{}})};this.volume=function(c){if(c&&c.volume){var d=typeof c.volume==="string"?parseInt(c.volume):c.volume;if(d>100){d=100}else{if(d<0){d=0}}this.player.volume(d);this.fire({volume:{volume:d}})}};this.skip=function(c){if(c&&c.skip){var d=typeof c.skip==="string"?parseInt(c.skip):c.skip;this.player.skip(d);this.fire({skip:{skip:d}})}};this.queue=function(c){if(c){this.sources.push(c);this.fire({queue:{sources:c}});if(this.autoPlay&&!this.isPlaying()){this.play()}}};this.unqueue=function(c){if(c){this.sources.remove(c);this.fire({unqueue:{source:c}})}};this.next=function(){var c=this.sources.next();this.play(c);this.fire({next:{source:c}})};this.previous=function(){var c=this.sources.previous();this.play(c);this.fire({previous:{source:c}})};this.time=function(){return{duration:this.duration,currentTime:this.currentTime}};this.isPlaying=function(){return !!this.player&&this.player.isPlaying()}}});xRTML.TagManager.register({name:"Audio",base:"Media",struct:function(){this.init=function(a){a.type="audio";a.muted=false;a.formats={mp3:"audio/mpeg",ogg:"audio/ogg",aac:"audio/mp4",wav:"audio/wav",pcm:"audio/webm"};this._super(a)}}});xRTML.TagManager.register({name:"Video",base:"Media",struct:function(){this.init=function(a){this.poster=a.attribute("poster")||null;this.keepRatio=typeof a.attribute("keepRatio")=="undefined"?true:xRTML.Common.Converter.toBoolean(a.attribute("keepRatio"));a.type="video";a.formats={mp4:"video/mp4",ogg:"video/ogg",webm:"video/webm",avi:"video/divx"};a.keepRatio=this.keepRatio;a.poster=this.poster;this._super(a);var b=this;this.players.yt=function(c){xRTML.Event.extend(this);this.id=xRTML.Common.Util.idGenerator();this.config=c;this.supportedMedia={yt:true};this.player=null;var f=this;window.onYouTubePlayerReady=function(g){f.player=document.getElementById("xrtml-video-ytplayer");f.player.addEventListener("onStateChange","onYouTubePlayerStateChange");b.dispatchEvent("onYouTubePlayerReady",{playerId:g})};function d(g){b.fire({loadedmetadata:{event:g,target:f}})}this.bind({loadedmetadata:d});window.onYouTubePlayerStateChange=function(g){switch(g){case -1:b.dispatchEvent("unstarted");break;case 0:b.dispatchEvent("ended");break;case 1:b.dispatchEvent("playing");break;case 2:b.dispatchEvent("paused");break;case 3:b.dispatchEvent("buffering");break;case 5:b.dispatchEvent("videocued");break}}};this.players.yt.prototype={play:function(g){g.files.yt=g.files.yt.replace(/^[^v]+v.(.{11}).*/,"$1");var f="?autoplay="+(!!this.config.autoplay||!!g.autoplay?"1":"0");f+="&loop="+(!!this.config.loop||!!g.loop?"1":"0");f+="&controls="+(!!this.config.controls||!!g.controls?"1":"0");f+="&enablejsapi=1&playerapiid=ytplayer&version=3";if(typeof swfobject==="undefined"){xRTML.Common.DOM.loadScript({url:"http://code.xrtml.org/plugins/swfobject.js",callback:xRTML.Common.Function.proxy(function(){swfobject.removeSWF("xrtml-video-ytplayer");var h=document.createElement("span");h.id=this.id;b.target.appendChild(h);var i=xRTML.Common.Function.proxy(function(j){this.fire({loadedmetadata:j})},this);swfobject.embedSWF("http://www.youtube.com/v/"+g.files.yt+f,this.id,!!this.config.width?this.config.width:"425",!!this.config.height?this.config.height:"356","8",null,null,{allowScriptAccess:"always"},{id:"xrtml-video-ytplayer"},i)},this)})}else{swfobject.removeSWF("xrtml-video-ytplayer");var c=document.createElement("span");c.id=this.id;b.target.appendChild(c);var d=xRTML.Common.Function.proxy(function(h){this.fire({loadedmetadata:h})},this);swfobject.embedSWF("http://www.youtube.com/v/"+g.files.yt+f,this.id,!!this.config.width?this.config.width:"425",!!this.config.height?this.config.height:"356","8",null,null,{allowScriptAccess:"always"},{id:"xrtml-video-ytplayer"},d)}},stop:function(){if(!this.isPlaying()){return}this.player.stopVideo()},pause:function(){this.isPlaying()?this.player.pauseVideo():this.player.playVideo()},restart:function(){this.player.playVideo()},skip:function(c){this.player.seekTo(c,true)},mute:function(){this.player.isMuted()?this.player.unMute():this.player.mute()},volume:function(c){this.player.setVolume(c)},isPlaying:function(){if(this.player.getPlayerState){return this.player!=null&&this.player.getPlayerState()==1}return true},canPlayExtension:function(){},canPlayType:function(c){return c==="yt"},time:function(){return{current:this.player.getCurrentTime(),duration:this.player.getDuration()}},offset:function(){}}}}});xRTML.TagManager.register({name:"Broadcast",struct:function(){var a=function(b){xRTML.Event.extend(this);var h,f=0;this.senderId=b.attribute("senderId");this.target=xRTML.Sizzle(b.attribute("target"));this.event=b.attribute("event");this.xrtmlmessage=b.attribute("xrtmlmessage");this.callback=xRTML.Common.Function.parse(b.attribute("callback"));this.interval=b.attribute("interval");this.limit=b.attribute("limit")||0;this.messageSource=xRTML.Sizzle(b.attribute("messageSource"));this.messageAttribute=b.attribute("messageAttribute");var g=b.attribute("onMessage");if(g){this.bind({message:g})}this.dispatchMessage=function(){var m=[];if(this.messageSource.length>0){var j={};if(typeof this.messageAttribute!="undefined"){j[this.messageAttribute]=xRTML.Common.String.trim(this.messageSource[0][this.messageAttribute])}else{j.content=xRTML.Common.String.trim(this.messageSource[0].value)}var n={trigger:"",action:"",data:j,senderId:this.senderId};m.push(xRTML.MessageManager.create(n))}else{if(this.callback!=null){var n=this.callback();n.senderId=typeof n.senderId=="undefined"?this.senderId:n.senderId;m.push(n)}if(this.xrtmlmessage){try{var n=xRTML.JSON.parse(this.xrtmlmessage).xrtml;m.push(xRTML.MessageManager.create({trigger:n.trigger,action:n.action,data:n.data,senderId:this.id}))}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.JSON_PARSE,target:this,info:{className:"xRTML.Tags."+this.name,methodName:"dispatchMessage"}})}}}for(var l=0;l<m.length;++l){if(f==this.limit&&this.limit>0){clearInterval(h);return}this.fire({message:m[l]});f++}};if(this.target&&this.event){try{var d={};d[this.event]=xRTML.Common.Function.proxy(this.dispatchMessage,this);xRTML.Event.bind(this.target[0],d)}catch(c){xRTML.Error.raise({code:xRTML.Error.Codes.NON_EXISTING_ELEMENT,target:this,info:{className:"xRTML.Tags."+this.name,methodName:"dispatchMessage"}})}}else{if(this.interval>0){h=setInterval(xRTML.Common.Function.proxy(this.dispatchMessage,this),this.interval)}else{this.dispatchMessage()}}};this.init=function(d){this._super(d);xRTML.Common.Validator.validateRequired({target:this,prop:"channelId"});xRTML.Common.Validator.validateRequired({target:this,prop:"connections"});xRTML.Common.Validator.validateRequired({target:this,prop:"triggers"});this.receiveOwnMessages=false;var b=d.attribute("dispatchers");for(var c=0;c<b.length;++c){b[c].attribute=d.attribute;b[c].senderId=this.id;b[c].onMessage=xRTML.Common.Function.proxy(this.sendMessage,this);new a(b[c])}}}});xRTML.TagManager.register({name:"Chart",struct:function(){var f=function(j){try{xRTML.Event.extend(this);this.title=j.title?j.title.text:null;this.subTitle=j.subTitle?j.subTitle.text:null;this.series=xRTML.Templating.observable(new Array());this.dataValuesTotal=xRTML.Templating.observable(xRTML.Common.Function.proxy(function(){var m=0;for(var l=0;l<this.series().length;l++){m+=(this.series()[l].value()||this.series()[l].value()[0])}return m},this));this.updateSerie=function(l,m){this.series()[l].value(m);this.fire({serieUpdate:{serie:this.series()[l],index:l}})};this.updateSeries=function(m){this.series(new Array());for(var l=0;l<m.length;l++){this.series.push(new h({name:m[l].name,value:m[l].data[0]||m[l].data,type:m[l].type},this.dataValuesTotal))}this.fire({seriesUpdate:{series:this.series()}})};this.incrementSerie=function(m,l){var n=this.series()[m].value();xRTML.Common.Array.isArray(n)?n[0]=(n[0]+l):n=n+l;this.series()[m].value(n);this.fire({serieUpdate:{serie:this.series()[m],index:m}})};if(j.series){this.updateSeries(j.series)}}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.UNEXPECTED,info:{className:"xRTML.Tags.Chart",methodName:"init",message:k.message}})}},h=function(j,k){this.name=j.name;this.value=xRTML.Templating.observable(j.value);this.type=j.type;this.percentage=xRTML.Templating.observable(xRTML.Common.Function.proxy(function(){return this.value()/k()*100},this))},d,c={column:{update:function(j){b.series[j.index].data[0].update(parseInt(j.value()))},add:function(j){b.series.push(j.serie)}},pie:{update:function(j){b.series[0].data[j.index].update([j.name,j.value()])},add:function(j){b.series.push(j.serie)}}},b,g=function(){d=this.model=new f(this.settings);if(this.chartingPlatform=="highcharts"){if(Highcharts){if(!this.settings.chart.events){this.settings.chart.events={}}this.settings.chart.events.load=xRTML.Common.Function.proxy(function(){this.fire({rendered:{}})},this);b=new Highcharts.Chart(this.settings);var k=xRTML.Sizzle('svg text tspan:contains("Highcharts") , svg text tspan:contains("Highstock")');if(k){for(var l=0,m=k.length;l<m;l++){k[l].style.display="none"}}this.bind({serieUpdate:xRTML.Common.Function.proxy(function(n){c[this.type].update({index:n.index,name:n.serie.name,value:n.serie.value})},this),seriesUpdate:xRTML.Common.Function.proxy(function(n){var p=[];for(var o=0;o<n.series.length;o++){p.push({type:n.series[o].type,name:n.series[o].name,data:[n.series[o].value()]})}this.settings.series=p;b=new Highcharts.Chart(this.settings)},this)})}else{xRTML.Error.raise({code:xRTML.Error.Codes.TAG_INVALID_CONFIG,target:this,info:{message:"The chartingPlatform highcharts requires that the relevant libraries are imported.",className:"xRTML.Tags."+this.name,methodName:"init"}})}}else{if(typeof this.template=="undefined"){var j=' <div class="xrtml-chart">';j+='        <h1 class="xrtml-chart-title" data-bind="text:title"></h1>';j+='        <h2 class="xrtml-chart-subtitle" data-bind="text:subTitle"></h2>';j+='        <div class="xrtml-chart-values">';j+='            <ul class="xrtml-chart-graph" data-bind="foreach: series">';j+="                <li><span data-bind=\"text:value, style:{ paddingTop: (percentage()*2)+'px' }\"></span></li>";j+="            </ul>";j+="        </div>";j+='        <div class="xrtml-chart-items">';j+='            <strong class="xrtml-chart-items-title">Items</strong>';j+='            <ul class="xrtml-chart-items-names" data-bind="foreach: series">';j+='                <li><span data-bind="text:name"></span></li>';j+="            </ul>";j+='            <ul class="xrtml-chart-items-percentages" data-bind="foreach: series">';j+="                <li><span data-bind=\"text:Math.round( percentage() * Math.pow(10,0))/Math.pow(10,0)+'%'\"></span></li>";j+="            </ul>";j+="        </div>";j+="    </div>";this.template="xRTML-Chart-Template";xRTML.Templating.inject({id:this.template,content:j})}xRTML.Templating.applyBindings({node:this.targetElement,binding:{template:{name:this.template,data:d,afterRender:xRTML.Common.Function.proxy(function(o,n){this.fire({rendered:{}})},this)}}});this.bind({serieUpdate:xRTML.Common.Function.proxy(function(n){this.runEffects({element:xRTML.Sizzle(this.valuesTarget)[n.index]})},this)})}},a=function(j){d.bind({serieUpdate:xRTML.Common.Function.proxy(function(k){this.fire({serieUpdate:k})},this),seriesUpdate:xRTML.Common.Function.proxy(function(k){this.fire({seriesUpdate:k})},this)});d.bind({serieUpdate:xRTML.Common.Function.parse(j.onSerieUpdate),seriesUpdate:xRTML.Common.Function.parse(j.onSeriesUpdate),rendered:xRTML.Common.Function.parse(j.onRendered)})},i;this.init=function(k){this._super(k);this.effects=k.attribute("effects");xRTML.Effect.extend(this);this.settings=k.attribute("settings");this.targetElement=(this.settings&&this.settings.chart&&this.settings.chart.renderTo)?xRTML.Sizzle("#"+this.settings.chart.renderTo)[0]:(!!k.attribute("target")?this.target[0]:xRTML.Sizzle("#"+args.template)[0].parentNode.insertBefore(document.createElement("div"),xRTML.Sizzle("#"+args.template)[0]));this.valuesTarget=k.attribute("valuesTarget")||".values li span";this.type=k.attribute("type")?k.attribute("type"):((this.settings&&this.settings.chart&&this.settings.chart.type)?this.settings.chart.type:((this.settings&&this.settings.series&&this.settings.series[0].type)?this.settings.series[0].type:null));this.chartingPlatform=typeof k.attribute("chartingPlatform")!="undefined"?k.attribute("chartingPlatform"):"htmlchart";this.template=k.attribute("template");this.storageId=k.attribute("storageId");this.storageKey=k.attribute("storageKey");if(this.storageId){i=xRTML.StorageManager.getById(this.storageId)}var j={onSerieUpdate:k.attribute("onSerieUpdate"),onSeriesUpdate:k.attribute("onSeriesUpdate"),onRendered:k.attribute("onRendered")};if(i){i.get({namespace:"Charts",k:this.storageKey+"#settings"},xRTML.Common.Function.proxy(function(l){if(l.success){this.settings=xRTML.JSON.parse(l.data.resultData);g.call(this);a.call(this,j)}},this))}else{g.call(this);a.call(this,j)}};this.increment=function(j){d.incrementSerie(j.index,j.incrementBy)};this.update=function(j){d.updateSerie(j.index,j.value)};this.updateSeries=function(j){d.updateSeries(j.series)}}});xRTML.TagManager.register({name:"Poll",struct:function(){var k=function(n){var q=n.userId,p=n.storageKey,o=n.id?xRTML.StorageManager.getById(n.id):null,m="Polls";this.saveVote=function(t,r){o.incr({namespace:m,pair:{k:p+"#items#"+t+"#data",v:1}},function(u){if(!u.success){xRTML.Console.error("There was an error while trying to increment the vote in the Storage.")}});o.incr({namespace:m,pair:{k:p+"#user#"+q,v:1}},function(u){if(!u.success){xRTML.Console.error("There was an error while trying to increment the vote in the Storage.")}});i(q,c(q)+1)};this.getUserVotes=function(r){o.get({namespace:m,k:p+"#user#"+q},function(t){if(t.success){r(t.data.resultData?parseInt(t.data.resultData):0)}})};this.saveVoteItems=function(r){o.set({namespace:m,pair:{k:p+"#itemCount",v:r.length}},function(v){if(v.success){var u=[];for(var t=0;t<r.length;++t){u.push({k:p+"#items#"+t+"#id",v:r[t].id||t});u.push({k:p+"#items#"+t+"#name",v:r[t].name});u.push({k:p+"#items#"+t+"#data",v:r[t].data})}o.set({namespace:m,pairs:u},function(w){if(!w.success){xRTML.Console.error("There was an error while trying to save the votes in the Storage.")}})}})};this.getVoteItems=function(r){o.get({namespace:m,k:p+"#itemCount"},function(w){var x=[];if(w.success){if(w.data.resultData!=null){var t=parseInt(w.data.resultData),v=[];for(var u=0;u<t;u++){v.push(p+"#items#"+u+"#id");v.push(p+"#items#"+u+"#name");v.push(p+"#items#"+u+"#data")}o.get({namespace:m,ks:v},function(z){if(z.success&&z.data.resultData!=null){if(z.data.resultData[0]!=null){for(var y=0;y<z.data.resultData.length;y=y+3){x.push({id:z.data.resultData[y],name:z.data.resultData[y+1],data:parseInt(z.data.resultData[y+2])})}}r(x)}})}else{r(x)}}})}},j,h,l=function(m){this.id=m.id||0;this.name=m.name||"";this.data=xRTML.Templating.observable(m.data||0)},g=function(m){xRTML.Event.extend(this);var o=m.userId;var r=m.votesAllowed?xRTML.Common.Converter.toNumber(m.votesAllowed):1;var p=xRTML.Templating.observable(!!m.userVotes?Number(m.userVotes):0);this.canVote=xRTML.Templating.observable(function(){return r>p()});this.voteClick=xRTML.Common.Function.proxy(function(t){if(this.canVote()){p(p()+1);t.data(t.data()+1);h({action:"vote",data:{i:t.id}});if(j){j.saveVote(t.id)}else{i(o,p())}if(b){b.increment({index:t.id,incrementBy:1})}this.fire({ownervote:{item:t,allowed:this.canVote(),index:t.id}})}},this);this.voteItems=new Array();for(var n=0;n<m.voteItems.length;++n){var q=m.voteItems[n];q.id=parseInt(n);if(typeof q.data==="undefined"||isNaN(q.data)){q.data=0}this.voteItems.push(new l(m.voteItems[n]))}this.vote=function(t){this.voteItems[t].data(this.voteItems[t].data()+1);if(b){b.increment({index:t,incrementBy:1})}this.fire({vote:{item:this.voteItems[t],allowed:true,index:t}})}},f,a=function(m){if(m.chartSettings){m.chartSettings.series=[];for(var p=0;p<f.voteItems.length;p++){m.chartSettings.series.push({name:f.voteItems[p].name,data:[f.voteItems[p].data()]})}xRTML.TagManager.create({name:"Chart",type:"column",settings:m.chartSettings,chartingplatform:m.chartSettings.chartingPlatform?m.chartSettings.chartingPlatform:"highcharts"},xRTML.Common.Function.proxy(function(q){b=q},this));if(typeof m.buttonsTemplate=="undefined"){var o=' <div class="xrtml-poll-buttons-container" data-bind="foreach: voteItems, visible: canVote()">';o+='        <a class="xrtml-poll-button" href="javascript:return false;" data-bind="click: $parent.voteClick">Vote</a>';o+="    </div>";o+='    <div class="xrtml-poll-buttons-container" data-bind="visible: !canVote()">';o+='        <span class="xrtml-poll-message">Cannot vote again.</span>';o+="    </div>";m.buttonsTemplate="xRTML-Poll-Buttons-Template";xRTML.Templating.inject({id:m.buttonsTemplate,content:o})}var n=document.createElement("div");n.setAttribute("class","xRTML-Poll-Buttons-Container-Target");m.targetNode.appendChild(n);xRTML.Templating.applyBindings({node:n,binding:{template:{name:m.buttonsTemplate,data:m.model}}})}else{if(typeof m.template=="undefined"){var o='<div class="xrtml-poll" id="xRTML-Poll_'+this.id+'">';o+='    <div class="xrtml-poll-values-container">';o+='        <div class="graph" data-bind="foreach: voteItems">';o+='            <span class="xRTML-Poll-Value" data-bind="text: data"></span>';o+="        </div>";o+="    </div>";o+='    <div class="xrtml-poll-labels-container" data-bind="foreach: voteItems">';o+='        <label class="xrtml-poll-label"data-bind="text: name"></label>';o+="    </div>";o+='    <div class="xrtml-poll-buttons-container" data-bind="foreach: voteItems, visible: canVote()">';o+='        <a class="xrtml-poll-button" href="javascript:return false;" data-bind="click: $parent.voteClick">Vote</a>';o+="    </div>";o+='    <div class="xrtml-poll-buttons-container" data-bind="visible: !canVote()">';o+='        <span class="xrtml-poll-message">Cannot vote again.</span>';o+="    </div>";o+="</div>";m.template="xRTML-Poll-Template";xRTML.Templating.inject({id:m.template,content:o})}xRTML.Templating.applyBindings({node:m.targetNode,binding:{template:{name:m.template,data:m.model,afterRender:xRTML.Common.Function.proxy(function(){this.fire({rendered:{}})},this)}}})}f.bind({vote:xRTML.Common.Function.parse(m.onVote),ownervote:xRTML.Common.Function.parse(m.onOwnerVote),rendered:xRTML.Common.Function.parse(m.onRendered)});f.bind({vote:xRTML.Common.Function.proxy(function(q){this.fire({vote:q})},this),ownervote:xRTML.Common.Function.proxy(function(q){this.fire({ownervote:q})},this)})},d=function(m){var n;if(localStorage&&(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf("ipad")<0)){n=localStorage.getItem("d734h89nU_"+m)||(localStorage.setItem("d734h89nU_"+m,xRTML.Common.Util.idGenerator(),localStorage.getItem("d734h89nU_"+m)))}else{n=xRTML.Common.Cookie.getCookie({name:"d734h89nU_"+m})||(xRTML.Common.Cookie.setCookie({name:"d734h89nU_"+m,expiry:new Date(new Date().getTime()+315576000000)}),xRTML.Common.Cookie.getCookie({name:"d734h89nU_"+m}))}return n},c=function(m){var n;if(localStorage&&(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf("ipad")<0)){n=localStorage.getItem("d734h89nV_"+m)||0}else{n=xRTML.Common.Cookie.getCookie({name:"d734h89nV_"+m})||0}return n},i=function(n,m){if(localStorage&&(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase().indexOf("ipad")<0)){localStorage.setItem("d734h89nV_"+n,m)}else{xRTML.Common.Cookie.setCookie({name:"d734h89nV_"+n,value:m})}},b;this.init=function(n){this._super(n);this.storageId=n.attribute("storageId");this.storageKey=n.attribute("storageKey");if(this.storageId){j=new k({id:this.storageId,storageKey:this.storageKey||this.id,userId:(n.attribute("userId")||d(this.id))})}var q=this.template=n.attribute("template"),o=this.target[0];if(!o){if(typeof q!="undefined"){var p=xRTML.Sizzle("#"+q)[0];o=p.parentNode.insertBefore(document.createElement("div"),p)}else{xRTML.Error.raise({code:xRTML.Error.Codes.TAG_INVALID_CONFIG,target:this,info:{message:"Either a target or a template must be defined."}})}}this.votesAllowed=n.attribute("votesAllowed")||1;var r=n.attribute("voteItems");var m=n.attribute("chartSettings");if(j){j.getUserVotes(xRTML.Common.Function.proxy(function(t){j.getVoteItems(xRTML.Common.Function.proxy(function(u){f=this.model=new g({voteItems:(u&&u.length>0)?u:(j.saveVoteItems(r),r),votesAllowed:this.votesAllowed,userVotes:t,userId:d(this.id)});a.call(this,{targetNode:o,model:f,template:q,buttonsTemplate:n.attribute("buttonsTemplate"),onVote:n.attribute("onVote"),onOwnerVote:n.attribute("onOwnerVote"),onRendered:n.attribute("onRendered"),chartSettings:m})},this))},this))}else{f=this.model=new g({voteItems:r,votesAllowed:this.votesAllowed,userVotes:c(n.attribute("userId")||d(this.id)),userId:d(this.id)});a.call(this,{targetNode:o,model:f,template:q,buttonsTemplate:n.attribute("buttonsTemplate"),onVote:n.attribute("onVote"),onOwnerVote:n.attribute("onOwnerVote"),onRendered:n.attribute("onRendered"),chartSettings:m})}h=xRTML.Common.Function.proxy(function(t){this.sendMessage(t)},this)};this.vote=function(m){f.vote(m.i)}}});xRTML.TagManager.register({name:"Execute",struct:function(){this.init=function(a){this._super(a);this.callback=xRTML.Common.Function.parse(a.attribute("callback"),"message")};this.process=function(b){var a=typeof b!="undefined"&&b.callback?xRTML.Common.Function.parse(b.callback,"data"):this.callback;(typeof a=="function")?a(b):xRTML.Error.raise({code:xRTML.Error.Codes.TAG_PROCESS,target:this,info:{message:'The property "callback" is not defined in the Tag nor in the message.',className:"xRTML.Tags."+this.name,methodName:"process"}})}}});xRTML.TagManager.register({name:"Placeholder",struct:function(){this.init=function(b){this._super(b);this.template=b.attribute("template");if(!this.template){xRTML.Console.error("Placeholder tag requires one and only one xrtml:template tag.")}this.initialData=b.attribute("initialData");if(typeof this.initialData!="undefined"){try{xRTML.Templating.applyBindings({node:this.target[0],binding:{template:{name:this.template,data:this.initialData}}})}catch(a){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:a.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}}};this.insert=function(a){try{xRTML.Templating.applyBindings({node:this.target[0],binding:{template:{name:this.template,data:a}}})}catch(b){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:b.message,className:"xRTML.Tags."+this.name,methodName:"insert"}})}}}});xRTML.TagManager.register({name:"Repeater",struct:function(){var c=function(g,f){this.maxItems=g;if(f){this.Items=xRTML.Templating.observable((new Array()).concat(f))}else{this.Items=xRTML.Templating.observable(new Array())}this.add=function(h,i,j){if(this.Items().length==this.maxItems){this.remove((!j)?this.Items().length-1:j)}if(i===-1){this.Items.push(h)}else{this.Items.splice(i,0,h)}};this.update=function(h,i){if(i<this.Items().length){this.remove(i);this.add(h,i,-1)}};this.remove=function(h){if(h==-1||h>this.Items().length){h=this.Items().length-1}this.Items.splice(h,1)}};this.model=undefined;var d=function(f){if((!isNaN(parseInt(f)))&&isFinite(f)&&f>=0){return f}return undefined};var b=function(g,f){if((!isNaN(parseFloat(g)))&&isFinite(g)&&g>=0){return parseInt(g)}return f};var a=function(g,f){var i=b(g,undefined);if(i){return i}var h={begin:0,end:-1};return h.hasOwnProperty(g)?h[g]:f};this.init=function(g){this._super(g);this.template=g.attribute("template");xRTML.Common.Validator.validateRequired({target:this,prop:"template"});this.effects=g.attribute("effects");xRTML.Effect.extend(this);this.index=a(g.attribute("index"),0);this.removeIndex=a(g.attribute("removeIndex"),-1);this.maxItems=b(g.attribute("maxItems"),Number.POSITIVE_INFINITY);this.initialData=g.attribute("initialData");if(xRTML.Common.Array.isArray(this.initialData)){this.model=new c(this.maxItems,this.initialData)}else{this.model=new c(this.maxItems)}try{xRTML.Templating.applyBindings({node:this.target[0],binding:{template:{name:this.template,foreach:this.model.Items,afterRender:xRTML.Common.Function.proxy(function(j,h){for(var k=0;k<j.length;k++){if(j[k].nodeName!="#text"){this.runEffects({element:j[k]})}}},this)}}})}catch(f){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:f.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}};this.insert=function(f){try{this.model.add(f.content,a(f.index,this.index),a(f.removeIndex,this.removeIndex))}catch(g){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:g.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}};this.update=function(f){try{this.model.update(f.content,a(f.index,this.index))}catch(g){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:g.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}};this.remove=function(f){try{this.model.remove(a(f.removeIndex,this.removeIndex))}catch(g){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:g.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}}}});xRTML.TagManager.register({name:"Shoutbox",struct:function(){var h=function(j){if(typeof j!="undefined"){this.id=j.id?j.id:xRTML.Common.Util.guidGenerator();this.name=typeof j.name!="undefined"&&j.name!=""?xRTML.Templating.observable(j.name):xRTML.Templating.observable("Write a username...");this.logged=typeof j.logged!="undefined"?xRTML.Templating.observable(j.logged):xRTML.Templating.observable(false)}else{this.id=xRTML.Common.Util.guidGenerator();this.name=xRTML.Templating.observable("Write a username...");this.logged=xRTML.Templating.observable(false)}this.isTyping=xRTML.Templating.observable(false)};var d=function(j){this.content=j.content;this.name=j.name;this.date=j.date?new Date(j.date):new Date().toString()};var g=function(j){xRTML.Event.extend(this);this.shoutboxContainer=j.shoutboxContainer;var k=xRTML.Common.DOM.getStyle({element:this.shoutboxContainer,rule:"display"});this.owner=new h();this.messages=xRTML.Templating.observable([]);this.users=xRTML.Templating.observable([]);if(j.userData){this.owner.id=j.userData.id;this.owner.name(j.userData.name);this.owner.logged(true);this.users.push(this.owner);this.fire({sendMessage:{action:"userLogin",data:{id:this.owner.id,name:this.owner.name(),logged:true,isTyping:false}}});this.fire({userLogin:{user:{id:this.owner.id,name:this.owner.name(),logged:true,isTyping:false}}})}this.messageContent=xRTML.Templating.observable("");this.logIn=function(){if(this.owner.name()!=""&&this.owner.name()!="Write a username..."){var o=xRTML.Common.Util.guidGenerator();this.owner.id=o;this.owner.logged(true);this.users.push(this.owner);xRTML.Common.Cookie.setCookie({name:a,value:xRTML.JSON.stringify({id:this.owner.id,name:this.owner.name()})});if(c){c.fire({userLogin:{user:{id:this.owner.id,name:this.owner.name(),logged:true,isTyping:false}}})}this.fire({userLogin:{user:{id:this.owner.id,name:this.owner.name(),logged:true,isTyping:false}}});this.fire({sendMessage:{action:"userLogin",data:{id:this.owner.id,name:this.owner.name(),logged:true}}})}return true};this.logOut=function(){this.owner.logged(false);xRTML.Common.Cookie.deleteCookie({name:a});if(c){c.fire({userLogout:{user:{id:this.owner.id,name:this.owner.name(),logged:true,isTyping:false}}})}this.fire({userLogout:{user:{id:this.owner.id,name:this.owner.name(),logged:false,isTyping:false}}});this.fire({sendMessage:{action:"userLogout",data:{id:this.owner.id,name:this.owner.name(),logged:false,isTyping:false}}});this.owner.name("Write a username...");return true};this.getUserById=function(p){var q=this.users();for(var o=0;o<q.length;++o){if(q[o].id==p){return q[o]}}return null};this.newUser=function(o){var p=this.getUserById(o.id);if(p!=null){p=new h(o)}else{this.users.push(new h(o))}};this.removeUser=function(o){this.users.remove(function(p){return p.id==o})};this.usersTyping=xRTML.Templating.observable(xRTML.Common.Function.proxy(function(){var r="";var q=this.users();if(q.length==0){return""}for(var o=0;o<q.length;o++){var p=q[o];if(p.id!=this.owner.id&&p.isTyping()){r+=p.name()+", "}}return r!=""?r.slice(0,r.length-2):""},this));this.newMessage=function(o){this.messages.push(o);if(xRTML.Common.DOM.getStyle({element:this.shoutboxContainer,rule:"display"})=="none"){this.show()}};this.sendMessage=function(o){if(this.messageContent().length>0){var p=new d({name:o.name||this.owner.name(),content:o.content||this.messageContent()});this.newMessage(p);this.fire({sendMessage:{action:"post",data:p}});if(c){c.fire({messagePost:{message:{user:this.owner,content:p}}})}this.fire({messagePost:{message:p}});this.messageContent("")}};var l=false;this.sendTypingMessage=function(){if(l!=this.owner.isTyping()){l=!l;this.fire({sendMessage:{action:"typing",data:{id:this.owner.id,name:this.owner.name(),logged:true,typing:this.owner.isTyping()}}});this.fire({userTyping:{user:{id:this.owner.id,name:this.owner.name(),logged:true,typing:this.owner.isTyping()}}})}};this.getUserIndexById=function(p){var q=this.users();for(var o=0;o<q.length;++o){if(q[o].id==p){return o}}};this.setUserTyping=function(o){var p=this.getUserById(o.id);if(p){p.isTyping(o.typing);this.fire({userTyping:{user:{id:p.id,name:p.name(),logged:true,typing:p.isTyping()}}})}};this.close=function(){this.shoutboxContainer.style.display="none";this.fire({close:{}});return true};this.show=function(){this.shoutboxContainer.style.display=k;this.fire({show:{}})};if(xRTML.Common.Array.isArray(j.initialData)){for(var n in j.initialData){var m=new d({name:j.initialData[n].name,content:j.initialData[n].content,data:j.initialData[n].data});this.newMessage(m)}}};var i=function(){var k;var l;var m=null;var j;return{init:function(p,q,n,r,o){l=parseInt(q());k=r.owner;j=r;xRTML.Event.bind(p,{keypress:function(t){var v=t?t:event;var u=v.srcElement?v.srcElement:v.target;var w=v.keyCode?v.keyCode:v.which?v.which:v.charCode;if(w==13){j.sendMessage({name:k.name(),content:j.messageContent()});k.isTyping(false);clearTimeout(m);j.sendTypingMessage();return true}k.isTyping(true);if(m!=null){clearTimeout(m)}m=setTimeout(function(){k.isTyping(false);m=null;j.sendTypingMessage()},l);return true},keydown:function(t){var v=t?t:event;var w=v.keyCode?v.keyCode:v.which?v.which:v.charCode;var u=v.srcElement?v.srcElement:v.target;if(w==8||w==46){k.isTyping(j.messageContent().length>0);if(m!=null){clearTimeout(m)}m=setTimeout(function(){k.isTyping(false);m=null},l)}return true},keyup:function(t){var v=t?t:event;var w=v.keyCode?v.keyCode:v.which?v.which:v.charCode;var u=v.srcElement?v.srcElement:v.target;j.messageContent(u.value.replace(/[\n\r\t]/g,""));if(w==8||w==46){k.isTyping(j.messageContent().length>0);if(m!=null){clearTimeout(m);m=null}m=setTimeout(function(){k.isTyping(false);m=null},l)}j.sendTypingMessage();return true}})}}};var b=function(j){xRTML.Event.extend(this);var k=xRTML.StorageManager.getById(j.id),l=j.key;this.getAndUpdateUsers=function(){k.get({namespace:"Shoutbox",k:l+"#usersCount"},function(o){if(Number(o.data.resultData)){var n=[];for(var m=1;m<=Number(o.data.resultData);m++){n.push(l+"#users#"+m)}k.get({namespace:"Shoutbox",ks:n},function(r){if(r.data.resultData){for(var p=0,q=r.data.resultData.length;p<q;p++){if(r.data.resultData[p]!=null){f.newUser(xRTML.JSON.parse(r.data.resultData[p]))}}}})}})};this.getAndUpdateMessages=function(){k.get({namespace:"Shoutbox",k:l+"#messagesCount"},function(o){if(o.data.resultData){var n=[];for(var m=1;m<=Number(o.data.resultData);m++){n.push(l+"#messages#"+m)}k.get({namespace:"Shoutbox",ks:n},function(r){if(r.data.resultData){for(var p=0,q=r.data.resultData.length;p<q;p++){f.newMessage(new d(xRTML.JSON.parse(r.data.resultData[p]).content))}}})}})};this.addUser=function(m){k.incr({namespace:"Shoutbox",pair:{k:l+"#usersCount",v:1}},function(n){k.set({namespace:"Shoutbox",pair:{k:l+"#users#"+n.data.resultData,v:xRTML.JSON.stringify(m)}},function(o){})})};this.removeUser=function(m){k.get({namespace:"Shoutbox",k:l+"#usersCount"},function(n){k.del({namespace:"Shoutbox",k:l+"#users#"+(f.getUserIndexById(m)+1)},function(o){})})};this.addMessage=function(m){k.incr({namespace:"Shoutbox",pair:{k:l+"#messagesCount",v:1}},function(n){k.set({namespace:"Shoutbox",pair:{k:l+"#messages#"+n.data.resultData,v:xRTML.JSON.stringify(m)}},function(o){})})}};var f;var a;var c;this.init=function(o){this._super(o);xRTML.Templating.bindingHandlers.userTypingBinding=new i();this.template=o.attribute("template");if(!this.template){var m=' <div class="xrtml-shoutbox">';m+='        <div class="xrtml-shoutbox-close" data-bind="click: close">X</div>';m+='        <div class="xrtml-shoutbox-notificationcontainer" data-bind="visible: usersTyping().length > 0">';m+='            <span class="xrtml-shoutbox-notificationcontainer-userstypinglabel">Users typing: </span>';m+='            <span class="xRTML-Shoutbox-NotificationContainer-UsersTyping" data-bind="text: usersTyping()"></span>';m+="        </div>";m+='        <div class="xrtml-shoutbox-shoutscontainer" data-bind="template: { name: \'xrtml-shouts-template\', foreach: messages }"></div>';m+='        <div class="xrtml-shoutbox-loginform" data-bind="visible: !owner.logged()">';m+='            <input class="xrtml-shoutbox-loginform-username" type="text" data-bind="value: owner.name"></input>';m+='            <input class="xrtml-shoutbox-loginform-login" type="button" value="Log In" data-bind="click: logIn"></input>';m+="        </div>";m+='        <div class="xrtml-shoutbox-shoutform" data-bind="visible: owner.logged()">';m+='            <label class="xrtml-shoutbox-shoutform-usernamelabel" data-bind="text: owner.name()"></label>';m+='            <textarea class="xrtml-shoutbox-shoutform-shoutcontent" data-bind="value: messageContent, userTypingBinding: 3000 " rows="1" cols="50"></textarea>';m+='            <input class="xrtml-shoutbox-shoutform-send" type="button" value="Send" data-bind="click: sendMessage"></input>';m+='            <input class="xrtml-shoutbox-shoutform-logout" type="button" value="Log Out" data-bind="click: logOut"></input>';m+="        </div>";m+="    </div>";var l='   <p class="xrtml-shoutbox-shout">';l+='          <strong class="xrtml-shoutbox-shout-username" data-bind="text: name"></strong>';l+='          <span class="xrtml-shoutbox-shout-message" data-bind="text: content"></span>';l+="      <p>";xRTML.Templating.inject({id:"xrtml-shoutbox-template",content:m});xRTML.Templating.inject({id:"xrtml-shouts-template",content:l});this.template="xrtml-shoutbox-template"}this.storageId=o.attribute("storageid");this.storageKey=o.attribute("storagekey");this.initialData=o.attribute("initialData");if(this.storageId&&this.storageKey){c=new b({id:this.storageId,key:this.storageKey});c.bind({requestData:function(){c.getAndUpdateUsers();c.getAndUpdateMessages()},messagePost:xRTML.Common.Function.proxy(function(q){c.addMessage(q.message)},this),userLogin:function(q){c.addUser(q.user)},userLogout:function(q){c.removeUser(q.user.id)}});this.bind({postInit:function(){c.fire({requestData:{}})}})}else{xRTML.Console.warn("Tag "+this.name+" "+this.id+": Storage was not configured. The data will not be persistent.")}var p=xRTML.Common.Function.parse;this.bind({message:p(o.attribute("onMessage")),messagePost:p(o.attribute("onMessagePost")),userLogin:p(o.attribute("onUserLogin")),userLogout:p(o.attribute("onUserLogout")),userTyping:p(o.attribute("onUserTyping")),close:p(o.attribute("onClose")),show:p(o.attribute("onShow"))});a=(function(q){for(var r=0;r<this.triggers.length;++r){q+="_"+this.triggers[r].name}return q}).call(this,"xRTMLShoutBox");var k=xRTML.Common.Cookie.getCookie({name:a});var j={shoutboxContainer:this.target[0],initialData:this.initialData};if(k){j.userData=xRTML.JSON.parse(k)}f=this.model=new g(j);f.bind({sendMessage:xRTML.Common.Function.proxy(function(q){this.sendMessage(q)},this),messagePost:xRTML.Common.Function.proxy(function(q){this.fire({messagePost:{message:q.message}})},this),userLogin:xRTML.Common.Function.proxy(function(q){this.fire({userLogin:{user:q.user}})},this),userLogout:xRTML.Common.Function.proxy(function(q){this.fire({userLogout:{user:q.user}})},this),userTyping:xRTML.Common.Function.proxy(function(q){this.fire({userTyping:{user:q.user}})},this),close:xRTML.Common.Function.proxy(function(q){this.fire({close:{}})},this),show:xRTML.Common.Function.proxy(function(q){this.fire({show:{}})},this)});try{xRTML.Templating.applyBindings({node:this.target[0],binding:{template:{name:this.template,data:f}}})}catch(n){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:n.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}};this.post=function(j){try{f.newMessage(new d(j))}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:k.message,className:"xRTML.Tags."+this.name,methodName:"post"}})}this.fire({message:{message:j}})};this.userLogin=function(j){var l=new h(j);try{f.newUser(l)}catch(k){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:k.message,className:"xRTML.Tags."+this.name,methodName:"login"}})}this.fire({userLogin:{user:{id:l.id,isTyping:l.isTyping(),logged:l.logged(),name:l.name(),isTyping:false}}})};this.userLogout=function(k){var l=f.getUserById(k.id);try{f.removeUser(k.id)}catch(j){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:j.message,className:"xRTML.Tags."+this.name,methodName:"logout"}})}if(l!=null){this.fire({userLogout:{user:{id:l.id,isTyping:l.isTyping(),logged:l.logged(),name:l.name(),isTyping:false}}})}};this.typing=function(k){var l=f.getUserById(k.id);if(l==null){f.newUser({id:k.id,name:k.name,logged:true})}try{f.setUserTyping(k)}catch(j){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:j.message,className:"xRTML.Tags."+this.name,methodName:"typing"}})}var l=f.getUserById(k.id)};this.login=function(j){if(!f.owner||(f.owner&&f.owner.logged())){return}f.owner.id=j.id;f.owner.name(j.name);f.owner.logged(true);f.users.push(f.owner);xRTML.Common.Cookie.setCookie({name:a,value:xRTML.JSON.stringify({id:f.owner.id,name:f.owner.name()})});f.fire({sendMessage:{action:"userLogin",data:{id:f.owner.id,name:f.owner.name(),logged:true,isTyping:false}}});this.fire({userLogin:{user:{id:f.owner.id,name:f.owner.name(),logged:true,isTyping:false}}});return};this.logout=function(){if(!f.owner||(f.owner&&!f.owner.logged())){return}f.owner.logged(false);xRTML.Common.Cookie.deleteCookie({name:a});if(c){c.fire({userLogout:{user:f.owner}})}f.fire({sendMessage:{action:"userLogout",data:{id:f.owner.id}}});f.owner.name("Write a username...");return};this.show=function(){f.show()};this.close=function(){f.close()}}});xRTML.TagManager.register({name:"Toast",struct:function(){var c=function(f){var d=(function(){var i={};i.box=function(){var n,o,k,l,r,q=0;return{show:function(j){r={opacity:70,close:1,animate:1,fixed:1,mask:1,maskid:"",boxid:"",topsplit:2,url:0,post:0,height:0,width:0,html:0,iframe:0};for(s in j){r[s]=j[s]}if(!q){n=document.createElement("div");n.className="xrtml-toast-banner";q=document.createElement("div");q.className="xrtml-toast-banner-loading";k=document.createElement("div");k.className="xrtml-toast-banner-content";o=document.createElement("div");o.className="xrtml-toast-banner-mask";l=document.createElement("div");l.className="xrtml-toast-banner-close";l.v=0;document.body.appendChild(o);document.body.appendChild(n);n.appendChild(q);q.appendChild(k);o.onclick=l.onclick=function(){i.box.hide("CloseBanner")};window.onresize=i.box.resize}else{n.style.display="none";clearTimeout(q.ah);if(l.v){q.removeChild(l);l.v=0}}q.id=r.boxid;o.id=r.maskid;n.style.position=r.fixed?"fixed":"absolute";if(r.html&&!r.animate){q.style.backgroundImage="none";k.innerHTML=r.html;k.style.display="";q.style.width=r.width?r.width+"px":"auto";q.style.height=r.height?r.height+"px":"auto"}else{k.style.display="none";if(!r.animate&&r.width&&r.height){q.style.width=r.width+"px";q.style.height=r.height+"px"}else{q.style.width=q.style.height="100px"}}if(r.mask){this.mask();this.alpha(o,1,r.opacity)}else{this.alpha(n,1,100)}if(r.autohide){q.ah=setTimeout(function(){i.box.hide("TimeOut")},1000*r.autohide)}else{document.onkeyup=i.box.esc}},fill:function(m,y,v,j,z,p){if(y){if(r.image){var t=new Image();t.onload=function(){z=z||t.width;p=p||t.height;i.box.psh(t,j,z,p)};t.src=r.image}else{if(r.iframe){this.psh('<iframe src="'+r.iframe+'" width="'+r.width+'" frameborder="0" height="'+r.height+'"></iframe>',j,z,p)}else{var A=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");A.onreadystatechange=function(){if(A.readyState==4&&A.status==200){q.style.backgroundImage="";i.box.psh(A.responseText,j,z,p)}};if(v){A.open("POST",m,true);A.setRequestHeader("Content-type","application/x-www-form-urlencoded");A.send(v)}else{A.open("GET",m,true);A.send(null)}}}}else{this.psh(m,j,z,p)}},psh:function(m,j,t,p){if(typeof m=="object"){k.appendChild(m)}else{k.innerHTML=m}var u=q.style.width,v=q.style.height;if(!t||!p){q.style.width=t?t+"px":"";q.style.height=p?p+"px":"";k.style.display="";if(!p){p=parseInt(k.offsetHeight)}if(!t){t=parseInt(k.offsetWidth)}k.style.display="none"}q.style.width=u;q.style.height=v;this.size(t,p,j)},esc:function(j){j=j||window.event;if(j.keyCode==27){i.box.hide("CloseBanner")}},hide:function(j){if(xRTML.Sizzle("#xrtml-video-ytplayer").length>0){swfobject.removeSWF("xrtml-video-ytplayer")}clearTimeout(q.ah);i.box.alpha(n,-1,0,3);document.onkeypress=null;if(r.closejs){r.closejs(j)}xRTML.Sizzle(".xrtml-toast-banner")[0].parentNode.removeChild(xRTML.Sizzle(".xrtml-toast-banner")[0]);xRTML.Sizzle(".xrtml-toast-banner-mask")[0].parentNode.removeChild(xRTML.Sizzle(".xrtml-toast-banner-mask")[0])},resize:function(){i.box.pos();i.box.mask()},mask:function(){o.style.height=this.total(1)+"px";o.style.width=this.total(0)+"px"},pos:function(){var j;if(typeof r.top!="undefined"){j=r.top}else{j=(this.height()/r.topsplit)-(n.offsetHeight/2);j=j<20?20:j}if(!r.fixed&&!r.top){j+=this.top()}n.style.top=j+"px";n.style.left=typeof r.left!="undefined"?r.left+"px":(this.width()/2)-(n.offsetWidth/2)+"px"},alpha:function(p,m,j){clearInterval(p.ai);if(m){p.style.opacity=0;p.style.filter="alpha(opacity=0)";p.style.display="block";i.box.pos()}p.ai=setInterval(function(){i.box.ta(p,j,m)},20)},ta:function(p,j,m){var u=Math.round(p.style.opacity*100);if(u==j){clearInterval(p.ai);if(m==-1){p.style.display="none";p==n?i.box.alpha(o,-1,0,2):k.innerHTML=q.style.backgroundImage=""}else{if(p==o){this.alpha(n,1,100)}else{n.style.filter="";i.box.fill(r.html||r.url,r.url||r.iframe||r.image,r.post,r.animate,r.width,r.height)}}}else{var t=j-Math.floor(Math.abs(j-u)*0.5)*m;p.style.opacity=t/100;p.style.filter="alpha(opacity="+t+")"}},size:function(t,m,j){if(j){clearInterval(q.si);var u=parseInt(q.style.width)>t?-1:1,p=parseInt(q.style.height)>m?-1:1;q.si=setInterval(function(){i.box.ts(t,u,m,p)},20)}else{q.style.backgroundImage="none";if(r.close){q.appendChild(l);l.v=1}q.style.width=t+"px";q.style.height=m+"px";k.style.display="";this.pos();if(r.openjs){r.openjs()}}},ts:function(u,v,p,t){var m=parseInt(q.style.width),j=parseInt(q.style.height);if(m==u&&j==p){clearInterval(q.si);q.style.backgroundImage="none";k.style.display="block";if(r.close){q.appendChild(l);l.v=1}if(r.openjs){r.openjs()}}else{if(m!=u){q.style.width=(u-Math.floor(Math.abs(u-m)*0.6)*v)+"px"}if(j!=p){q.style.height=(p-Math.floor(Math.abs(p-j)*0.6)*t)+"px"}this.pos()}},top:function(){return document.documentElement.scrollTop||document.body.scrollTop},width:function(){return self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},height:function(){return self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},total:function(m){var j=document.body,p=document.documentElement;return m?Math.max(Math.max(j.scrollHeight,p.scrollHeight),Math.max(j.clientHeight,p.clientHeight)):Math.max(Math.max(j.scrollWidth,p.scrollWidth),Math.max(j.clientWidth,p.clientWidth))}}}();xRTML.Event.extend(this);var h=function(l){tyniboxObj={autohide:l.bannerAutoHide,animate:true,openjs:function(m){a.fire({bannerDisplay:{target:l}})},closejs:function(m){a.bannerActive=false;a.fire({bannerClose:{target:l,info:m}})}};if(l.bannerWidth){tyniboxObj.width=l.bannerWidth}if(l.bannerHeight){tyniboxObj.height=l.bannerHeight}switch(l.bannerType){default:case"image":tyniboxObj.image=l.bannerUrl;break;case"html":tyniboxObj.html=l.bannerContent;break;case"iframe":tyniboxObj.iframe=l.bannerUrl;case"flash":var j='<object type="application/x-shockwave-flash" data="'+l.bannerUrl+'"';if(l.bannerWidth){j+='width="'+l.bannerWidth+'"'}if(l.bannerHeight){j+='height="'+l.bannerHeight+'"'}j+='><param name="movie" value="'+l.bannerUrl+'" />';j+="</object>";tyniboxObj.html=j;break;case"video":if(typeof l.bannerSource!="undefined"){if(xRTML.Common.Array.contains({items:xRTML.TagManager.getClasses(),obj:"Video"})){var j='<div id="xrtml-toast-banner-videocontainer"';var k="";if(l.bannerWidth){k+="width:"+l.bannerWidth+"px;"}else{k+="width: 400px;"}if(l.bannerHeight){k+="height:"+l.bannerHeight+"px;"}else{k+="height: 400px;"}if(k!=""){j+='style="'+k+'"'}j+="></div>";tyniboxObj.html=j;tyniboxObj.openjs=xRTML.Common.Function.proxy(function(){var n={name:"Video",id:"toast-video-tag",controlsBar:false,target:"#xrtml-toast-banner-videocontainer",width:this.bannerWidth||400,height:this.bannerHeight||400,keepRatio:false};xRTML.TagManager.create(n);var m=xRTML.TagManager.getById("toast-video-tag");m.play(l.bannerSource);a.fire({bannerDisplay:{target:l}})},l);tyniboxObj.closejs=xRTML.Common.Function.proxy(function(){a.bannerActive=false;xRTML.TagManager.getById("toast-video-tag").dispose();a.fire({bannerClose:{target:l}})},l)}else{xRTML.Console.error("The xRTML video tag must be added in order to create video banners.")}}break}i.box.show(tyniboxObj)};var g=function(j){i.box.hide(j)};return{show:h,hide:g}})();this.id=xRTML.Common.Util.idGenerator();this.title=f.title;this.text=f.text;this.displayToast=f.displayToast;this.displayBanner=f.displayBanner;this.timeToLive=f.timeToLive;this.bannerType=f.bannerType;this.bannerUrl=f.bannerUrl;this.bannerContent=f.bannerContent;this.bannerWidth=f.bannerWidth;this.bannerHeight=f.bannerHeight;this.bannerAutoHide=f.bannerAutoHide;this.destinationUrl=f.destinationUrl;this.bannerSource=f.bannerSource;this.metaData=f.metaData;this.close=function(g){if(typeof g!="string"){a.destroy(this,"CloseButton")}else{a.destroy(this,g)}clearTimeout(this.timeoutReference)};this.showBanner=function(){if(this.displayToast){this.close("ShowBanner")}if(this.displayBanner){a.bannerActive=true;d.show(this);var j=xRTML.Sizzle(".xrtml-toast-banner * :not(.xrtml-toast-banner-close)");var g=xRTML.Common.Function.proxy(function(){d.hide("OpenUrl");this.openUrl();for(var k=0;k<j.length;k++){xRTML.Event.unbind(j[k],{click:g})}},this);for(var h=0;h<j.length;h++){xRTML.Event.bind(j[h],{click:g})}}else{this.openUrl()}};if(this.displayToast){this.timeoutReference=setTimeout(xRTML.Common.Function.proxy(function(){this.close("TimeOut")},this),this.timeToLive)}this.openUrl=function(){if(this.destinationUrl){window.open(this.destinationUrl,"_blank");a.fire({urlOpen:{target:this}})}}};var b=function(){xRTML.Event.extend(this);this.toasts=xRTML.Templating.observable(new Array());this.create=function(d){var f=new c(d);if(d.displayToast){if(d.index=="end"){this.toasts.push(f)}else{this.toasts.splice(0,0,f)}this.fire({toastDisplay:{target:f}})}else{f.showBanner()}};this.destroy=function(f,d){this.toasts.remove(f);this.fire({toastClose:{target:f,info:d}})};this.bannerActive=false};var a=null;this.init=function(h){this._super(h);this.positionAt=h.attribute("positionAt");this.mediaUrls=h.attribute("mediaUrls");if(typeof this.mediaUrls!="undefined"){if(xRTML.Common.Array.contains({items:xRTML.TagManager.getClasses(),obj:"Audio"})){this.audioNotificationTag=xRTML.TagManager.create({name:"Audio",controlsbar:false})}else{xRTML.Console.error("The xRTML Audio tag must be added in order to play audio notifications.")}}this.effects=h.attribute("effects");xRTML.Effect.extend(this);a=this.model=new b();this.toastContainer;if(this.target[0].tagName=="BODY"){this.toastContainer=document.createElement("div");this.toastContainer.setAttribute("id","xRTML-Toast-target");document.body.appendChild(this.toastContainer)}else{this.toastContainer=this.target[0]}this.template=h.attribute("template");if(!this.template){var d=' <div class="xrtml-toast" data-bind="attr: { id: id }">';d+='        <div class="xrtml-toast-close" data-bind="click: close">X</div>';d+='        <div class="xrtml-toast-content" data-bind="click: showBanner">';d+='            <h3 class="xrtml-toast-content-title" data-bind="text: title"></h3>';d+='            <span class="xrtml-toast-content-message" data-bind="text: text"></span>';d+="        </div>";d+="    </div>";xRTML.Templating.inject({id:"xRTML-Toast-Template",content:d});this.template="xRTML-Toast-Template"}try{xRTML.Templating.applyBindings({node:this.toastContainer,binding:{template:{name:this.template,foreach:a.toasts,afterRender:xRTML.Common.Function.proxy(function(k,j){for(var l=0;l<k.length;l++){if(k[l].nodeName!="#text"){this.runEffects({element:k[l]})}}},this)}}})}catch(f){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:f.message,className:"xRTML.Tags."+this.name,methodName:"init"}})}var g=(function(k){var j=k.toastContainer;j.style.position="fixed";switch(k.positionAt){case"topleft":j.style.top=15+"px";j.style.left=15+"px";break;case"topright":j.style.top=15+"px";j.style.right=15+"px";break;case"bottomleft":j.style.bottom=30+"px";j.style.left=15+"px";break;case"bottomright":default:j.style.bottom=30+"px";j.style.right=15+"px";break}})(this);var i=xRTML.Common.Function.parse;this.bind({toastDisplay:i(h.attribute("onToastDisplay")),toastClose:i(h.attribute("onToastClose")),bannerDisplay:i(h.attribute("onBannerDisplay")),bannerClose:i(h.attribute("onBannerClose")),urlOpen:i(h.attribute("onUrlOpen"))});a.bind({toastDisplay:xRTML.Common.Function.proxy(function(j){this.fire({toastDisplay:j})},this),toastClose:xRTML.Common.Function.proxy(function(j){this.fire({toastClose:j})},this),bannerDisplay:xRTML.Common.Function.proxy(function(j){this.fire({bannerDisplay:j})},this),bannerClose:xRTML.Common.Function.proxy(function(j){this.fire({bannerClose:j})},this),urlOpen:xRTML.Common.Function.proxy(function(j){this.fire({urlOpen:j})},this)})};this.process=function(g){var d={title:typeof g.title!="undefined"?g.title:"",text:typeof g.text!="undefined"?g.text:"",destinationUrl:typeof g.destinationUrl!="undefined"?g.destinationUrl:false,timeToLive:g.timeToLive||10000,displayToast:typeof g.displayToast!="undefined"?g.displayToast:true,displayBanner:typeof g.displayBanner!="undefined"?g.displayBanner:true,metaData:g.metaData,bannerUrl:g.bannerUrl,bannerContent:g.bannerContent,bannerType:g.bannerType,bannerSource:g.bannerSource,bannerHeight:xRTML.Common.Converter.toNumber(g.bannerHeight),bannerWidth:xRTML.Common.Converter.toNumber(g.bannerWidth),bannerAutoHide:typeof g.bannerAutoHide!="undefined"?(xRTML.Common.Converter.toNumber(g.bannerAutoHide)/1000):false};if(this.positionAt=="topleft"||this.positionAt=="topright"){d.index="begin"}else{d.index="end"}if(a.bannerActive){var f=xRTML.Common.Function.proxy(function(){this.unbind({bannerClose:f});this.process(g)},this);this.bind({bannerClose:f})}else{try{a.create(d)}catch(h){xRTML.Error.raise({code:xRTML.Error.Codes.TEMPLATING,target:this,info:{message:h.message,className:"xRTML.Tags."+this.name,methodName:"process"}})}if(typeof this.audioNotificationTag!="undefined"){this.audioNotificationTag.play({source:this.mediaUrls})}}}}});(function(a){(function(c,b){c[xRTML.version]?xRTML=c[xRTML.version]:c[xRTML.version]=xRTML;c.current=c.current||xRTML.version;xRTML=c[c.current]})(a.xRTMLVersions=a.xRTMLVersions||{})})(window);