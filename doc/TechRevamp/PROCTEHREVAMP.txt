
CREATE TABLE GUESTMARKETINGPREFERENCES
  AS (SELECT * FROM GUESTPREFERENCES);

CREATE TABLE GUESTMARKETINGPREFERENCESRESET
  AS (SELECT * FROM GUESTPREFERENCESRESET);

ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
ADD INDEX `FK1_GUESTID_idx` (`GUEST_ID` ASC);
;
ALTER TABLE `KyobeeTechRevamp`.`USER` 
DROP COLUMN `Address`;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
ADD CONSTRAINT `FK1_GUESTID`
  FOREIGN KEY (`GUEST_ID`)
  REFERENCES `KyobeeTechRevamp`.`GUEST` (`guestID`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
CHANGE COLUMN `GUEST_PREF_ID` `GUEST_MARKETING_PREF_ID` INT(11) NOT NULL DEFAULT '0' ;

ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
CHANGE COLUMN `GUEST_MARKETING_PREF_ID` `GUEST_MARKETING_PREF_ID` INT(11) NOT NULL AUTO_INCREMENT ,
CHANGE COLUMN `PREF_ID` `PREF_ID` INT(11) NOT NULL ,
ADD PRIMARY KEY (`GUEST_MARKETING_PREF_ID`);
;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCESRESET` 
CHANGE COLUMN `GUEST_PREF_RESET_ID` `GUEST_MARKETING_PREF_RESET_ID` INT(11) NOT NULL AUTO_INCREMENT ,
CHANGE COLUMN `PREF_ID` `PREF_ID` INT(11) NOT NULL ,
ADD PRIMARY KEY (`GUEST_MARKETING_PREF_RESET_ID`);
;
ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
CHANGE COLUMN `noOfPeople` `noOfPeople` INT(11) NULL DEFAULT NULL ;

UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '15');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '16');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '19');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '22');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '24');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '25');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '26');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '17');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '18');

ALTER TABLE `KyobeeTechRevamp`.`SMSLOG` 
CHANGE COLUMN `PhoneNo` `PhoneNo` INT NULL DEFAULT NULL ;

ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
CHANGE COLUMN `sms` `contactNo` INT NULL DEFAULT NULL ;

ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
DROP COLUMN `marketingPreference`;

