USE `KyobeeTechRevamp`;
DROP procedure IF EXISTS `TRANSACTIONFAILURE`;

DELIMITER $$
USE `KyobeeTechRevamp`$$
CREATE DEFINER=`root`@`%` PROCEDURE `TRANSACTIONFAILURE`(IN `ORGSUBSCRIPTIONID` INT, IN `ORGPAYMENTID` INT, IN `INVOICESTATUS` VARCHAR(100), IN `SUBSCSTATUS` VARCHAR(255), IN `PAYMENTSTATUS` VARCHAR(100), IN `PAYMENTSTATUSREASON` VARCHAR(1000) )
BEGIN

UPDATE ORGANIZATIONSUBSCRIPTION SET InvoiceStatus = INVOICESTATUS WHERE OrganizationSubscriptionID = ORGSUBSCRIPTIONID;
--
UPDATE ORGANIZATIONSUBSCRIPTIONDETAIL SET SubscriptionStatus = SUBSCSTATUS WHERE SubscriptionID = ORGSUBSCRIPTIONID;
--
UPDATE ORGANIZATIONPAYMENT SET PaymentStatusReason = PAYMENTSTATUSREASON, PaymentStatus = PAYMENTSTATUS WHERE OrganizationPaymentID = ORGPAYMENTID;    


END$$

DELIMITER ;

