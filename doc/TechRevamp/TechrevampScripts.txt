
CREATE TABLE GUESTMARKETINGPREFERENCES
  AS (SELECT * FROM GUESTPREFERENCES);

CREATE TABLE GUESTMARKETINGPREFERENCESRESET
  AS (SELECT * FROM GUESTPREFERENCESRESET);

ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
ADD INDEX `FK1_GUESTID_idx` (`GUEST_ID` ASC);
;
ALTER TABLE `KyobeeTechRevamp`.`USER` 
DROP COLUMN `Address`;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
ADD CONSTRAINT `FK1_GUESTID`
  FOREIGN KEY (`GUEST_ID`)
  REFERENCES `KyobeeTechRevamp`.`GUEST` (`guestID`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
CHANGE COLUMN `GUEST_PREF_ID` `GUEST_MARKETING_PREF_ID` INT(11) NOT NULL DEFAULT '0' ;

ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
CHANGE COLUMN `GUEST_MARKETING_PREF_ID` `GUEST_MARKETING_PREF_ID` INT(11) NOT NULL AUTO_INCREMENT ,
CHANGE COLUMN `PREF_ID` `PREF_ID` INT(11) NOT NULL ,
ADD PRIMARY KEY (`GUEST_MARKETING_PREF_ID`);
;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCESRESET` 
CHANGE COLUMN `GUEST_PREF_RESET_ID` `GUEST_MARKETING_PREF_RESET_ID` INT(11) NOT NULL AUTO_INCREMENT ,
CHANGE COLUMN `PREF_ID` `PREF_ID` INT(11) NOT NULL ,
ADD PRIMARY KEY (`GUEST_MARKETING_PREF_RESET_ID`);
;
ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
CHANGE COLUMN `noOfPeople` `noOfPeople` INT(11) NULL DEFAULT NULL ;

UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '15');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '16');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '19');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '22');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '24');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '25');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '26');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '17');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `ScreenName` = 'seatingOrMarketingPref' WHERE (`LanguageKeyMappingId` = '18');

ALTER TABLE `KyobeeTechRevamp`.`SMSLOG` 
CHANGE COLUMN `PhoneNo` `PhoneNo` INT NULL DEFAULT NULL ;

ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
CHANGE COLUMN `sms` `contactNo` INT NULL DEFAULT NULL ;

ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
DROP COLUMN `marketingPreference`;

CREATE TABLE `KyobeeTechRevamp`.`ROLE` (
  `RoleId` INT(11) NOT NULL,
  `RoleName` VARCHAR(100) NULL,
  `Active` TINYINT(1) NULL,
  `CreatedBy` VARCHAR(100) NULL,
  `CreatedAt` DATE NULL,
  `ModifiedBy` VARCHAR(100) NULL,
  `ModifiedAt` DATE NULL,
  PRIMARY KEY (`RoleId`));
  
CREATE TABLE `KyobeeTechRevamp`.`ORGANIZATIONTYPE` (
  `TypeId` INT(11) NOT NULL,
  `TypeName` VARCHAR(100) NULL,
  `Active` TINYINT(1) NULL,
  `CreatedBy` VARCHAR(100) NULL,
  `CreatedAt` DATE NULL,
  `ModifiedBy` VARCHAR(100) NULL,
  `ModifiedAt` DATE NULL,
  PRIMARY KEY (`TypeId`));
  
  
ALTER TABLE `KyobeeTechRevamp`.`USERROLE` 
DROP FOREIGN KEY `FK1RoleID`;
ALTER TABLE `KyobeeTechRevamp`.`USERROLE` 
DROP INDEX `FK1RoleID` ,
ADD INDEX `FK1RoleID_idx` (`RoleID` ASC);
;
ALTER TABLE `KyobeeTechRevamp`.`USERROLE` 
ADD CONSTRAINT `FK1RoleID`
FOREIGN KEY (`RoleID`)
REFERENCES `KyobeeTechRevamp`.`ROLE` (`RoleId`);

CREATE TABLE `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (
  `ID` INT NOT NULL,
  `LangId` INT NULL,
  `IsoCode` VARCHAR(10) NULL,
  `Level` INT NULL,
  `TemplateText` VARCHAR(250) NULL,
  `Active` TINYINT(1) NULL,
  `CreatedBy` VARCHAR(45) NULL,
  `CreatedAt` DATE NULL,
  `ModifiedBy` VARCHAR(45) NULL,
  `ModifiedAt` DATE NULL,
  PRIMARY KEY (`ID`),
  INDEX `FK01LangID_idx` (`LangId` ASC),
  CONSTRAINT `FK01LangID`
    FOREIGN KEY (`LangId`)
    REFERENCES `KyobeeTechRevamp`.`LANGMASTER` (`LangID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION` 
DROP FOREIGN KEY `FK2OrganizationTypeID`;
ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION` 
DROP INDEX `FK2OrganizationTypeID` ,
ADD INDEX `FK2OrganizationTypeID_idx` (`OrganizationTypeID` ASC);
;
ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION` 
ADD CONSTRAINT `FK2OrganizationTypeID`
  FOREIGN KEY (`OrganizationTypeID`)
  REFERENCES `KyobeeTechRevamp`.`ORGANIZATIONTYPE` (`TypeId`);
  
  ALTER TABLE `KyobeeTechRevamp`.`USER` 
CHANGE COLUMN `UserName` `UserName` VARCHAR(255) NULL ;

ALTER TABLE `KyobeeTechRevamp`.`USER` 
CHANGE COLUMN `ActivationID` `ActivationCode` VARCHAR(100) NULL DEFAULT NULL ;

ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCESRESET` 
CHANGE COLUMN `GUEST_MARKETING_PREF_RESET_ID` `gusetMarketingPrefResetId` INT(11) NOT NULL AUTO_INCREMENT ,
CHANGE COLUMN `PREF_ID` `prefId` INT(11) NOT NULL ,
CHANGE COLUMN `GUEST_ID` `guestId` INT(11) NULL DEFAULT NULL ;

DROP TABLE `KyobeeTechRevamp`.`address`;

ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
DROP COLUMN `marketingPreference`;


ALTER TABLE `KyobeeTechRevamp`.`GUESTRESET` 
DROP COLUMN `marketingPreference`;


ALTER TABLE `KyobeeTechRevamp`.`PLAN` 
CHANGE COLUMN `Active` `Active` BIT(1) NOT NULL AFTER `PLANNAME`;
  

ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
DROP FOREIGN KEY `FK1_GUESTID`;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
CHANGE COLUMN `GUEST_MARKETING_PREF_ID` `GuestMarketingPrefId` INT(11) NOT NULL AUTO_INCREMENT ,
CHANGE COLUMN `PREF_ID` `PrefId` INT(11) NOT NULL ,
CHANGE COLUMN `GUEST_ID` `GuestId` INT(11) NULL DEFAULT NULL ;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
ADD CONSTRAINT `FK1_GUESTID`
  FOREIGN KEY (`GuestId`)
  REFERENCES `KyobeeTechRevamp`.`GUEST` (`guestID`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCESRESET` 
CHANGE COLUMN `gusetMarketingPrefResetId` `GusetMarketingPrefResetId` INT(11) NOT NULL AUTO_INCREMENT ,
CHANGE COLUMN `prefId` `PrefId` INT(11) NOT NULL ,
CHANGE COLUMN `guestId` `GuestId` INT(11) NULL DEFAULT NULL ;


ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
ADD COLUMN `CreatedBy` VARCHAR(100) NULL DEFAULT NULL AFTER `GuestId`,
ADD COLUMN `CreatedAt` DATE NULL DEFAULT NULL AFTER `CreatedBy`,
ADD COLUMN `ModifiedBy` VARCHAR(100) NULL DEFAULT NULL AFTER `CreatedAt`,
ADD COLUMN `ModifiedAt` DATE NULL DEFAULT NULL AFTER `ModifiedBy`,
CHANGE COLUMN `GuestMarketingPrefId` `GuestMarketingPrefID` INT(11) NOT NULL AUTO_INCREMENT ;


ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCESRESET` 
ADD COLUMN `CreatedBy` VARCHAR(100) NULL DEFAULT NULL AFTER `GuestId`,
ADD COLUMN `CreatedAt` DATE NULL DEFAULT NULL AFTER `CreatedBy`,
ADD COLUMN `ModifiedBy` VARCHAR(45) NULL DEFAULT NULL AFTER `CreatedAt`,
ADD COLUMN `ModifiedAt` DATE NULL DEFAULT NULL AFTER `ModifiedBy`;
 

ALTER TABLE `KyobeeTechRevamp`.`USER` 
CHANGE COLUMN `AddressId` `AddressId` INT(11) NULL DEFAULT NULL AFTER `Email`,
CHANGE COLUMN `ActivationCode` `ActivationCode` VARCHAR(100) NULL DEFAULT NULL AFTER `AuthCode`,
CHANGE COLUMN `ActivationExpiryDate` `ActivationExpiryDate` DATETIME NULL DEFAULT NULL AFTER `ActivationCode`;


ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCESRESET` 
ADD COLUMN `CreatedBy` VARCHAR(100) NULL AFTER `GuestID`,
ADD COLUMN `CreatedAt` DATE NULL AFTER `CreatedBy`,
ADD COLUMN `ModifiedBy` VARCHAR(100) NULL AFTER `CreatedAt`,
ADD COLUMN `ModifiedAt` DATE NULL AFTER `ModifiedBy`,
CHANGE COLUMN `PrefId` `PrefID` INT(11) NOT NULL ,
CHANGE COLUMN `GuestId` `GuestID` INT(11) NULL DEFAULT NULL ;

ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCESRESET` 
CHANGE COLUMN `GusetMarketingPrefResetId` `GusetMarketingPrefResetID` INT(11) NOT NULL AUTO_INCREMENT ;


ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
DROP FOREIGN KEY `FK1_GUESTID`;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
CHANGE COLUMN `PrefId` `PrefID` INT(11) NOT NULL ,
CHANGE COLUMN `GuestId` `GuestID` INT(11) NULL DEFAULT NULL ;
ALTER TABLE `KyobeeTechRevamp`.`GUESTMARKETINGPREFERENCES` 
ADD CONSTRAINT `FK1_GUESTID`
  FOREIGN KEY (`GuestID`)
  REFERENCES `KyobeeTechRevamp`.`GUEST` (`guestID`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION` 
DROP COLUMN `ScreensaverFileName`,
DROP COLUMN `ScreensaverFlag`,
DROP COLUMN `smsRouteNo`,
DROP COLUMN `smsRoute`,
DROP COLUMN `CheckinSpecialNote`,
DROP COLUMN `CheckinSpecialAvailable`,
CHANGE COLUMN `DefaultLangId` `DefaultLangId` INT(10) NULL DEFAULT NULL AFTER `StripeCustomerID`,
CHANGE COLUMN `OrganizationPromotionalCode` `OrganizationPromotionalCode` VARCHAR(255) NULL DEFAULT NULL AFTER `logoFileName`,
CHANGE COLUMN `NotifyFirstFlag` `NotifyFirstFlag` CHAR(1) NULL DEFAULT 'Y' AFTER `OrganizationPromotionalCode`,
CHANGE COLUMN `TotalWaitTime` `TotalWaitTime` INT(10) NULL DEFAULT NULL AFTER `NotifyFirstFlag`,
CHANGE COLUMN `smsSignature` `smsSignature` VARCHAR(100) NULL DEFAULT NULL AFTER `TotalWaitTime`,
CHANGE COLUMN `MaxParty` `MaxParty` INT(10) NULL DEFAULT NULL AFTER `smsSignature`,
CHANGE COLUMN `Active` `Active` TINYINT(1) NOT NULL AFTER `MaxParty`;


ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION` 
DROP FOREIGN KEY `FKD063D53312C5AA27`;
ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION` 
DROP INDEX `ActiveOrganizationPlanId` ;
;

DROP TABLE `KyobeeTechRevamp`.`GUESTPREFERENCES`;
Drop table KyobeeTechRevamp.GUESTPREFERENCESRESET;
ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONPLANSUBSCRIPTION` 
CHANGE COLUMN `CHARGEID` `ChargeID` VARCHAR(255) NULL DEFAULT NULL AFTER `TerminateDate`;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONPLANSUBSCRIPTION` 
CHANGE COLUMN `ChargeID` `ChargeID` VARCHAR(255) NULL DEFAULT NULL AFTER `CurrencyID`;

ALTER TABLE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` 
CHANGE COLUMN `keyName` `KeyName` VARCHAR(200) CHARACTER SET 'latin1' NULL DEFAULT NULL ;


ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
DROP FOREIGN KEY `FK1_languageID`;
ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
ADD COLUMN `CreatedBy` VARCHAR(100) NULL AFTER `SeatedTime`,
ADD COLUMN `ModifiedBy` VARCHAR(100) NULL AFTER `CreatedAt`,
CHANGE COLUMN `guestID` `GuestID` INT(11) NOT NULL AUTO_INCREMENT ,
CHANGE COLUMN `name` `Name` VARCHAR(256) NULL DEFAULT NULL ,
CHANGE COLUMN `uuid` `Uuid` VARCHAR(45) CHARACTER SET 'latin1' NOT NULL ,
CHANGE COLUMN `noOfChildren` `NoOfChildren` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `noOfAdults` `NoOfAdults` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `noOfInfants` `NoOfInfants` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `noOfPeople` `NoOfPeople` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `quoteTime` `QuoteTime` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `partyType` `PartyType` INT(11) NULL DEFAULT '-1' ,
CHANGE COLUMN `deviceType` `DeviceType` VARCHAR(255) CHARACTER SET 'latin1' NULL DEFAULT NULL ,
CHANGE COLUMN `deviceId` `DeviceId` VARCHAR(255) CHARACTER SET 'latin1' NULL DEFAULT NULL ,
CHANGE COLUMN `contactNo` `ContactNo` VARCHAR(45) NULL DEFAULT NULL ,
CHANGE COLUMN `email` `Email` VARCHAR(45) CHARACTER SET 'latin1' NULL DEFAULT NULL ,
CHANGE COLUMN `prefType` `PrefType` VARCHAR(45) CHARACTER SET 'latin1' NULL DEFAULT NULL ,
CHANGE COLUMN `languagePrefID` `LanguagePrefID` INT(50) NOT NULL ,
CHANGE COLUMN `optin` `Optin` TINYINT(4) NULL DEFAULT NULL ,
CHANGE COLUMN `rank` `Rank` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `status` `Status` VARCHAR(45) CHARACTER SET 'latin1' NULL DEFAULT NULL ,
CHANGE COLUMN `seatingPreference` `SeatingPreference` VARCHAR(100) CHARACTER SET 'latin1' NULL DEFAULT NULL ,
CHANGE COLUMN `recvLeveltwo` `RecvLeveltwo` TINYINT(4) NULL DEFAULT NULL ,
CHANGE COLUMN `calloutCount` `CalloutCount` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `note` `Note` VARCHAR(250) NULL DEFAULT NULL ,
CHANGE COLUMN `incompleteParty` `IncompleteParty` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `resetTime` `ResetTime` DATETIME NULL DEFAULT NULL ,
CHANGE COLUMN `checkinTime` `CheckinTime` DATETIME NOT NULL ,
CHANGE COLUMN `seatedTime` `SeatedTime` DATETIME NULL DEFAULT NULL ,
CHANGE COLUMN `createdTime` `CreatedAt` DATE NULL DEFAULT NULL ,
CHANGE COLUMN `updatedTime` `ModifiedAt` DATETIME NULL DEFAULT NULL ;
ALTER TABLE `KyobeeTechRevamp`.`GUEST` 
ADD CONSTRAINT `FK1_languageID`
  FOREIGN KEY (`LanguagePrefID`)
  REFERENCES `KyobeeTechRevamp`.`LANGMASTER` (`LangID`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;



ALTER TABLE `KyobeeTechRevamp`.`GUESTRESET` 
ADD COLUMN `NoOfChildren` VARCHAR(45) NULL AFTER `Uuid`,
ADD COLUMN `NoOfAdults` VARCHAR(45) NULL AFTER `NoOfChildren`,
ADD COLUMN `NoOfInfants` VARCHAR(45) NULL AFTER `NoOfAdults`,
ADD COLUMN `CreatedBy` VARCHAR(100) NULL AFTER `SeatedTime`,
ADD COLUMN `ModifiedBy` VARCHAR(100) NULL AFTER `CreatedAt`,
CHANGE COLUMN `guestID` `GuestID` INT(11) NOT NULL ,
CHANGE COLUMN `name` `Name` VARCHAR(45) NULL DEFAULT NULL ,
CHANGE COLUMN `uuid` `Uuid` VARCHAR(45) NOT NULL ,
CHANGE COLUMN `noOfPeople` `NoOfPeople` VARCHAR(45) NULL DEFAULT NULL ,
CHANGE COLUMN `deviceType` `DeviceType` VARCHAR(255) NULL DEFAULT NULL ,
CHANGE COLUMN `deviceId` `DeviceId` VARCHAR(255) NULL DEFAULT NULL ,
CHANGE COLUMN `contactNo` `ContactNo` VARCHAR(45) NULL DEFAULT NULL ,
CHANGE COLUMN `email` `Email` VARCHAR(45) NULL DEFAULT NULL ,
CHANGE COLUMN `prefType` `PrefType` VARCHAR(45) NULL DEFAULT NULL ,
CHANGE COLUMN `languagePrefID` `LanguagePrefID` INT(11) NOT NULL ,
CHANGE COLUMN `optin` `Optin` TINYINT(4) NULL DEFAULT NULL ,
CHANGE COLUMN `rank` `Rank` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `status` `Status` VARCHAR(45) NULL DEFAULT NULL ,
CHANGE COLUMN `seatingPreference` `SeatingPreference` VARCHAR(250) NULL DEFAULT NULL ,
CHANGE COLUMN `recvLeveltwo` `RecvLeveltwo` TINYINT(4) NULL DEFAULT NULL ,
CHANGE COLUMN `calloutCount` `CalloutCount` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `note` `Note` VARCHAR(250) NULL DEFAULT NULL ,
CHANGE COLUMN `incompleteParty` `IncompleteParty` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `resetTime` `ResetTime` DATETIME NULL DEFAULT NULL ,
CHANGE COLUMN `checkinTime` `CheckinTime` DATETIME NOT NULL ,
CHANGE COLUMN `seatedTime` `SeatedTime` DATETIME NULL DEFAULT NULL ,
CHANGE COLUMN `createdTime` `CreatedAt` DATE NULL DEFAULT NULL ,
CHANGE COLUMN `updatedTime` `ModifiedAt` DATE NULL DEFAULT NULL ;
ALTER TABLE `KyobeeTechRevamp`.`GUESTRESET` 
CHANGE COLUMN `guestResetID` `GuestResetID` INT(11) NOT NULL AUTO_INCREMENT ;


UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `Value` = 'Note' WHERE (`LanguageKeyMappingId` = '10430');

UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `Value` = 'How did you hear about us?' WHERE (`LanguageKeyMappingId` = '21');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `Value` = 'Comment avez-vous entendu parler de nous?' WHERE (`LanguageKeyMappingId` = '7385');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `Value` = '你是怎么知道我们的？' WHERE (`LanguageKeyMappingId` = '202');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `Value` = '你是怎麼知道我們的？' WHERE (`LanguageKeyMappingId` = '145');
UPDATE `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` SET `Value` = '우리에 대해 어떻게 알게 되셨습니까?' WHERE (`LanguageKeyMappingId` = '260');


INSERT INTO `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` (`KeyName`, `Value`, `LangIsoCode`, `ScreenName`, `UpdateFlag`, `CreatedBy`, `CreatedAt`) VALUES ('maximum_limit_reached', 'Maximum limit reached', 'en', 'English', '0', 'admin', '2020-03-13');
INSERT INTO `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` (`KeyName`, `Value`, `LangIsoCode`, `ScreenName`, `UpdateFlag`, `CreatedBy`, `CreatedAt`) VALUES ('maximum_limit_reached', 'Limite maximale atteinte', 'fr', 'French', '0', 'admin', '2020-03-13');
INSERT INTO `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` (`KeyName`, `Value`, `LangIsoCode`, `ScreenName`, `UpdateFlag`, `CreatedBy`, `CreatedAt`) VALUES ('maximum_limit_reached', '최대 한도에 도달', 'ko', 'Korean', '0', 'admin', '2020-03-13');
INSERT INTO `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` (`KeyName`, `Value`, `LangIsoCode`, `ScreenName`, `UpdateFlag`, `CreatedBy`, `CreatedAt`) VALUES ('maximum_limit_reached', '达到最大限制', 'zh', 'Chinese', '0', 'admin', '2020-03-13');
INSERT INTO `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` (`KeyName`, `Value`, `LangIsoCode`, `ScreenName`, `UpdateFlag`, `CreatedBy`, `CreatedAt`) VALUES ('maximum_limit_reached', '达到最大限制', 'zh-Hans', 'Chinese (Simplified)', '0', 'admin', '2020-03-13');
INSERT INTO `KyobeeTechRevamp`.`LANGUAGEKEYMAPPING` (`KeyName`, `Value`, `LangIsoCode`, `ScreenName`, `UpdateFlag`, `CreatedBy`, `CreatedAt`) VALUES ('maximum_limit_reached', '達到最大限制', 'zh-Hant', 'Chinese (Traditional)', '0', 'admin', '2020-03-13');

ALTER TABLE `KyobeeTechRevamp`.`PLAN` 
CHANGE COLUMN `PLANNAME` `PlanName` VARCHAR(80) NULL DEFAULT NULL ;


ALTER TABLE `KyobeeTechRevamp`.`ADDRESS` 
CHANGE COLUMN `ActiveFlag` `ActiveFlag` INT(11) NULL DEFAULT '0' AFTER `Latitude`;

INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('34', 'fr', '1', 'G_name #G_rank: Il y a des soirées P_ahead devant vous avec env. temps d\'attente de W_time min. Pour les mises à jour LIVE:Turl', '1', 'admin', '2020-03-12');
INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('34', 'fr', '2', 'G_name #G_rank: Votre table est presque prête. Revenez au restaurant avec votre groupe et attendez que votre numéro soit appelé. Cliquez pour les mises à jour: Turl', '1', 'admin', '2020-03-12');
INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('34', 'fr', '3', '#G_rank: Alerte… vous avez été appelé. Veuillez retourner au magasin IMMÉDIATEMENT. Voir BUREAU AVANT pour le réarrangement. Cordialement, SweethoneyDessert Colma', '1', 'admin', '2020-03-12');
INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('61', 'ko', '1', 'G_name #G_rank: 있다 P_ahead 약 / 약. 대기 시간 W_time 최소 라이브 업데이트 :Turl', '1', 'admin', '2020-03-12');
INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('61', 'ko', '2', 'G_name #G_rank: 당신의 테이블은 거의 준비되었습니다. 파티 전체와 함께 식당으로 돌아가서 전화가 올 때까지 기다리십시오. 업데이트를 클릭하십시오 : Turl', '1', 'admin', '2020-03-12');
INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('61', 'ko', '3', 'G_name, 당신은 RB Sushi에서 당신의 테이블에 부름을 받았습니다. 매장으로 돌아와 좌석 예약에 대해서는 호스트에게 문의하십시오. 친애하는,', '1', 'admin', '2020-03-12');

INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('137', 'zh-Hant', '1', 'G_name #G_rank：歡迎來到金大師的韓國燒烤！你前面有P_ahead派對。等待W_time分鐘的時間。對於實時更新：Turl', '1', 'admin', '2020-03-12');
INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('137', 'zh-Hant', '2', 'G_name #G_rank：請將您的整個聚會回到商店前台等待您的電話號碼。你前面有P_ahead派對。對於現場更新：Turl  - 金大師的韓國燒烤', '1', 'admin', '2020-03-12');
INSERT INTO `KyobeeTechRevamp`.`SMSTEMPLATELANGUAGEMAPPING` (`LangId`, `IsoCode`, `Level`, `TemplateText`, `Active`, `CreatedBy`, `CreatedAt`) VALUES ('137', 'zh-Hant', '3', 'G_name 警報......你被叫了。請立即回到商店。請參閱FRONT DESK進行重新安排。最誠摯的問候，金大師的韓國燒烤', '1', 'admin', '2020-03-12');

UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'patio' WHERE (`LookupID` = '39');
UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'bar' WHERE (`LookupID` = '40');
UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'first_available' WHERE (`LookupID` = '41');
UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'booth' WHERE (`LookupID` = '42');
UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'table' WHERE (`LookupID` = '43');
UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'facebook' WHERE (`LookupID` = '45');
UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'instagram' WHERE (`LookupID` = '46');
UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'google' WHERE (`LookupID` = '47');
UPDATE `KyobeeTechRevamp`.`LOOKUP` SET `Code` = 'word_of_mouth' WHERE (`LookupID` = '48');

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION` 
ADD COLUMN `PplBifurcation` CHAR(1) NULL DEFAULT 'N' AFTER `MaxParty`;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONTEMPLATE` 
CHANGE COLUMN `TemplateText` `TemplateText` TEXT CHARACTER SET 'utf8' NULL DEFAULT NULL ;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONTEMPLATE` 
CHANGE COLUMN `TemplateText` `TemplateText` VARCHAR(255) NULL DEFAULT NULL ;

ALTER TABLE `KyobeeTechRevamp`.`GUESTRESET` 
CHANGE COLUMN `NoOfChildren` `NoOfChildren` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `NoOfAdults` `NoOfAdults` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `NoOfInfants` `NoOfInfants` INT(11) NULL DEFAULT NULL ,
CHANGE COLUMN `NoOfPeople` `NoOfPeople` INT(11) NULL DEFAULT NULL ;

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('congrats_you_are_in','축하합니다! 당신은 포함 됐어!','ko','Korean',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('congrats_you_are_in','恭喜你！你在！','zh-Hant','Chinese (Traditional)',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('congrats_you_are_in','恭喜你！你在！','zh-Hans','Chinese (Simplified)',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('congrats_you_are_in','恭喜你！你在！','zh','Chinese',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('congrats_you_are_in','Toutes nos félicitations! Vous y êtes!','fr','French',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('congrats_you_are_in',"Congratulations! You're in!",'en','English',1,'admin','2020-02-26');

---------------------------------------------------------------------------------------------------------
insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('your_customer_number_is','고객 번호는','ko','Korean',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('your_customer_number_is','您的客戶號碼是','zh-Hant','Chinese (Traditional)',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('your_customer_number_is','您的客户号码是','zh-Hans','Chinese (Simplified)',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('your_customer_number_is','您的客户号码是','zh','Chinese',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('your_customer_number_is','Votre numéro de client est','fr','French',1,'admin','2020-02-26');

insert into KyobeeTechRevamp.LANGUAGEKEYMAPPING(keyName,Value,LangIsoCode,ScreenName,UpdateFlag,CreatedBy,CreatedAt) 
values('your_customer_number_is','Your customer number is','en','English',1,'admin','2020-02-26');
-------------------------------------------------------------------------------------------------------------
DROP TABLE `PLAN`;
DROP TABLE `PLANFEATURE`;
DROP TABLE `PLANPRICE`;

FK of ORGANIZATIONPLANSUBSCRIPTION in organization table , so need to remove this ref
FK of ORGANIZATIONPLANSUBSCRIPTION in ORGANIZATIONADCREDIT table , so need to remove this ref
FK of ORGANIZATIONPLANSUBSCRIPTION in ORGANIZATIONADCREDITSCHEDULER table , so need to remove this ref
DROP TABLE  ORGANIZATIONPLANSUBSCRIPTIONINVOICE;
DROP table  ORGANIZATIONPLANSUBSCRIPTION
DROP TABLE USERROLE;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION`   
  ADD COLUMN `CustomerID` INT(11)  AFTER `ReservationInfo`,
  ADD CONSTRAINT `FKCustomerID` FOREIGN KEY (`CustomerID`) REFERENCES `KyobeeTechRevamp`.`CUSTOMER`(`CustomerID`);
Need to add not null after customer added

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONUSER`   
  ADD COLUMN `CustomerID` INT(11) NULL AFTER `UserID`,
  ADD COLUMN `RoleID` INT(11) NULL AFTER `CustomerID`,
  ADD COLUMN `Active` TINYINT(1) DEFAULT 1  NOT NULL AFTER `RoleID`;

ALTER TABLE `KyobeeTechRevamp`.`ROLE`   
  CHANGE `RoleId` `RoleID` INT(11) NOT NULL;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONUSER` 
  ADD CONSTRAINT `Fk3RoleID` FOREIGN KEY (`RoleID`) REFERENCES `KyobeeTechRevamp`.`ROLE`(`RoleID`),
  DROP FOREIGN KEY `FKA367E77E4E546E32`;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONUSER` 
  ADD CONSTRAINT `FK4CustomerID` FOREIGN KEY (`CustomerID`) REFERENCES `KyobeeTechRevamp`.`CUSTOMER`(`CustomerID`),
  DROP FOREIGN KEY `FKA367E77E5C062662`;

CREATE TABLE `KyobeeTechRevamp`.`PLANTERM`(  
  `PlanTermID` INT(11) NOT NULL AUTO_INCREMENT,
  `PlanTermName` VARCHAR(255) COMMENT 'Monthly,Annually',
  `SortOrder` INT,
  `Active` TINYINT(1),
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`PlanTermID`)
);

CREATE TABLE `KyobeeTechRevamp`.`CURRENCY`(  
  `CurrencyID` INT(11) NOT NULL AUTO_INCREMENT,
  `FullName` VARCHAR(255),
  `ShortName` VARCHAR(255),
  `Code` VARCHAR(10),
  `Icon` VARCHAR(255),
  `Active` TINYINT(1) NOT NULL,
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`CurrencyID`)
);

CREATE TABLE `KyobeeTechRevamp`.`PLANFEATURECHARGE`(  
  `PlanFeatureChargeID` INT(11) NOT NULL AUTO_INCREMENT,
  `FeatureID` INT(11) NOT NULL,
  `PlanID` INT(11) NOT NULL,
  `CurrencyID` INT(11) NOT NULL,
  `PlanTermID` INT(11) NOT NULL,
  `TermChargeAmt` DECIMAL(5,2) NOT NULL,
  `Active` TINYINT(1) NOT NULL,
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`PlanFeatureChargesID`),
  CONSTRAINT `FK_PlanFeatureCharge_FeatureId` FOREIGN KEY (`FeatureID`) REFERENCES `KyobeeTechRevamp`.`FEATURE`(`FeatureID`),
  CONSTRAINT `FK_PlanFeatureCharge_PlanID` FOREIGN KEY (`PlanID`) REFERENCES `KyobeeTechRevamp`.`PLAN`(`PlanID`),
  CONSTRAINT `FK_PlanFeatureCharge_CurrencyID` FOREIGN KEY (`CurrencyID`) REFERENCES `KyobeeTechRevamp`.`Currency`(`CurrencyID`),
  CONSTRAINT `FK_PlanFeatureCharge_PlanTermID` FOREIGN KEY (`PlanTermID`) REFERENCES `KyobeeTechRevamp`.`PlanTerm`(`PlanTermID`)
);

CREATE TABLE `KyobeeTechRevamp`.`PROMOTIONALCODE`(  
  `PromotionalCodeID` INT(11) NOT NULL AUTO_INCREMENT,
  `PromoCode` VARCHAR(255) NOT NULL,
  `ValidStartDate` DATE NOT NULL,
  `ValidEndDate` DATE,
  `CodeType` VARCHAR(50),
  `FlatAmt` DECIMAL(5,2),
  `PercAmt` DECIMAL(5,2),
  `CurrencyID` INT(11),
  `Active` TINYINT(1) NOT NULL,
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`PromoID`, `PromoCode`, `ValidStartDate`),
  CONSTRAINT `FK_PromotionalCode_CurrencyID` FOREIGN KEY (`CurrencyID`) REFERENCES `KyobeeTechRevamp`.`Currency`(`CurrencyID`)
);
CREATE TABLE `KyobeeTechRevamp`.`COUNTRY`(  
  `CountryID` INT(11) NOT NULL AUTO_INCREMENT,
  `CountryName` VARCHAR(255),
  `ISOCode` VARCHAR(100),		
  `CurrencyID` INT(11),
  `Active` TINYINT(1) NOT NULL,
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`CountryId`),
  CONSTRAINT `FK_Country_CurrencyID` FOREIGN KEY (`CurrencyID`) REFERENCES `KyobeeTechRevamp`.`CURRENCY`(`CurrencyID`)
);

CREATE TABLE `KyobeeTechRevamp`.`ORGANIZATIONSUBSCRIPTION`(  
  `OrganizationSubscriptionID` INT(11) NOT NULL,
  `OrganizationID` INT(11),
  `CustomerID` INT(11),
  `SubscriptionDate` DATE,
  `BillAmt` DECIMAL(5,2),
  `DiscountAmt` DECIMAL(5,2),
  `TotalBillAmount` DECIMAL(5,2),
  `StartDate` DATE,
  `EndDate` DATE,
  `PromotionalCodeID` INT(11),
  `InvoiceStatus` VARCHAR(100),
  `InvoiceFile` VARCHAR(1000),
  `CurrentActiveSubscription` ENUM('Y','N'),
  `Active` TINYINT(1),
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`OrganizationSubscriptionID`),
  CONSTRAINT `FK_OrgSubScription_CustomerID` FOREIGN KEY (`CustomerID`) REFERENCES `KyobeeTechRevamp`.`CUSTOMER`(`CustomerID`),
  CONSTRAINT `FK_OrgSubScription_OrganizationID` FOREIGN KEY (`OrganizationID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATION`(`OrganizationID`),
  CONSTRAINT `FK_OrgSubScription_PromotionalCodeID` FOREIGN KEY (`PromotionalCodeID`) REFERENCES `KyobeeTechRevamp`.`PROMOTIONALCODE`(`PromotionalCodeID`)
);
CREATE TABLE `KyobeeTechRevamp`.`ORGANIZATIONSUBSCRIPTIONDETAIL`(  
  `OrganizationSubscriptionPlanID` INT(11) NOT NULL AUTO_INCREMENT,
  `OrganizationID` INT(11),
  `PlanFeatureChargeID` INT(11),
  `FeatureID` INT(11),
  `PlanID` INT(11),
  `CurrencyID` INT(11),
  `PlanTermID` INT(11),
  `TermChargeAmt` DECIMAL(5,2),
  `StartDate` DATE,
  `EndDate` DATE,
  `SubscriptionStatus` VARCHAR(255),
  `SubscribedDate` DATE,
  `RenewalType` VARCHAR(100),
  `IsFree` ENUM('Y','N'),
  `SubscriptionID` INT(11),
  `CurrentActiveSubscription` ENUM('Y','N'),
  `Active` TINYINT(1) NOT NULL,
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`OrganizationSubscriptionPlanID`),
  CONSTRAINT `FK_OrgSubScriptionDetail_OrganizationID` FOREIGN KEY (`OrganizationID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATION`(`OrganizationID`),
  CONSTRAINT `FK_OrgSubScriptionDetail_PlanFeatureChargeID` FOREIGN KEY (`PlanFeatureChargeID`) REFERENCES `KyobeeTechRevamp`.`PLANFEATURECHARGE`(`PlanFeatureChargeID`),
  CONSTRAINT `FK_OrgSubScriptionDetail_FeatureID` FOREIGN KEY (`FeatureID`) REFERENCES `KyobeeTechRevamp`.`FEATURE`(`FeatureID`),
  CONSTRAINT `FK_OrgSubScriptionDetail_PlanID` FOREIGN KEY (`PlanID`) REFERENCES `KyobeeTechRevamp`.`PLAN`(`PlanID`),
  constraint `FK_OrgSubScriptionDetail_CurrencyID` foreign key (`CurrencyID`) references `KyobeeTechRevamp`.`CURRENCY`(`CurrencyID`),
  constraint `FK_OrgSubScriptionDetail_PlanTermID` foreign key (`PlanTermID`) references `KyobeeTechRevamp`.`PLANTERM`(`PlanTermID`),
  constraint `FK_OrgSubScriptionDetail_SubscriptionID` foreign key (`SubscriptionID`) references `KyobeeTechRevamp`.`ORGANIZATIONSUBSCRIPTION`(`OrganizationSubscriptionID`)
);
CREATE TABLE `KyobeeTechRevamp`.`ORGANIZATIONCARDDETAIL`(  
  `OrganizationCardDetailID` INT(11) NOT NULL,
  `CardNo` INT(4),
  `CardType` VARCHAR(255),
  `CardName` VARCHAR(500),
  `VaultID` VARCHAR(255),
  `OrganizationID` INT(11),
  `CustomerID` INT(11),
  `Active` TINYINT(1),
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`OrganizationCardDetailID`),
  CONSTRAINT `FK_OrgCardDetail_OrganizationID` FOREIGN KEY (`OrganizationID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATION`(`OrganizationID`),
  CONSTRAINT `FK_OrgCardDetail_CustomerID` FOREIGN KEY (`CustomerID`) REFERENCES `KyobeeTechRevamp`.`CUSTOMER`(`CustomerID`)
);
CREATE TABLE `KyobeeTechRevamp`.`ORGANIZATIONPAYMENT`(  
  `OrganizationPaymentID` INT(11) NOT NULL,
  `InvoiceID` INT(11),
  `OrganizationID` INT(11),
  `OrganizationCardDetailID` INT(11),
  `TransactionID` INT,
  `PaymentDateTime` DATE,
  `PaymentStatus` VARCHAR(100),
  `Amount` DECIMAL(5,2),
  `PaymentStatusReason` VARCHAR(1000),
  `Active` TINYINT(1),
  `CreatedBy` VARCHAR(100) DEFAULT 'NULL',
  `CreatedAt` DATE,
  `ModifiedBy` VARCHAR(100) DEFAULT 'NULL',
  `ModifiedAt` DATE,
  PRIMARY KEY (`OrganizationPaymentID`),
  CONSTRAINT `FK_OrganizationPayment_InvoiceID` FOREIGN KEY (`InvoiceId`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATIONSUBSCRIPTION`(`OrganizationSubscriptionID`),
  CONSTRAINT `FK_OrganizationPayment_OrganizationID` FOREIGN KEY (`OrganizationID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATION`(`OrganizationID`),
  CONSTRAINT `FK_OrganizationPayment_OrganizationCardDetailID` FOREIGN KEY (`OrganizationCardDetailID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATIONCARDDETAIL`(`OrganizationCardDetailID`)
);

ALTER TABLE ORGANIZATION
DROP ActiveOrganizationPlanId;


ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION`   
  CHANGE `CustomerID` `CustomerID` INT(11) NULL  AFTER `OrganizationName`,
  CHANGE `AddressID` `AddressID` INT(11) NULL  AFTER `CustomerID`,
  CHANGE `AutoRenew` `AutoRenew` TINYINT(1) DEFAULT 1  NULL  AFTER `ReservationInfo`;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATION`   
  CHANGE `OrganizationTypeID` `OrganizationTypeID` INT(11) NOT NULL  AFTER `CustomerID`,
  CHANGE `AddressID` `AddressID` INT(11) NULL  AFTER `OrganizationTypeID`,
  CHANGE `AdsBalance` `AdsBalance` INT(11) NULL  AFTER `AddressID`;

CREATE TABLE  `ORGANIZATIONSUBSCRIPTIONHISTORY` AS SELECT * FROM ORGANIZATIONSUBSCRIPTION;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONSUBSCRIPTIONHISTORY`   
  ADD COLUMN `OrganizationSubscriptionHistoryID` INT(11) NOT NULL FIRST,
  CHANGE `OrganizationSubscriptionID` `OrganizationSubscriptionID` INT(11) NULL, 
  ADD PRIMARY KEY (`OrganizationSubscriptionHistoryID`),
  ADD CONSTRAINT `FK_OrgSubScriptionHistory_CustomerID` FOREIGN KEY (`CustomerID`) REFERENCES `KyobeeTechRevamp`.`CUSTOMER`(`CustomerID`),
  ADD CONSTRAINT `FK_OrgSubScriptionHistory_OrganizationID` FOREIGN KEY (`OrganizationID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATION`(`OrganizationID`),
  ADD CONSTRAINT `FK_OrgSubScriptionHistory_PromotionalCodeID` FOREIGN KEY (`PromotionalCodeID`) REFERENCES `KyobeeTechRevamp`.`PROMOTIONALCODE`(`PromotionalCodeID`);

CREATE TABLE  `ORGANIZATIONPAYMENTHISTORY` AS SELECT * FROM ORGANIZATIONPAYMENT;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONPAYMENTHISTORY`   
  ADD COLUMN `OrganizationPaymentHistoryID` INT(11) NOT NULL FIRST,
  CHANGE `OrganizationPaymentID` `OrganizationPaymentID` INT(11) NULL, 
  ADD PRIMARY KEY (`OrganizationPaymentHistoryID`),
  ADD CONSTRAINT `FK_OrganizationPaymentHistory_OrganizationCardDetailID` FOREIGN KEY (`OrganizationCardDetailID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATIONCARDDETAIL`(`OrganizationCardDetailID`),
  ADD CONSTRAINT `FK_OrganizationPaymentHistory_OrganizationID` FOREIGN KEY (`OrganizationID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATION`(`OrganizationID`);

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONCARDDETAIL`   
  CHANGE `CustomerID` `CustomerID` INT(11) NULL  AFTER `VaultID`,
  CHANGE `OrganizationID` `OrganizationID` INT(11) NULL  AFTER `CustomerID`,
  CHANGE `Active` `Active` TINYINT(1) NULL  AFTER `OrganizationID`;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONPAYMENT`   
  CHANGE `Amount` `Amount` DECIMAL(5,2) NULL  AFTER `TransactionID`,
  CHANGE `PaymentDateTime` `PaymentDateTime` DATE NULL  AFTER `Amount`,
  CHANGE `PaymentStatusReason` `PaymentStatusReason` VARCHAR(1000) CHARSET latin1 COLLATE latin1_swedish_ci NULL  AFTER `PaymentStatus`;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONPAYMENTHISTORY`   
  CHANGE `Amount` `Amount` DECIMAL(5,2) NULL  AFTER `OrganizationCardDetailID`,
  CHANGE `TransactionID` `TransactionID` INT(11) NULL  AFTER `Amount`,
  CHANGE `PaymentStatusReason` `PaymentStatusReason` VARCHAR(1000) CHARSET latin1 COLLATE latin1_swedish_ci NULL  AFTER `PaymentStatus`;


ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONSUBSCRIPTIONHISTORY`  
  DROP FOREIGN KEY `FK_OrgSubScriptionHistory_OrgSubscriptionID`;


ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONPAYMENTHISTORY` DROP FOREIGN KEY `FK_OrganizationPaymentHistory_OrganizationCardDetailID`;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONPAYMENTHISTORY` ADD CONSTRAINT `FK_OrganizationPaymentHistory_OrganizationCardDetailID` FOREIGN KEY (`OrganizationCardDetailID`) REFERENCES `KyobeeTechRevamp`.`ORGANIZATIONCARDDETAIL`(`OrganizationCardDetailID`);

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONSUBSCRIPTIONHISTORY`   
  CHANGE `OrganizationSubscriptionHistoryID` `OrganizationSubscriptionHistoryID` INT(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONPAYMENT`   
  CHANGE `Active` `Active` TINYINT(1) NOT NULL;

ALTER TABLE `KyobeeTechRevamp`.`ORGANIZATIONSUBSCRIPTION`   
  CHANGE `Active` `Active` TINYINT(1) NOT NULL,
  CHANGE `CreatedBy` `CreatedBy` VARCHAR(100) CHARSET latin1 COLLATE latin1_swedish_ci DEFAULT 'NULL'   NULL,
  CHANGE `ModifiedBy` `ModifiedBy` VARCHAR(100) CHARSET latin1 COLLATE latin1_swedish_ci DEFAULT 'NULL'   NULL;

